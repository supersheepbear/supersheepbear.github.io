<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå– | Bear's dream</title><meta name="description" content="304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><meta name="keywords" content="Cpp,Coding,Memory,Class,Object"><meta name="author" content="supersheepbear"><meta name="copyright" content="supersheepbear"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon_1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="p43hXBn3_dLvbyxUzx0eo5eYmj9OVYOV52pdrhBa2sw"><meta name="baidu-site-verification" content="EXLlfLv2pV"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><meta name="twitter:description" content="304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta property="og:type" content="article"><meta property="og:title" content="304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><meta property="og:url" content="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/304%20-%20%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%AA%83%E5%8F%96/"><meta property="og:site_name" content="Bear's dream"><meta property="og:description" content="304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/304%20-%20%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%AA%83%E5%8F%96/"><link rel="prev" title="322 - Different Type Members" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/322%20-%20Different%20Type%20Members/"><link rel="next" title="319 - Class Const" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/319%20-%20Class%20Const/"><link rel="stylesheet" href="hfttps://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Bear's dream" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Bear's dream</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> æœç´¢</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200520153141.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">152</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">151</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">20</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">ç›®å½•</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">C++ æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">1. ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">2. æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-Point-ç±»è®¾è®¡"><span class="toc_mobile_items-number">1.5.1.</span> <span class="toc_mobile_items-text">2.1 Point ç±»è®¾è®¡</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶"><span class="toc_mobile_items-number">1.5.2.</span> <span class="toc_mobile_items-text">2.2 â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•"><span class="toc_mobile_items-number">1.5.3.</span> <span class="toc_mobile_items-text">2.3 ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-4-std-move-çš„ä½œç”¨"><span class="toc_mobile_items-number">1.5.4.</span> <span class="toc_mobile_items-text">2.4 std::move çš„ä½œç”¨</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-5-invalidate-å‡½æ•°ä¸â€œSteal-Gettersâ€ï¼ˆå¯é€‰ï¼‰"><span class="toc_mobile_items-number">1.5.5.</span> <span class="toc_mobile_items-text">2.5 invalidate å‡½æ•°ä¸â€œSteal Gettersâ€ï¼ˆå¯é€‰ï¼‰</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-å®Œæ•´ä»£ç ç¤ºä¾‹"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">3. å®Œæ•´ä»£ç ç¤ºä¾‹</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Point-h-å¦‚ä¸Šæ‰€ç¤º"><span class="toc_mobile_items-number">1.6.1.</span> <span class="toc_mobile_items-text">Point.h (å¦‚ä¸Šæ‰€ç¤º)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Point-cpp-å¦‚ä¸Šæ‰€ç¤º"><span class="toc_mobile_items-number">1.6.2.</span> <span class="toc_mobile_items-text">Point.cpp (å¦‚ä¸Šæ‰€ç¤º)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#main-cpp"><span class="toc_mobile_items-number">1.6.3.</span> <span class="toc_mobile_items-text">main.cpp</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-QA-é—ªå¡"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">4. QA é—ªå¡</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-å¸¸è§è¯¯è§£æˆ–é”™è¯¯"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">5. å¸¸è§è¯¯è§£æˆ–é”™è¯¯</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-ç¼–ç¨‹ç»ƒä¹ "><span class="toc_mobile_items-number">1.9.</span> <span class="toc_mobile_items-text">6. ç¼–ç¨‹ç»ƒä¹ </span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc_mobile_items-number">1.10.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant-1"><span class="toc_mobile_items-number">1.11.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7-æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š"><span class="toc_mobile_items-number">1.12.</span> <span class="toc_mobile_items-text">7. æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8-æ‰©å±•é—®é¢˜åŠå»ºè®®"><span class="toc_mobile_items-number">1.13.</span> <span class="toc_mobile_items-text">8. æ‰©å±•é—®é¢˜åŠå»ºè®®</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><span class="toc-number">1.</span> <span class="toc-text">ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯"><span class="toc-number">1.3.</span> <span class="toc-text">C++ æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ"><span class="toc-number">1.4.</span> <span class="toc-text">1. ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†"><span class="toc-number">1.5.</span> <span class="toc-text">2. æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Point-ç±»è®¾è®¡"><span class="toc-number">1.5.1.</span> <span class="toc-text">2.1 Point ç±»è®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.2 â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•"><span class="toc-number">1.5.3.</span> <span class="toc-text">2.3 ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-std-move-çš„ä½œç”¨"><span class="toc-number">1.5.4.</span> <span class="toc-text">2.4 std::move çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-invalidate-å‡½æ•°ä¸â€œSteal-Gettersâ€ï¼ˆå¯é€‰ï¼‰"><span class="toc-number">1.5.5.</span> <span class="toc-text">2.5 invalidate å‡½æ•°ä¸â€œSteal Gettersâ€ï¼ˆå¯é€‰ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-å®Œæ•´ä»£ç ç¤ºä¾‹"><span class="toc-number">1.6.</span> <span class="toc-text">3. å®Œæ•´ä»£ç ç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Point-h-å¦‚ä¸Šæ‰€ç¤º"><span class="toc-number">1.6.1.</span> <span class="toc-text">Point.h (å¦‚ä¸Šæ‰€ç¤º)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Point-cpp-å¦‚ä¸Šæ‰€ç¤º"><span class="toc-number">1.6.2.</span> <span class="toc-text">Point.cpp (å¦‚ä¸Šæ‰€ç¤º)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main-cpp"><span class="toc-number">1.6.3.</span> <span class="toc-text">main.cpp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-QA-é—ªå¡"><span class="toc-number">1.7.</span> <span class="toc-text">4. QA é—ªå¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-å¸¸è§è¯¯è§£æˆ–é”™è¯¯"><span class="toc-number">1.8.</span> <span class="toc-text">5. å¸¸è§è¯¯è§£æˆ–é”™è¯¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-ç¼–ç¨‹ç»ƒä¹ "><span class="toc-number">1.9.</span> <span class="toc-text">6. ç¼–ç¨‹ç»ƒä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc-number">1.10.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant-1"><span class="toc-number">1.11.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š"><span class="toc-number">1.12.</span> <span class="toc-text">7. æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-æ‰©å±•é—®é¢˜åŠå»ºè®®"><span class="toc-number">1.13.</span> <span class="toc-text">8. æ‰©å±•é—®é¢˜åŠå»ºè®®</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)"><div id="post-info"><div id="post-title"><div class="posttitle">304 - ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> å‘è¡¨äº 2025-06-08<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> æ›´æ–°äº 2025-06-08</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/">10-projects</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/">cplusplus</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/lectures/">lectures</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>è¯„è®ºæ•°:</span><a href="/2025/06/08/10-projects/cplusplus/lectures/304%20-%20%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%AA%83%E5%8F%96/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2025/06/08/10-projects/cplusplus/lectures/304%20-%20%E7%A7%BB%E5%8A%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%AA%83%E5%8F%96/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"><a href="#ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–" class="headerlink" title="ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–"></a>ç§»åŠ¨æ„é€ å‡½æ•°çªƒå–</h1><h2 id="ğŸ§‘â€ğŸ’»-User"><a href="#ğŸ§‘â€ğŸ’»-User" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><p>In this lecture weâ€™re going to learn about Move constructors, and this is a special kind of constructorthat is going to steal data from other objects.And those objects we steal from are going to be temporary objects that are going to be killed by thecompiler.Anyway.Letâ€™s look at a simple example.Weâ€™re going to use a class called Point.The class is going to have two member variables X and Y, which are pointer to double.So this is going to allow us to see some things we really want to see in this lecture.The class is going to have a constructor and a bunch of other methods that are not shown here becausethey really arenâ€™t important for what we want to see.But letâ€™s look at the syntax we use to build from temporaries.Here we have a point object which is being built from another point object.So this would really use the copy constructor.But notice what we are building from it is a point that we are building in place here.So the constructor is going to be called from what we have in the parentheses here, and weâ€™re goingto build a temporary point object whose sole purpose is to be used to build another point object, whichis going to be p three here.So the point of this entire lecture is to not waste the data that we had in this point that we haveas a parameter or argument here.We want to grab the data and and we donâ€™t want to go through the trouble to build another point becausewe already have it as a temporary here and we want to steal data from it.Okay.So letâ€™s try and really illustrate this better.Weâ€™re going to have a temporary object, both somewhere in memory, and itâ€™s going to be a full point.Itâ€™s going to have a pointer to X, a pointer to Y, and these are going to be double pointers.The pointer to X is going to have some address which is ending in D three here.The pointer to Y is going to have another address which is ending in D four here and weâ€™re going tohave content stored at these memory locations.So this is our temporary and suppose that what we are pointing to is something really expensive to build.Suppose it is a really heavy object and we donâ€™t want to waste the data if we have it already constructedand it is going to be wasted because the moment we are done building from a temporary, the temporaryis going to be thrown away by the compiler and we donâ€™t want to really waste.So what we can do is steal data from this temporary if we are building another object from it.So for example, here we are trying to build P three from our temporary here.So weâ€™re going to grab the data from temporary and steal that and put that in our P three object.At this moment when we are building P three, itâ€™s going to have these two pointers because these arethe member variables we have.And and the x pointer is going to be pointing to null pointer and the Y pointer is going to be pointingto null pointer by default.Itâ€™s not going to have any content, but we donâ€™t want to go through the trouble to put in the contentbecause we already have the content in temporary.So what we can do is steal these pointers and make them stored in P three here.So for example, we can grab this pointer address and put that here in P three.We can grab this pointer address and put that in P three the pointer to Y and then after we are donewe can make these pointers in temporary pointer to nowhere.We can set them to null pointer and we will have effectively stolen data from the temporary and storedthe data in our P three object.And by stealing data like this, we have avoided the heavy work of setting up our own data in p threehere and this is really cool.Okay, so if we steal data, weâ€™re going to have a case like this.The pointers in P three and the temporary are going to be the same.But to really completely steal the data, weâ€™re going to reset the pointers in temporary and weâ€™re goingto set them to null pointer.So in temporary weâ€™re going to have a null pointer and itâ€™s basically not going to be pointing anywhere.Itâ€™s not going to have any content.The temporary object is not going to have any content in here and the data will have moved in P threeand this is what we mean by stealing data.So this is all fine and good, but how do we do this in C plus plus?Well, we use a Move constructor.A Move constructor is a special kind of constructor whose sole job is to steal data from other objects.And this is the syntax you use to set it up.You say the name of the constructor and you pass your parameter like this.You say the class name and then you put two ampersand symbols and this is going to be your move constructor.When the compiler sees this syntax, itâ€™s going to know that it is a move constructor and it is goingto use it to steal data from temporaries.So what it is really going to do, weâ€™re going to steal the pointer in X, We store that in our object,weâ€™re going to steal the pointer in Y and weâ€™re going to store.That in our objects here.And then what we need to do is to set the pointers in our temporary to null.And weâ€™re going to do that through a special function that weâ€™re going to set up in our object, whichis going to reset all the pointers.And this is really how you do it.Okay.Before we go off and really try this in Visual Studio code, I want to show you a way we can force thecompiler to treat our object as a temporary and we pass this through a special facility we have in Cplus plus, which is called a Stdmove.We need to do this because sometimes the compiler is going to do some optimizations and itâ€™s not goingto treat our temporary as a temporary and it is going to call the copy constructor.Instead, we want to force the compiler to treat our object here as a temporary.So thatâ€™s why we pass this through this stdmove function which is built into the C plus plus standardlibrary.So now that you have an idea about move constructors, letâ€™s head over to Visual Studio code and playwith this a little more.Okay, Here we are in our working folder.The current project is Move Constructors.Weâ€™re going to grab our template files and weâ€™re going to put them in place and we are going to openthis in Visual Studio code like we always do by dragging and dropping here.This is going to open our folder and we will open the Main.cpp file and clean it up a little bit.The first thing we want to do is to bring in the class we want to use to learn about this.And we will set up a class called Point as we have seen in the slides.So letâ€™s do that.Weâ€™re going to set up a header file.Iâ€™m going to say point dot h for our header file and weâ€™re going to put in an implementation file calledpoint dot CPP.Letâ€™s do that and we are going to put in our class.Letâ€™s start by the header file.Weâ€™re going to put in the class which is called point here.And letâ€™s go through it a little bit.The class name is Point.Itâ€™s going to have a few private member variables.Weâ€™re going to have a pointer to double.Weâ€™re going to have two variables X and Y, which are of type double pointer.So they are pointers to double.And we have a function we will use to invalidate our null pointers.But we can ignore this for now.Weâ€™re going to come back to it in a little bit.So this is our constructor.Itâ€™s going to take two parameters.We have a destructor which is going to release the memory and we have a copy constructor here.You see it is taking the parameter by const reference.Letâ€™s say this, here it is a copy constructor and if we go down we have a few setters.The first one is going to set X and it is going to dereference a pointer and put in our value.The second one is going to set y again.It is going to Dereference and put in our value and we are doing this dereferencing because our membervariables are pointers.We need to go through Dereferencing to get to what is pointed to by this pointer.You should know this by now.We will have a few getters.The first one is going to return X because x is a pointer by default and weâ€™re going to return y inget Y here and we have a utility function which is going to print information about our point.So itâ€™s going to print the x coordinate of a point and itâ€™s going to print the y coordinate of a point.And here you see that we are dereferencing again because we are going through pointers.Letâ€™s be consistent here and put the parentheses on this x guy here.Okay, this is our header file.I think it is pretty good and pretty easy to understand at this point in the course.So letâ€™s do the CPP file.Weâ€™re going to put in the implementations for our point class here.We have the constructor implemented.Weâ€™re going to set up a new memory location because we have pointers in our member variables.We have to initialize them with valid memory.So thatâ€™s what we do here.Weâ€™re going to dynamically allocate memory on the heap and then weâ€™re going to store in our data.This is the syntax to do that.We also have a copy constructor which is going to also allocate new memory from the heap and weâ€™re goingto store in data from our source object.Notice that we are doing deep copy here.Weâ€™re not doing blind member wise copy, which would be shallow copy.We are doing deep copy because we want to have independent data in our constructor point object.Here we also have a destructor which is going to release memory that we have initialized in our constructorsand this class is pretty done by now.Letâ€™s go back in the header and really verify this.Our setters are implemented in place, so this should work.Letâ€™s close the left sidebar here and weâ€™re going to go back to Main.Weâ€™re going to include our point, letâ€™s say point dot H, and then weâ€™re going to create a point object.So letâ€™s, for example, create a point P one, and weâ€™re going to put in data.Weâ€™re going to put in 10.0 and 15.0.Why not?Okay, letâ€™s do this and we can.Print information about this object through the printing full member function here so we can do that.So letâ€™s print this information here.Weâ€™re going to say P one print info and weâ€™re going to try and build.We want to investigate that.Things are really working exactly as we expect.Weâ€™re going to bring up a terminal and weâ€™re going to clear and run Rooster.If we do that, weâ€™re going to see that in X, we have ten, in Y, we have 15, which is what we expecthere.Letâ€™s put in 10.4, for example, and 15.6.Why not?And build again.We want to see our decimal points.The build is good.We can clear and run rooster and you see that.We see the data here and this is what we expect.Okay, so letâ€™s try and create a copy of a point from a temporary.So what weâ€™re going to do is say point and weâ€™re going to say P three and we are going to constructthis point from a temporary The way we do that, weâ€™re going to force the compiler to treat what weâ€™regoing to pass here as a temporary.And to do that, we need to pass this through a facility called a Stdmove, as we saw in the slides.So letâ€™s do that.Weâ€™re going to say Stdmove, and then weâ€™re going to pass our point here.Again, you will have to just believe me here because we need to learn about the Move constructors,but we donâ€™t have enough tools to really understand what Stdmove does.By now you can treat as something that is going to force the compiler to treat this point here as atemporary so that we can steal data from it.So you are basically telling the compiler this point is going to be destroyed anyway, so steal fromit if you can.This is what weâ€™re telling the compiler.So weâ€™re going to put in data.Letâ€™s put in 20.5 and 5.8 and you can really put in anything.Then weâ€™re going to see what happens here.Okay, So we have our call to build an object from another object.But what we are building from is a temporary.Okay, So letâ€™s comment out the print information we had in front here because we donâ€™t want this toconfuse us.And letâ€™s see what we have in our constructors.We have a print out in the body of the copy constructor and we have an stdcout statement in the constructor,which is taking two parameters here.So letâ€™s see what happens.Weâ€™re going to build this and see what we see on the terminal.Weâ€™re going to build with GCC and you see that the world is good down here so we can clear and run Rooster.Now weâ€™re going to see that we have two constructors called and now we see that we have two constructorscalled.I think the first one is to build this point here, and this is going to make our code a little moreconfusing.So I am going to comment this out and weâ€™re going to build it down.Okay.So the build is good.We can clear and run Rooster.Weâ€™re going to see that we have a constructor called which is going to build this temporary here andwe have the copy constructor called because itâ€™s going to be copying from this temporary.So this is what we expect.If we try to build from a temporary by default, the compiler is going to use the copy constructor.And thatâ€™s what we see here.We see that the body of the copy constructor was executed and printed out this message here and we donâ€™treally want to use a copy constructor because the copy constructor is going to do a lot of work.Itâ€™s going to allocate new memory locations, itâ€™s going to copy data.But what we are building from is a temporary and itâ€™s going to be thrown away and itâ€™s going to be thrownout anyway.So why not steal data that we have inside?If you look at our model of the point class, youâ€™re going to see that our member variables are pointers.So we can technically still pointers in our temporary and just steal the data and avoid the work todo all this new memory allocation.And we can just steal data that is already there.This is going to become attractive if the pointers you have in your member variables are pointing tosomething really expensive.Suppose youâ€™re suppose your member variables is some string that is really huge and you have a pointerto that and you donâ€™t really want to rebuild a memory location to copy that string into.So we can steal data if we can and avoid all that hard work.And we need to do that through a Move constructor.So weâ€™re going to go in our header file and set up a Move constructor and we have seen that the syntaxfor a Move constructor is really straightforward.All you have to do is say the name of the class, then you specify your parameter by value and thenyou put two ampersand symbols here and then you say your source point and then you give your parametera name.Letâ€™s use source point here.Itâ€™s going to work and then weâ€™re going to implement this in the CPP file.And letâ€™s go down and say that we want to do our Move constructor.We can copy the code we have for our copy constructor and adapt this a little bit.So weâ€™re going to grab that and put that here and weâ€™re going to adapt the parameter to make it a propermove constructor and letâ€™s make sure the names are consistent here.So source point and source point here they are consistent and what we want to do in here, we donâ€™twant to allocate for new memory.Weâ€™re just going to steal the pointer and what we do is going to say source point, get X, this isgoing to return us a pointer to the memory location in the source object, which is our temporary here.And then weâ€™re going to do the same things for the Y member variable.So letâ€™s do that.Weâ€™re going to say source point and get Y.Letâ€™s save this properly.Weâ€™re going to call the function here.And by this point we will have stolen the pointers from the source point.But after we do this, why do we have this squiggly line?Do we have more than we need of these parentheses?I think we do.So this is right.Visual Studio code is happy.So now that we have stolen the pointers, we need to do something more.Because at this point our two objects will be pointing to the same memory locations and we donâ€™t wantthat.Remember that after remember that when a point is destroyed, it is going to release the memory it ispointing to in its member variables X and Y.And we donâ€™t want the temporary to release our memory because the memory belongs to us.Now we have stolen these pointers.So what we need to do is to invalidate the pointers in source point here and we can do that througha special function that we have seen here, which is called invalidate.Itâ€™s going to invalidate the pointers that the current project is pointing to.So weâ€™re going to use this.Youâ€™re going to see that this is going to set the X pointer to null pointer and the Y pointer to nullpointer.And we can call that to do our dirty job here.So weâ€™re going to do that in the copy constructor.So weâ€™re going to say source point invalidate and we are able to access this method, which is privatein point because we are doing this from the point class.You really need to understand this.Some people might think because this method here is private, we wouldnâ€™t have access to it if we calledit like this.But please take a look at where we are calling it from.We are in the point class, so and in the point class, we will have access to any private members ofthis class here and invalidate happens to be a member of this class and it is private so we can useit.And now we have our Move constructor set up.Letâ€™s go down here and say that it is the body of our Move constructor and if we run the code now,the compiler is smart enough to realize that we have a move constructor in our class and it is goingto use it and steal data from the temporary.And this is really cool.So letâ€™s prove this.Weâ€™re going to build and see what GCC says about this.Weâ€™re going to build and the world is going to be good.You see world finished successfully.We can clear and run roster now you see that we are building our temporary here but we are calling thebody of our move constructor and after we steal from the temporary here it is going to be destroyedbecause itâ€™s no longer needed and it is going to be thrown away and the data is going to be belongingto 0.3.Now, if we print information in P3, letâ€™s do that.Weâ€™re going to see that we have the data we had in our temporary here, and this is really cool.X is going to be 20.5 and Y is going to be 5.8.Letâ€™s build and take into account the Printf statement here.Weâ€™re going to see that the build is good.We can clear and run roster.Weâ€™re going to see that.Our point now is going to have the data that we had in the temporary, but we didnâ€™t go through thetrouble to set up new memory locations.We just stole what we had in our temporary here.And this is the job that move constructors.Do they steal from temporaries?Okay, so this is doing what we want, but I want you to see another trick we can use to really do thisin one step and not have to call the invalidate function.What we can do is set up a special getter functions which are going to steal the pointer and invalidatethe pointer in one go.And the way we can do that is to go back in our class definition and letâ€™s go to where we have our gettersand weâ€™re going to put in another set of getters that are going to steal the data and invalidate thepointer.So here we have Steal X, which is going to set up a new memory location.Itâ€™s going to steal X and store that in this new x pointer and then weâ€™re going to invalidate x, weâ€™regoing to set that to null pointer and then weâ€™re going to return a new X here.The benefit of this is that we donâ€™t have to call.Validate in the body of our move function.By the time we steal the pointer, we will also have a chance to invalidate it.And this is going to be pretty cool.Weâ€™re going to do the same logic for Steal here.And now that we have this in place, we could go in our Move constructor comment the invalidate callout and then call steal X.We donâ€™t want to call get x.We want to call steal x.So weâ€™re going to do that and weâ€™re going to call steal y.And this is going to do what we want in one go.So some people prefer to do things like this, but it is a little less self-documenting.So I would prefer to use Invalidate here because when people see this call, they will at least havean intuition that we are invalidating data from the source object here and this is pretty cool.So weâ€™re going to build and really prove that this is working and we donâ€™t have any problem with this.Youâ€™re going to see that the build is good.We can clear and run Rooster.Youâ€™re going to see that we built our object from a temporary and it is working flawlessly.Here.We have the data from the temporary and we didnâ€™t have to go through the job to build another object.We just stole the data that we had in our temporary here.Please remember to use Stdmove here because if you donâ€™t, the compiler is not going to treat this asa temporary, at least in my case here.And you need to put Stdmove in here to make sure that the compiler is going to treat our temporary hereas a proper temporary and use the Move constructor to construct other objects from this temporary here.This is really all I had to share in this lecture.Hopefully you didnâ€™t find it confusing.If you have any problems, please do ask and I will do the best I can to help you out.For now, weâ€™re going to stop here in this lecture.In the next one, weâ€™re going to learn about deleted constructors.Go ahead and finish up here and meet me there.</p>
<hr>
<h2 id="ğŸ¤–-Assistant"><a href="#ğŸ¤–-Assistant" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>å¥½çš„ï¼Œå¾ˆé«˜å…´èƒ½ä¸ºæ‚¨è¯¦ç»†è®²è§£ C++ ä¸­çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼ä½œä¸ºæ‚¨å­¦ä¹  C++ çš„å‘å¯¼ï¼Œæˆ‘ä¼šå°½åŠ›ç”¨æœ€æ¸…æ™°ã€æœ€æ˜“æ‡‚çš„æ–¹å¼æ¥é˜è¿°è¿™ä¸ªé‡è¦çš„æ¦‚å¿µã€‚</p>
<hr>
<h2 id="C-æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯"><a href="#C-æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯" class="headerlink" title="C++ æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯"></a><strong>C++ æ·±åº¦è§£æï¼šæŒæ¡ç§»åŠ¨æ„é€ å‡½æ•°â€”â€”â€œçªƒå–â€æ•°æ®çš„è‰ºæœ¯</strong></h2><p><strong>å†…å®¹æ‘˜è¦ï¼š</strong> æœ¬è¯¾ç¨‹å°†å¸¦æ‚¨æ·±å…¥ç†è§£ C++ ä¸­çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆ[Move Constructor]ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œå®ƒå…è®¸æˆ‘ä»¬â€œçªƒå–â€å…¶ä»–å¯¹è±¡ï¼ˆå°¤å…¶æ˜¯ä¸´æ—¶å¯¹è±¡ï¼‰çš„èµ„æºï¼Œè€Œä¸æ˜¯è¿›è¡Œæ˜‚è´µçš„å¤åˆ¶ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ <code>Point</code> ç±»ç¤ºä¾‹ï¼Œå­¦ä¹ ç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†ã€è¯­æ³•ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ <code>std::move</code> æ¥å¯ç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œä»è€Œä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€‚</p>
<hr>
<h2 id="1-ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ"></a><strong>1. ä»€ä¹ˆæ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ</strong></h2><p>åœ¨ C++ ä¸­ï¼Œå½“æ‚¨åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶ç”¨å¦ä¸€ä¸ªç°æœ‰å¯¹è±¡æ¥åˆå§‹åŒ–å®ƒæ—¶ï¼Œé€šå¸¸ä¼šå‘ç”Ÿä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li><strong>æ‹·è´æ„é€ å‡½æ•°ï¼ˆ[Copy Constructor]ï¼‰</strong>ï¼šå½“æ‚¨ä»ä¸€ä¸ªâ€œLå€¼â€ï¼ˆ[Lvalue]ï¼Œå³æœ‰æ˜ç¡®å†…å­˜åœ°å€ã€å¯ä»¥è¢«é‡å¤ä½¿ç”¨çš„å¯¹è±¡ï¼‰åˆ›å»ºå¦ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ‹·è´æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚å®ƒçš„ä»»åŠ¡æ˜¯åˆ›å»ºä¸€ä¸ªä¸æºå¯¹è±¡å®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬ï¼Œè¿™æ„å‘³ç€å®ƒå¯èƒ½ä¼šè¿›è¡Œä¸€æ¬¡â€œæ·±æ‹·è´â€ï¼ˆ[Deep Copy]ï¼‰ï¼Œä¸ºæ–°çš„å¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ï¼Œå¹¶å°†æºå¯¹è±¡çš„æ•°æ®å¤åˆ¶è¿‡æ¥ã€‚è¿™åœ¨å¤„ç†å¤§å‹æ•°æ®ç»“æ„æˆ–åŠ¨æ€åˆ†é…çš„å†…å­˜æ—¶ï¼Œå¯èƒ½ä¼šéå¸¸è€—è´¹èµ„æºã€‚</li>
<li><strong>ç§»åŠ¨æ„é€ å‡½æ•°</strong>ï¼šè€Œç§»åŠ¨æ„é€ å‡½æ•°åˆ™æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œå®ƒä¸“é—¨ç”¨äºä»â€œRå€¼â€ï¼ˆ[Rvalue]ï¼Œé€šå¸¸æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œå³è¡¨è¾¾å¼çš„ä¸´æ—¶ç»“æœï¼Œç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­ï¼Œä¸å¯é‡å¤ä½¿ç”¨ï¼‰åˆ›å»ºæ–°å¯¹è±¡ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ—¢ç„¶æºå¯¹è±¡æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œåæ­£å¾ˆå¿«å°±è¦è¢«é”€æ¯äº†ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥â€œçªƒå–â€å®ƒçš„èµ„æºï¼ˆæ¯”å¦‚å®ƒæŒ‡å‘çš„å†…å­˜ï¼‰å‘¢ï¼Ÿè¿™æ ·å°±é¿å…äº†é‡æ–°åˆ†é…å†…å­˜å’Œå¤åˆ¶æ•°æ®çš„å¼€é”€ï¼Œæå¤§åœ°æé«˜äº†æ•ˆç‡ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒé—®é¢˜ï¼š</strong> å‡è®¾æ‚¨çš„ç±»ç®¡ç†ç€ä¸€äº›åŠ¨æ€åˆ†é…çš„ã€éå¸¸å¤§çš„å†…å­˜èµ„æºã€‚å½“æ‚¨é€šè¿‡ä¸€ä¸ªä¸´æ—¶å¯¹è±¡æ¥åˆ›å»ºå¦ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœä»ç„¶ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿä¸€æ¬¡æ˜‚è´µçš„æ·±æ‹·è´ï¼šä¸ºæ–°å¯¹è±¡åˆ†é…æ–°çš„å†…å­˜ï¼Œç„¶åå°†æ—§å†…å­˜ä¸­çš„å¤§é‡æ•°æ®å¤åˆ¶è¿‡æ¥ã€‚è€Œè¿™ä¸ªä¸´æ—¶å¯¹è±¡ä¸€æ—¦å®Œæˆå…¶ä½¿å‘½ï¼Œå®ƒæ‰€æŒæœ‰çš„æ—§å†…å­˜å°±ä¼šè¢«é‡Šæ”¾ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹å°±é€ æˆäº†èµ„æºçš„æµªè´¹å’Œæ€§èƒ½çš„ä¸‹é™ã€‚ç§»åŠ¨æ„é€ å‡½æ•°çš„å‡ºç°ï¼Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ç§ä¸å¿…è¦çš„å¼€é”€ï¼Œå®ç°æ›´é«˜æ•ˆçš„èµ„æºè½¬ç§»ã€‚</p>
<h2 id="2-æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†"><a href="#2-æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†" class="headerlink" title="2. æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†"></a><strong>2. æ·±å…¥ç†è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°çš„å·¥ä½œåŸç†</strong></h2><p>è®©æˆ‘ä»¬ä»¥ä¸€ä¸ª <code>Point</code> ç±»ä¸ºä¾‹æ¥å…·ä½“è¯´æ˜ã€‚</p>
<h3 id="2-1-Point-ç±»è®¾è®¡"><a href="#2-1-Point-ç±»è®¾è®¡" class="headerlink" title="2.1 Point ç±»è®¾è®¡"></a><strong>2.1 <code>Point</code> ç±»è®¾è®¡</strong></h3><p>åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ<code>Point</code> ç±»å°†åŒ…å«ä¸¤ä¸ªç§æœ‰æˆå‘˜å˜é‡ <code>m_x</code> å’Œ <code>m_y</code>ï¼Œå®ƒä»¬éƒ½æ˜¯ <code>double*</code> ç±»å‹ï¼Œå³æŒ‡å‘ <code>double</code> ç±»å‹çš„æŒ‡é’ˆã€‚è¿™æ„å‘³ç€ <code>Point</code> å¯¹è±¡æœ¬èº«å¹¶ä¸ç›´æ¥å­˜å‚¨åæ ‡å€¼ï¼Œè€Œæ˜¯å­˜å‚¨æŒ‡å‘è¿™äº›å€¼çš„å†…å­˜åœ°å€ã€‚åæ ‡å€¼ <code>X</code> å’Œ <code>Y</code> å°†è¢«åŠ¨æ€åœ°åˆ†é…åœ¨å †ï¼ˆ[Heap]ï¼‰ä¸Šã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Point.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span>* m_x; <span class="comment">// æŒ‡å‘Xåæ ‡çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">double</span>* m_y; <span class="comment">// æŒ‡å‘Yåæ ‡çš„æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾…åŠ©å‡½æ•°ï¼šå°†æŒ‡é’ˆç½®ç©ºï¼Œç”¨äºåœ¨çªƒå–èµ„æºåä½¿æºå¯¹è±¡æ— æ•ˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">invalidate</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Point(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°ï¼ˆ[Destructor]ï¼‰ï¼šé‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">    ~Point();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹·è´æ„é€ å‡½æ•°ï¼šæ‰§è¡Œæ·±æ‹·è´</span></span><br><span class="line">    Point(<span class="keyword">const</span> Point&amp; source);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** ç§»åŠ¨æ„é€ å‡½æ•°ï¼šçªƒå–èµ„æº ***</span></span><br><span class="line">    <span class="comment">// å‚æ•°æ˜¯å³å€¼å¼•ç”¨ï¼ˆ[Rvalue Reference]ï¼‰ï¼Œè¡¨ç¤ºæ¥å—ä¸´æ—¶å¯¹è±¡æˆ–å¯ç§»åŠ¨çš„å¯¹è±¡</span></span><br><span class="line">    Point(Point&amp;&amp; source) <span class="keyword">noexcept</span>; <span class="comment">// noexcept å…³é”®å­—è¡¨ç¤ºè¯¥å‡½æ•°ä¸æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (ä¸ºäº†å®Œæ•´æ€§æ·»åŠ ï¼Œè™½ç„¶è®²åº§æœªæåŠ)</span></span><br><span class="line">    Point&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Point&amp; source);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (ä¸ºäº†å®Œæ•´æ€§æ·»åŠ ï¼Œè™½ç„¶è®²åº§æœªæåŠ)</span></span><br><span class="line">    Point&amp; <span class="keyword">operator</span>=(Point&amp;&amp; source) <span class="keyword">noexcept</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getter æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getX</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getY</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Setter æ–¹æ³• (ä¸ºç®€æ´èµ·è§ï¼Œæ”¾åœ¨å¤´æ–‡ä»¶å†…è”å®ç°)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setX</span><span class="params">(<span class="keyword">double</span> x_val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m_x) *m_x = x_val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setY</span><span class="params">(<span class="keyword">double</span> y_val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m_y) *m_y = y_val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printInfo</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (å¯é€‰) çªƒå–å¹¶è¿”å›æŒ‡é’ˆçš„æ–¹æ³•ï¼ŒåŒæ—¶ä½¿æºå¯¹è±¡æŒ‡é’ˆæ— æ•ˆ</span></span><br><span class="line">    <span class="comment">// double* stealX();</span></span><br><span class="line">    <span class="comment">// double* stealY();</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Point.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°å®ç°</span></span><br><span class="line">Point::Point(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ™®é€šæ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    m_x = <span class="keyword">new</span> <span class="keyword">double</span>(x_val); <span class="comment">// åŠ¨æ€åˆ†é…å†…å­˜</span></span><br><span class="line">    m_y = <span class="keyword">new</span> <span class="keyword">double</span>(y_val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®ç°</span></span><br><span class="line">Point::~Point() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ææ„å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_x; <span class="comment">// é‡Šæ”¾å†…å­˜</span></span><br><span class="line">        m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_y;</span><br><span class="line">        m_y = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•°å®ç°ï¼šæ‰§è¡Œæ·±æ‹·è´</span></span><br><span class="line">Point::Point(<span class="keyword">const</span> Point&amp; source) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (source.m_x) &#123;</span><br><span class="line">        m_x = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_x); <span class="comment">// ä¸ºæ–°å¯¹è±¡åˆ†é…æ–°å†…å­˜å¹¶å¤åˆ¶æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (source.m_y) &#123;</span><br><span class="line">        m_y = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©å‡½æ•°ï¼šå°†å½“å‰å¯¹è±¡çš„æŒ‡é’ˆç½®ç©º</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Point::invalidate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    m_y = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** ç§»åŠ¨æ„é€ å‡½æ•°å®ç°ï¼šçªƒå–èµ„æº ***</span></span><br><span class="line">Point::Point(Point&amp;&amp; source) <span class="keyword">noexcept</span> : m_x(source.m_x), m_y(source.m_y) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// çªƒå–åï¼Œå¿…é¡»å°†æºå¯¹è±¡çš„æŒ‡é’ˆç½®ç©ºï¼Œé˜²æ­¢æºå¯¹è±¡ææ„æ—¶é‡Šæ”¾æ‰å·²è¢«çªƒå–çš„å†…å­˜</span></span><br><span class="line">    <span class="comment">// æ–¹å¼ä¸€ï¼šç›´æ¥ç½®ç©º</span></span><br><span class="line">    source.m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    source.m_y = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="comment">// æ–¹å¼äºŒï¼šè°ƒç”¨è¾…åŠ©å‡½æ•°</span></span><br><span class="line">    <span class="comment">// source.invalidate(); // å› ä¸ºinvalidateæ˜¯privateï¼Œä½†æˆ‘ä»¬åœ¨Pointç±»å†…éƒ¨ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (ä¸ºäº†å®Œæ•´æ€§æ·»åŠ )</span></span><br><span class="line">Point&amp; Point::<span class="keyword">operator</span>=(<span class="keyword">const</span> Point&amp; source) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;source) &#123; <span class="comment">// é˜²æ­¢è‡ªèµ‹å€¼</span></span><br><span class="line">        <span class="comment">// é‡Šæ”¾æ—§èµ„æº</span></span><br><span class="line">        <span class="keyword">if</span> (m_x) <span class="keyword">delete</span> m_x;</span><br><span class="line">        <span class="keyword">if</span> (m_y) <span class="keyword">delete</span> m_y;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†é…æ–°èµ„æºå¹¶æ·±æ‹·è´</span></span><br><span class="line">        m_x = source.m_x ? <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_x) : <span class="literal">nullptr</span>;</span><br><span class="line">        m_y = source.m_y ? <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_y) : <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (ä¸ºäº†å®Œæ•´æ€§æ·»åŠ )</span></span><br><span class="line">Point&amp; Point::<span class="keyword">operator</span>=(Point&amp;&amp; source) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;source) &#123; <span class="comment">// é˜²æ­¢è‡ªèµ‹å€¼</span></span><br><span class="line">        <span class="comment">// é‡Šæ”¾æ—§èµ„æº</span></span><br><span class="line">        <span class="keyword">if</span> (m_x) <span class="keyword">delete</span> m_x;</span><br><span class="line">        <span class="keyword">if</span> (m_y) <span class="keyword">delete</span> m_y;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// çªƒå–èµ„æº</span></span><br><span class="line">        m_x = source.m_x;</span><br><span class="line">        m_y = source.m_y;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†æºå¯¹è±¡çš„æŒ‡é’ˆç½®ç©º</span></span><br><span class="line">        source.m_x = <span class="literal">nullptr</span>;</span><br><span class="line">        source.m_y = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getter æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getX</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_x) <span class="keyword">return</span> *m_x;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>; <span class="comment">// æˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œæ ¹æ®éœ€æ±‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getY</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_y) <span class="keyword">return</span> *m_y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>; <span class="comment">// æˆ–è€…æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å°ä¿¡æ¯å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Point::printInfo</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºï¼Œé¿å…è§£å¼•ç”¨ç©ºæŒ‡é’ˆ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Point Info: X = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">", Y = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_y;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// (å¯é€‰) çªƒå–å¹¶è¿”å›æŒ‡é’ˆçš„æ–¹æ³•ï¼ŒåŒæ—¶ä½¿æºå¯¹è±¡æŒ‡é’ˆæ— æ•ˆ</span></span><br><span class="line"><span class="comment">double* Point::stealX() &#123;</span></span><br><span class="line"><span class="comment">    double* temp_x = m_x;</span></span><br><span class="line"><span class="comment">    m_x = nullptr; // å°†å½“å‰å¯¹è±¡çš„XæŒ‡é’ˆç½®ç©º</span></span><br><span class="line"><span class="comment">    return temp_x;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">double* Point::stealY() &#123;</span></span><br><span class="line"><span class="comment">    double* temp_y = m_y;</span></span><br><span class="line"><span class="comment">    m_y = nullptr; // å°†å½“å‰å¯¹è±¡çš„YæŒ‡é’ˆç½®ç©º</span></span><br><span class="line"><span class="comment">    return temp_y;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>
<h3 id="2-2-â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶"><a href="#2-2-â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶" class="headerlink" title="2.2 â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶"></a><strong>2.2 â€œçªƒå–â€æ•°æ®çš„æœºåˆ¶</strong></h3><p>è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Point p3 = Point(<span class="number">20.5</span>, <span class="number">5.8</span>); <span class="comment">// è¿™é‡Œçš„ Point(20.5, 5.8) æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡</span></span><br></pre></td></tr></table></figure></div>
<ol>
<li><strong>ä¸´æ—¶å¯¹è±¡åˆ›å»ºï¼š</strong> é¦–å…ˆï¼Œ<code>Point(20.5, 5.8)</code> ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶ <code>Point</code> å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ä¼šåœ¨å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜æ¥å­˜å‚¨ <code>X</code> å’Œ <code>Y</code> çš„å€¼ï¼Œå¹¶è®© <code>m_x</code> å’Œ <code>m_y</code> æŒ‡å‘è¿™äº›å†…å­˜ã€‚</li>
<li><strong>é»˜è®¤è¡Œä¸ºï¼ˆæ— ç§»åŠ¨æ„é€ å‡½æ•°æ—¶ï¼‰ï¼š</strong> å¦‚æœæ²¡æœ‰å®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚è¿™æ„å‘³ç€ä¼šä¸º <code>p3</code> å†æ¬¡åˆ†é…æ–°çš„å†…å­˜ï¼Œå¹¶å°†ä¸´æ—¶å¯¹è±¡ä¸­çš„ <code>20.5</code> å’Œ <code>5.8</code> å¤åˆ¶åˆ° <code>p3</code> çš„æ–°å†…å­˜ä¸­ã€‚ç„¶åï¼Œä¸´æ—¶å¯¹è±¡ä¼šè¢«é”€æ¯ï¼Œå…¶åŸå§‹çš„å†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚</li>
<li><strong>ç§»åŠ¨æ„é€ å‡½æ•°çš„è¡Œä¸ºï¼š</strong> å½“å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°åï¼Œç¼–è¯‘å™¨ä¼šè¯†åˆ«åˆ°å®ƒæ­£åœ¨ä»ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰åˆ›å»º <code>p3</code>ï¼Œå› æ­¤å®ƒä¼šé€‰æ‹©è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚<ul>
<li><strong>æ­¥éª¤1ï¼šçªƒå–æŒ‡é’ˆã€‚</strong> ç§»åŠ¨æ„é€ å‡½æ•°ä¸ä¼šåˆ†é…æ–°çš„å†…å­˜ã€‚ç›¸åï¼Œå®ƒä¼šå°†ä¸´æ—¶å¯¹è±¡ <code>source</code> çš„ <code>m_x</code> å’Œ <code>m_y</code> æŒ‡é’ˆçš„å€¼ç›´æ¥å¤åˆ¶ç»™ <code>p3</code> çš„ <code>m_x</code> å’Œ <code>m_y</code>ã€‚æ­¤æ—¶ï¼Œ<code>p3</code> å’Œ <code>source</code> çš„æŒ‡é’ˆéƒ½æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚</li>
<li><strong>æ­¥éª¤2ï¼šä½¿æºå¯¹è±¡æ— æ•ˆã€‚</strong> è¿™æ˜¯å…³é”®ä¸€æ­¥ï¼ä¸ºäº†ç¡®ä¿åœ¨ <code>source</code> é”€æ¯æ—¶ä¸ä¼šé”™è¯¯åœ°é‡Šæ”¾ <code>p3</code> æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ï¼ˆå¯¼è‡´â€œåŒé‡é‡Šæ”¾â€æˆ–â€œæ‚¬ç©ºæŒ‡é’ˆâ€ï¼‰ï¼Œç§»åŠ¨æ„é€ å‡½æ•°ä¼šç«‹å³å°† <code>source</code> çš„ <code>m_x</code> å’Œ <code>m_y</code> æŒ‡é’ˆè®¾ç½®ä¸º <code>nullptr</code>ã€‚è¿™æ ·ï¼Œå½“ <code>source</code> å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œç”±äºå…¶æŒ‡é’ˆå·²ä¸ºç©ºï¼Œå°±ä¸ä¼šå°è¯•é‡Šæ”¾å®ƒä¸å†æ‹¥æœ‰çš„å†…å­˜ã€‚</li>
<li><strong>ç»“æœï¼š</strong> æ­¤æ—¶ï¼ŒåŸå§‹çš„ <code>20.5</code> å’Œ <code>5.8</code> çš„å†…å­˜æ‰€æœ‰æƒå·²ç»ä»ä¸´æ—¶å¯¹è±¡å®‰å…¨åœ°è½¬ç§»åˆ°äº† <code>p3</code>ã€‚ä¸´æ—¶å¯¹è±¡åœ¨é”€æ¯æ—¶ï¼Œä¸ä¼šè§¦åŠè¿™å—å†…å­˜ã€‚æˆ‘ä»¬é¿å…äº†æ˜‚è´µçš„å†…å­˜åˆ†é…å’Œæ•°æ®å¤åˆ¶ã€‚</li>
</ul>
</li>
</ol>
<h3 id="2-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•"><a href="#2-3-ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•" class="headerlink" title="2.3 ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•"></a><strong>2.3 ç§»åŠ¨æ„é€ å‡½æ•°çš„è¯­æ³•</strong></h3><p>ç§»åŠ¨æ„é€ å‡½æ•°çš„å£°æ˜æ–¹å¼å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassName(ClassName&amp;&amp; source) <span class="keyword">noexcept</span>;</span><br></pre></td></tr></table></figure></div>
<ul>
<li><code>ClassName</code>: æ‚¨çš„ç±»åã€‚</li>
<li><code>&amp;&amp;</code>ï¼šè¿™å°±æ˜¯ <strong>å³å€¼å¼•ç”¨</strong> ç¬¦å·ï¼Œå®ƒè¡¨æ˜è¿™ä¸ªæ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå³å€¼ï¼ˆé€šå¸¸æ˜¯ä¸´æ—¶å¯¹è±¡ï¼‰ä½œä¸ºå‚æ•°ã€‚</li>
<li><code>source</code>: æºå¯¹è±¡çš„åç§°ï¼Œæ‚¨å¯ä»¥ä»ä¸­çªƒå–èµ„æºã€‚</li>
<li><code>noexcept</code>: è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„å…³é”®å­—ã€‚å®ƒè¡¨æ˜è¯¥å‡½æ•°æ‰¿è¯ºä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿™å¯¹äºç§»åŠ¨æ“ä½œéå¸¸é‡è¦ï¼Œå› ä¸ºå¦‚æœç§»åŠ¨æ“ä½œåœ¨ä¸­é—´æŠ›å‡ºå¼‚å¸¸ï¼ŒC++ æ ‡å‡†åº“ä¸­çš„æŸäº›å®¹å™¨ï¼ˆå¦‚ <code>std::vector</code>ï¼‰å¯èƒ½ä¼šé€‰æ‹©è¿›è¡Œæ›´å®‰å…¨çš„æ‹·è´æ“ä½œï¼Œè€Œä¸æ˜¯ç§»åŠ¨ï¼Œä»è€Œå¤±å»æ€§èƒ½ä¼˜åŠ¿ã€‚</li>
</ul>
<h3 id="2-4-std-move-çš„ä½œç”¨"><a href="#2-4-std-move-çš„ä½œç”¨" class="headerlink" title="2.4 std::move çš„ä½œç”¨"></a><strong>2.4 <code>std::move</code> çš„ä½œç”¨</strong></h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å¼ºåˆ¶ç¼–è¯‘å™¨å°†ä¸€ä¸ª Lå€¼ï¼ˆä¾‹å¦‚ä¸€ä¸ªå…·åå˜é‡ï¼‰è§†ä¸ºä¸€ä¸ª Rå€¼ï¼Œä»è€Œä½¿å…¶èƒ½å¤Ÿè¢«ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å¤„ç†ã€‚è¿™æ—¶å°±éœ€è¦ç”¨åˆ° <code>std::move</code>ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Point <span class="title">p1</span><span class="params">(<span class="number">10.0</span>, <span class="number">15.0</span>)</span></span>; <span class="comment">// p1 æ˜¯ä¸€ä¸ª Lå€¼</span></span><br><span class="line">Point p4 = <span class="built_in">std</span>::move(p1); <span class="comment">// å¼ºåˆ¶å°† p1 è§†ä¸º Rå€¼ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br></pre></td></tr></table></figure></div>
<p><strong>é‡è¦ï¼</strong> <code>std::move</code> <strong>æœ¬èº«å¹¶ä¸æ‰§è¡Œä»»ä½•ç§»åŠ¨æ“ä½œ</strong>ã€‚å®ƒä»…ä»…æ˜¯å°†ä¸€ä¸ªå·¦å€¼è¡¨è¾¾å¼ <strong>è½¬æ¢ï¼ˆ[Cast]ï¼‰</strong> ä¸ºä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚è¿™ä¸ªè½¬æ¢å‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œå˜¿ï¼Œè¿™ä¸ªå¯¹è±¡æˆ‘ä¸å†éœ€è¦äº†ï¼Œä½ å¯ä»¥å®‰å…¨åœ°ä»å®ƒé‚£é‡Œçªƒå–èµ„æºäº†ï¼â€ç„¶åï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®è¿™ä¸ªå³å€¼å¼•ç”¨ï¼Œå°è¯•åŒ¹é…å¹¶è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆæˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼‰ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œæ‰ä¼šå‘ç”ŸçœŸæ­£çš„â€œç§»åŠ¨â€ã€‚</p>
<p>å¦‚æœ <code>std::move</code> è¢«çœç•¥ï¼Œè€Œå‚æ•°åˆæ˜¯ä¸€ä¸ª Lå€¼ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå¦‚æœå¯ç”¨ï¼‰æˆ–è€…æŠ¥é”™ã€‚å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ª Rå€¼ï¼ˆå¦‚ <code>Point(20.5, 5.8)</code> è¿™æ ·çš„ä¸´æ—¶å¯¹è±¡ï¼‰ï¼Œå³ä½¿æ²¡æœ‰ <code>std::move</code>ï¼Œç¼–è¯‘å™¨ä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å¹¶è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆå¦‚æœå·²å®šä¹‰ï¼‰ã€‚</p>
<h3 id="2-5-invalidate-å‡½æ•°ä¸â€œSteal-Gettersâ€ï¼ˆå¯é€‰ï¼‰"><a href="#2-5-invalidate-å‡½æ•°ä¸â€œSteal-Gettersâ€ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="2.5 invalidate å‡½æ•°ä¸â€œSteal Gettersâ€ï¼ˆå¯é€‰ï¼‰"></a><strong>2.5 <code>invalidate</code> å‡½æ•°ä¸â€œSteal Gettersâ€ï¼ˆå¯é€‰ï¼‰</strong></h3><p>è®²åº§ä¸­æåˆ°äº†ä¸¤ç§å¤„ç†æºå¯¹è±¡æŒ‡é’ˆçš„æ–¹å¼ï¼š</p>
<ol>
<li><p><strong>åœ¨ç§»åŠ¨æ„é€ å‡½æ•°å†…ç›´æ¥è°ƒç”¨ <code>invalidate()</code>ï¼š</strong> è¿™æ˜¯ä¸€ç§æ¸…æ™°æ˜äº†çš„æ–¹å¼ã€‚åœ¨çªƒå–èµ„æºåï¼Œæ˜¾å¼åœ°è°ƒç”¨ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼ˆå¦‚ <code>invalidate()</code>ï¼‰å°†æºå¯¹è±¡çš„æŒ‡é’ˆç½®ç©ºã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Point::Point(Point&amp;&amp; source) <span class="keyword">noexcept</span> : m_x(source.m_x), m_y(source.m_y) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    source.invalidate(); <span class="comment">// æ¸…æ™°åœ°è¡¨æ˜ï¼šä½¿æºå¯¹è±¡æ— æ•ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯ï¼Œç§»åŠ¨æ„é€ å‡½æ•°çš„ä¸»ä½“æ¸…æ™°åœ°å±•ç¤ºäº†â€œçªƒå–â€å’Œâ€œå¤±æ•ˆâ€ä¸¤ä¸ªæ­¥éª¤ï¼Œæ˜“äºç†è§£ã€‚</p>
</li>
<li><p><strong>ä½¿ç”¨â€œSteal Gettersâ€ï¼ˆå¦‚ <code>stealX()</code> / <code>stealY()</code>ï¼‰ï¼š</strong> è¿™ç§æ–¹æ³•å°†â€œè·å–æŒ‡é’ˆâ€å’Œâ€œå°†æºæŒ‡é’ˆç½®ç©ºâ€è¿™ä¸¤ä¸ªæ“ä½œå°è£…åœ¨ä¸€ä¸ª getter æ–¹æ³•ä¸­ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨Point.hä¸­</span></span><br><span class="line"><span class="comment">// double* stealX();</span></span><br><span class="line"><span class="comment">// double* stealY();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨Point.cppä¸­</span></span><br><span class="line"><span class="comment">// double* Point::stealX() &#123;</span></span><br><span class="line"><span class="comment">//     double* temp_x = m_x;</span></span><br><span class="line"><span class="comment">//     m_x = nullptr; // å°†å½“å‰å¯¹è±¡çš„XæŒ‡é’ˆç½®ç©º</span></span><br><span class="line"><span class="comment">//     return temp_x;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ç§»åŠ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨</span></span><br><span class="line"><span class="comment">// Point::Point(Point&amp;&amp; source) noexcept : m_x(source.stealX()), m_y(source.stealY()) &#123;</span></span><br><span class="line"><span class="comment">//     std::cout &lt;&lt; "--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---" &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ç§æ–¹å¼å¯èƒ½çœ‹èµ·æ¥æ›´ç®€æ´ï¼Œå› ä¸ºå®ƒåœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­å°±å®Œæˆäº†æŒ‡é’ˆçš„è·å–å’Œæºå¯¹è±¡çš„å¤±æ•ˆã€‚ä½†è®²åº§ä¸­æåˆ°ï¼Œå®ƒå¯èƒ½â€œä¸å¤ªè‡ªæ–‡æ¡£åŒ–â€ï¼ˆless self-documentingï¼‰ï¼Œå› ä¸ºå®ƒå°†å¤±æ•ˆé€»è¾‘éšè—åœ¨ getter å†…éƒ¨ï¼Œè¯»è€…å¯èƒ½éœ€è¦æ·±å…¥åˆ° getter çš„å®ç°æ‰èƒ½ç†è§£å…¶å‰¯ä½œç”¨ã€‚é€šå¸¸ï¼Œæ›´æ¨èåœ¨ç§»åŠ¨æ„é€ å‡½æ•°çš„ä¸»ä½“ä¸­æ˜¾å¼åœ°å°†æºæŒ‡é’ˆç½®ç©ºæˆ–è°ƒç”¨ <code>invalidate</code> å‡½æ•°ï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p>
</li>
</ol>
<h2 id="3-å®Œæ•´ä»£ç ç¤ºä¾‹"><a href="#3-å®Œæ•´ä»£ç ç¤ºä¾‹" class="headerlink" title="3. å®Œæ•´ä»£ç ç¤ºä¾‹"></a><strong>3. å®Œæ•´ä»£ç ç¤ºä¾‹</strong></h2><p>ä¸ºäº†æ›´å¥½åœ°æ¼”ç¤ºï¼Œæˆ‘ä»¬å°†æŠŠ <code>Point</code> ç±»ï¼ˆåŒ…å«ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰å’Œ <code>main</code> å‡½æ•°æ”¾åœ¨ä¸€èµ·ã€‚</p>
<h3 id="Point-h-å¦‚ä¸Šæ‰€ç¤º"><a href="#Point-h-å¦‚ä¸Šæ‰€ç¤º" class="headerlink" title="Point.h (å¦‚ä¸Šæ‰€ç¤º)"></a><strong>Point.h</strong> (å¦‚ä¸Šæ‰€ç¤º)</h3><h3 id="Point-cpp-å¦‚ä¸Šæ‰€ç¤º"><a href="#Point-cpp-å¦‚ä¸Šæ‰€ç¤º" class="headerlink" title="Point.cpp (å¦‚ä¸Šæ‰€ç¤º)"></a><strong>Point.cpp</strong> (å¦‚ä¸Šæ‰€ç¤º)</h3><h3 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a><strong>main.cpp</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span> <span class="comment">// åŒ…å«Pointç±»çš„å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- ç¤ºä¾‹å¼€å§‹ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªæ™®é€šPointå¯¹è±¡</span></span><br><span class="line">    <span class="function">Point <span class="title">p1</span><span class="params">(<span class="number">10.4</span>, <span class="number">15.6</span>)</span></span>;</span><br><span class="line">    p1.printInfo();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p1çš„Xåœ°å€: "</span> &lt;&lt; p1.getX() &lt;&lt; <span class="string">" (å®é™…å†…å®¹)"</span>; <span class="comment">// æ‰“å°å€¼ï¼Œè€Œä¸æ˜¯åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">", p1çš„Yåœ°å€: "</span> &lt;&lt; p1.getY() &lt;&lt; <span class="string">" (å®é™…å†…å®¹)"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä½¿ç”¨ä¸´æ—¶å¯¹è±¡è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// Point(20.5, 5.8) æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰</span></span><br><span class="line">    <span class="comment">// ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line">    Point p3 = Point(<span class="number">20.5</span>, <span class="number">5.8</span>);</span><br><span class="line">    p3.printInfo();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä½¿ç”¨ std::move å¼ºåˆ¶è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// p1 æ˜¯ä¸€ä¸ª Lå€¼ï¼Œéœ€è¦é€šè¿‡ std::move è½¬æ¢ä¸ºå³å€¼å¼•ç”¨æ‰èƒ½è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line">    Point p4 = <span class="built_in">std</span>::move(p1);</span><br><span class="line">    p4.printInfo();</span><br><span class="line">    <span class="comment">// æ­¤æ—¶ï¼Œp1 çš„èµ„æºå·²è¢«çªƒå–ï¼Œå…¶å†…éƒ¨æŒ‡é’ˆåº”ä¸º nullptr</span></span><br><span class="line">    <span class="comment">// è®¿é—® p1 çš„æ•°æ®å¯èƒ½ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºæˆ–è¿”å›é»˜è®¤å€¼</span></span><br><span class="line">    p1.printInfo(); <span class="comment">// é¢„æœŸï¼šX = nullptr, Y = nullptr</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- éªŒè¯ p1 æ˜¯å¦è¢«ç§»åŠ¨ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// å°è¯•ä¿®æ”¹ p4 çš„å€¼ï¼Œçœ‹æ˜¯å¦å½±å“ p1ï¼ˆåº”è¯¥ä¸å½±å“ï¼‰</span></span><br><span class="line">    p4.setX(<span class="number">99.0</span>);</span><br><span class="line">    p4.setY(<span class="number">88.0</span>);</span><br><span class="line">    p4.printInfo();</span><br><span class="line">    p1.printInfo(); <span class="comment">// ç¡®è®¤ p1 ä»ç„¶æ˜¯æ— æ•ˆçŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- éªŒè¯æ‹·è´æ„é€ å‡½æ•°åœ¨Lå€¼ä¸Šçš„è°ƒç”¨ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Point p5 = p4; <span class="comment">// p4 æ˜¯ä¸€ä¸ª Lå€¼ï¼Œè¿™é‡Œä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    p5.printInfo();</span><br><span class="line">    p4.printInfo(); <span class="comment">// p4 ä»ç„¶æœ‰æ•ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ç¤ºä¾‹ç»“æŸ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>è¿è¡Œä¸Šè¿°ä»£ç ï¼Œæ‚¨å°†çœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼š</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">--- ç¤ºä¾‹å¼€å§‹ ---</span><br><span class="line">--- è°ƒç”¨æ™®é€šæ„é€ å‡½æ•° ---</span><br><span class="line">Point Info: X &#x3D; 10.4, Y &#x3D; 15.6</span><br><span class="line">p1çš„Xåœ°å€: 10.4 (å®é™…å†…å®¹), p1çš„Yåœ°å€: 15.6 (å®é™…å†…å®¹)</span><br><span class="line"></span><br><span class="line">--- ä½¿ç”¨ä¸´æ—¶å¯¹è±¡è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---</span><br><span class="line">--- è°ƒç”¨æ™®é€šæ„é€ å‡½æ•° ---</span><br><span class="line">--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---</span><br><span class="line">--- è°ƒç”¨ææ„å‡½æ•° --- &#x2F;&#x2F; ä¸´æ—¶å¯¹è±¡ Point(20.5, 5.8) è¢«é”€æ¯</span><br><span class="line">Point Info: X &#x3D; 20.5, Y &#x3D; 5.8</span><br><span class="line"></span><br><span class="line">--- ä½¿ç”¨ std::move å¼ºåˆ¶è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---</span><br><span class="line">--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---</span><br><span class="line">--- è°ƒç”¨ææ„å‡½æ•° --- &#x2F;&#x2F; p1 è¢«é”€æ¯ï¼Œä½†å…¶å†…å®¹å·²ç§»èµ°ï¼Œææ„æ—¶ä¸ä¼šé‡Šæ”¾èµ„æº</span><br><span class="line">Point Info: X &#x3D; 99, Y &#x3D; 88</span><br><span class="line">Point Info: X &#x3D; nullptr, Y &#x3D; nullptr &#x2F;&#x2F; p1 å·²ç»è¢«ç§»åŠ¨ï¼Œèµ„æºå·²ç½®ç©º</span><br><span class="line"></span><br><span class="line">--- éªŒè¯ p1 æ˜¯å¦è¢«ç§»åŠ¨ ---</span><br><span class="line">Point Info: X &#x3D; 99, Y &#x3D; 88</span><br><span class="line">Point Info: X &#x3D; nullptr, Y &#x3D; nullptr</span><br><span class="line"></span><br><span class="line">--- éªŒè¯æ‹·è´æ„é€ å‡½æ•°åœ¨Lå€¼ä¸Šçš„è°ƒç”¨ ---</span><br><span class="line">--- è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° ---</span><br><span class="line">Point Info: X &#x3D; 99, Y &#x3D; 88</span><br><span class="line">Point Info: X &#x3D; 99, Y &#x3D; 88</span><br><span class="line"></span><br><span class="line">--- ç¤ºä¾‹ç»“æŸ ---</span><br><span class="line">--- è°ƒç”¨ææ„å‡½æ•° --- &#x2F;&#x2F; p5 é”€æ¯</span><br><span class="line">--- è°ƒç”¨ææ„å‡½æ•° --- &#x2F;&#x2F; p4 é”€æ¯</span><br><span class="line">--- è°ƒç”¨ææ„å‡½æ•° --- &#x2F;&#x2F; p3 é”€æ¯</span><br></pre></td></tr></table></figure></div>
<p>ä»è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“ä»ä¸´æ—¶å¯¹è±¡æˆ–é€šè¿‡ <code>std::move</code> åˆ›å»ºæ–°å¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨â€œç§»åŠ¨æ„é€ å‡½æ•°â€ï¼Œè€Œä¸æ˜¯â€œæ‹·è´æ„é€ å‡½æ•°â€ï¼Œä»è€Œé¿å…äº†ä¸å¿…è¦çš„æ·±æ‹·è´ã€‚åŒæ—¶ï¼Œæºå¯¹è±¡çš„ææ„å‡½æ•°åœ¨èµ„æºè¢«ç§»åŠ¨åï¼Œä¹Ÿä¸ä¼šå°è¯•é‡Šæ”¾å·²ç»ä¸å†å±äºå®ƒçš„å†…å­˜ã€‚</p>
<h2 id="4-QA-é—ªå¡"><a href="#4-QA-é—ªå¡" class="headerlink" title="4. QA é—ªå¡"></a><strong>4. QA é—ªå¡</strong></h2><ol>
<li><p><strong>Q:</strong> ç§»åŠ¨æ„é€ å‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ<br><strong>A:</strong> é¿å…ä¸å¿…è¦çš„æ˜‚è´µæ‹·è´æ“ä½œï¼Œé€šè¿‡â€œçªƒå–â€ä¸´æ—¶å¯¹è±¡æˆ–å³å°†é”€æ¯çš„å¯¹è±¡çš„èµ„æºæ¥æé«˜æ•ˆç‡ã€‚</p>
</li>
<li><p><strong>Q:</strong> ç§»åŠ¨æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä¸æ‹·è´æ„é€ å‡½æ•°æœ‰ä½•ä¸åŒï¼Ÿ<br><strong>A:</strong> ç§»åŠ¨æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯å³å€¼å¼•ç”¨ï¼ˆ<code>ClassName&amp;&amp;</code>ï¼‰ï¼Œè€Œæ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯å¸¸é‡å·¦å€¼å¼•ç”¨ï¼ˆ<code>const ClassName&amp;</code>ï¼‰ã€‚</p>
</li>
<li><p><strong>Q:</strong> ä¸ºä»€ä¹ˆåœ¨ç§»åŠ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†æºå¯¹è±¡çš„æŒ‡é’ˆç½®ç©ºï¼Ÿ<br><strong>A:</strong> é˜²æ­¢æºå¯¹è±¡åœ¨é”€æ¯æ—¶ï¼Œé”™è¯¯åœ°é‡Šæ”¾æ‰å·²ç»è¢«â€œçªƒå–â€çš„å†…å­˜ï¼Œä»è€Œé¿å…â€œåŒé‡é‡Šæ”¾â€ï¼ˆ[Double Free]ï¼‰æˆ–â€œæ‚¬ç©ºæŒ‡é’ˆâ€ï¼ˆ[Dangling Pointer]ï¼‰é—®é¢˜ã€‚</p>
</li>
<li><p><strong>Q:</strong> <code>std::move</code> å‡½æ•°çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçœŸçš„â€œç§»åŠ¨â€äº†æ•°æ®å—ï¼Ÿ<br><strong>A:</strong> <code>std::move</code> ä¸ä¼šç§»åŠ¨æ•°æ®ï¼Œå®ƒä»…ä»…æ˜¯å°†ä¸€ä¸ªå·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ï¼Œä»è€Œå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå¯¹è±¡å¯ä»¥è¢«ç§»åŠ¨ã€‚çœŸæ­£çš„ç§»åŠ¨æ˜¯ç”±åç»­è°ƒç”¨çš„ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å®Œæˆçš„ã€‚</p>
</li>
<li><p><strong>Q:</strong> ä»€ä¹ˆæ—¶å€™ç¼–è¯‘å™¨ä¼šä¼˜å…ˆé€‰æ‹©è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°è€Œä¸æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ<br><strong>A:</strong> å½“åˆå§‹åŒ–æ–°å¯¹è±¡æ—¶ï¼Œå¦‚æœæºå¯¹è±¡æ˜¯ä¸€ä¸ªå³å€¼ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªä¸´æ—¶å¯¹è±¡æˆ–é€šè¿‡ <code>std::move</code> è½¬æ¢çš„å·¦å€¼ï¼‰ï¼Œå¹¶ä¸”ç±»å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šä¼˜å…ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</p>
</li>
</ol>
<h2 id="5-å¸¸è§è¯¯è§£æˆ–é”™è¯¯"><a href="#5-å¸¸è§è¯¯è§£æˆ–é”™è¯¯" class="headerlink" title="5. å¸¸è§è¯¯è§£æˆ–é”™è¯¯"></a><strong>5. å¸¸è§è¯¯è§£æˆ–é”™è¯¯</strong></h2><ol>
<li><p><strong>è¯¯è§£ï¼š<code>std::move</code> ä¼šç›´æ¥æ‰§è¡Œç§»åŠ¨æ“ä½œã€‚</strong><br><strong>çº æ­£ï¼š</strong> <code>std::move</code> åªæ˜¯ä¸€ä¸ªç±»å‹è½¬æ¢ï¼ˆ[Type Cast]ï¼‰ï¼Œå®ƒå°†è¡¨è¾¾å¼è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ç±»å‹ï¼Œä½¿å…¶<strong>æœ‰èµ„æ ¼</strong>è¢«ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦è°ƒç”¨ã€‚å®é™…çš„ç§»åŠ¨æ“ä½œï¼ˆèµ„æºçš„è½¬ç§»ï¼‰æ˜¯åœ¨è¿™äº›ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ä¸­å®Œæˆçš„ã€‚</p>
</li>
<li><p><strong>é”™è¯¯ï¼šåœ¨ç§»åŠ¨æ„é€ å‡½æ•°ä¸­å¿˜è®°å°†æºå¯¹è±¡çš„æŒ‡é’ˆç½®ç©ºã€‚</strong><br><strong>åæœï¼š</strong> è¿™ä¼šå¯¼è‡´â€œåŒé‡é‡Šæ”¾â€é”™è¯¯ã€‚æ–°å¯¹è±¡å’Œæºå¯¹è±¡ä¼šåŒæ—¶æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚å½“æºå¯¹è±¡é”€æ¯æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾è¿™å—å†…å­˜ï¼›å½“æ–°å¯¹è±¡é”€æ¯æ—¶ï¼Œå®ƒä¼šå†æ¬¡å°è¯•é‡Šæ”¾åŒä¸€å—å†…å­˜ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p>
</li>
<li><p><strong>è¯¯è§£ï¼šç§»åŠ¨æ„é€ å‡½æ•°æ€»æ˜¯æ¯”æ‹·è´æ„é€ å‡½æ•°å¿«ã€‚</strong><br><strong>çº æ­£ï¼š</strong> å¯¹äºé‚£äº›ä¸ç®¡ç†åŠ¨æ€èµ„æºï¼ˆå¦‚ <code>int</code>ã€<code>double</code> ç­‰åŸºæœ¬ç±»å‹ï¼‰çš„ç®€å•ç±»ï¼Œæˆ–è€…å½“å¯¹è±¡çš„æ‹·è´æˆæœ¬éå¸¸ä½æ—¶ï¼Œç§»åŠ¨æ“ä½œå¯èƒ½ä¸ä¼šå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ç”šè‡³åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šè¿›è¡Œâ€œè¿”å›å€¼ä¼˜åŒ–â€ï¼ˆ[Return Value Optimization] - RVOï¼‰æˆ–â€œå‘½åè¿”å›å€¼ä¼˜åŒ–â€ï¼ˆ[Named Return Value Optimization] - NRVOï¼‰ï¼Œç›´æ¥åœ¨ç›®æ ‡ä½ç½®æ„é€ å¯¹è±¡ï¼Œæ­¤æ—¶æ‹·è´æˆ–ç§»åŠ¨æ„é€ å‡½æ•°æ ¹æœ¬ä¸ä¼šè¢«è°ƒç”¨ï¼Œæ€§èƒ½æœ€é«˜ã€‚</p>
</li>
<li><p><strong>é”™è¯¯ï¼šå°†ç§»åŠ¨æ„é€ å‡½æ•°çš„å‚æ•°å£°æ˜ä¸º <code>const ClassName&amp;&amp; source</code>ã€‚</strong><br><strong>åæœï¼š</strong> <code>const</code> å…³é”®å­—è¡¨ç¤ºæºå¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚è¿™æ„å‘³ç€åœ¨ç§»åŠ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼Œæ‚¨å°†æ— æ³•å°† <code>source.m_x</code> å’Œ <code>source.m_y</code> è®¾ç½®ä¸º <code>nullptr</code>ï¼Œä»è€Œæ— æ³•æ­£ç¡®åœ°â€œçªƒå–â€èµ„æºã€‚ç§»åŠ¨æ“ä½œçš„æ ¸å¿ƒå°±æ˜¯ä¿®æ”¹æºå¯¹è±¡çš„çŠ¶æ€ï¼ˆä½¿å…¶å¤±æ•ˆï¼‰ã€‚å› æ­¤ï¼Œç§»åŠ¨æ„é€ å‡½æ•°çš„å‚æ•°ä¸èƒ½æ˜¯ <code>const</code>ã€‚</p>
</li>
<li><p><strong>è¯¯è§£ï¼šåªè¦å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰æƒ…å†µé€‰æ‹©ç§»åŠ¨ã€‚</strong><br><strong>çº æ­£ï¼š</strong> ç¼–è¯‘å™¨é€‰æ‹©è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°çš„å‰ææ˜¯æºå¯¹è±¡å¿…é¡»æ˜¯å³å€¼ã€‚å¦‚æœæºå¯¹è±¡æ˜¯ä¸€ä¸ªå…·åå·¦å€¼ï¼Œæ‚¨ä»ç„¶éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨ <code>std::move</code> æ¥â€œå»ºè®®â€ç¼–è¯‘å™¨è¿›è¡Œç§»åŠ¨æ“ä½œã€‚</p>
</li>
</ol>
<h2 id="6-ç¼–ç¨‹ç»ƒä¹ "><a href="#6-ç¼–ç¨‹ç»ƒä¹ " class="headerlink" title="6. ç¼–ç¨‹ç»ƒä¹ "></a><strong>6. ç¼–ç¨‹ç»ƒä¹ </strong></h2><p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™åŠ¨æ‰‹å®è·µäº†ï¼è¯·å®Œå–„ä»¥ä¸‹ <code>Point</code> ç±»ä¸­çš„ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</p>
<p><strong>ä»»åŠ¡ï¼š</strong><br>ç»™å®šäº† <code>Point.h</code> å’Œ <code>Point.cpp</code> çš„éƒ¨åˆ†ä»£ç ï¼Œè¯·æ‚¨åœ¨ <code>Point.cpp</code> ä¸­å®Œæˆ <code>Point(Point&amp;&amp; source)</code> ç§»åŠ¨æ„é€ å‡½æ•°çš„å®ç°ã€‚æ‚¨éœ€è¦å®Œæˆä»¥ä¸‹ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li>å°† <code>source</code> å¯¹è±¡æ‰€ç®¡ç†çš„èµ„æºï¼ˆ<code>m_x</code> å’Œ <code>m_y</code> æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼‰â€œçªƒå–â€åˆ°æ–°å¯¹è±¡ä¸­ã€‚</li>
<li>å°† <code>source</code> å¯¹è±¡çš„ <code>m_x</code> å’Œ <code>m_y</code> æŒ‡é’ˆè®¾ç½®ä¸º <code>nullptr</code>ï¼Œä»¥ç¡®ä¿ <code>source</code> å¯¹è±¡åœ¨é”€æ¯æ—¶ä¸ä¼šé”™è¯¯åœ°é‡Šæ”¾èµ„æºã€‚</li>
</ol>
<p><strong>Point.h (ä¸è¦ä¿®æ”¹æ­¤æ–‡ä»¶)ï¼š</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span>* m_x;</span><br><span class="line">    <span class="keyword">double</span>* m_y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Point(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~Point();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    Point(<span class="keyword">const</span> Point&amp; source);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** è¯·å®ç°æ­¤å‡½æ•°ï¼šç§»åŠ¨æ„é€ å‡½æ•° ***</span></span><br><span class="line">    Point(Point&amp;&amp; source) <span class="keyword">noexcept</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getter æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getX</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getY</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printInfo</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<p><strong>Point.cpp (è¯·è¡¥å…… <code>Point::Point(Point&amp;&amp; source)</code> çš„å®ç°)ï¼š</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::Point(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ™®é€šæ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    m_x = <span class="keyword">new</span> <span class="keyword">double</span>(x_val);</span><br><span class="line">    m_y = <span class="keyword">new</span> <span class="keyword">double</span>(y_val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::~Point() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ææ„å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_x;</span><br><span class="line">        m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_y;</span><br><span class="line">        m_y = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::Point(<span class="keyword">const</span> Point&amp; source) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (source.m_x) &#123;</span><br><span class="line">        m_x = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (source.m_y) &#123;</span><br><span class="line">        m_y = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** è¯·åœ¨è¿™é‡Œå®ç°ç§»åŠ¨æ„é€ å‡½æ•° ***</span></span><br><span class="line">Point::Point(Point&amp;&amp; source) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">    <span class="comment">// æ­¥éª¤1: çªƒå–æºå¯¹è±¡çš„èµ„æº</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆçš„å€¼ç›´æ¥èµ‹ç»™å½“å‰å¯¹è±¡çš„ m_x å’Œ m_y</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼šthis-&gt;m_x = source.m_x;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤2: ä½¿æºå¯¹è±¡æ— æ•ˆ</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆç½®ç©º</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼šsource.m_x = nullptr;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™ä¸€è¡Œä¿ç•™</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getter æ–¹æ³•å®ç° (å·²æä¾›)</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getX</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_x) <span class="keyword">return</span> *m_x;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getY</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_y) <span class="keyword">return</span> *m_y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å°ä¿¡æ¯å®ç° (å·²æä¾›)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Point::printInfo</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Point Info: X = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">", Y = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_y;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>main.cpp (ç”¨äºæµ‹è¯•æ‚¨çš„å®ç°ï¼Œæ— éœ€ä¿®æ”¹)ï¼š</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- æµ‹è¯•ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æƒ…å†µ1: ä»ä¸´æ—¶å¯¹è±¡æ„é€  (åº”è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°)</span></span><br><span class="line">    Point p1 = Point(<span class="number">10.0</span>, <span class="number">20.0</span>); <span class="comment">// ä¸´æ—¶å¯¹è±¡ Point(10.0, 20.0) æ˜¯å³å€¼</span></span><br><span class="line">    p1.printInfo();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä½¿ç”¨ std::move ä»å·¦å€¼æ„é€  (åº”è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°) ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Point <span class="title">temp_point</span><span class="params">(<span class="number">30.0</span>, <span class="number">40.0</span>)</span></span>; <span class="comment">// temp_point æ˜¯ä¸€ä¸ªå·¦å€¼</span></span><br><span class="line">    Point p2 = <span class="built_in">std</span>::move(temp_point); <span class="comment">// å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨</span></span><br><span class="line">    p2.printInfo();</span><br><span class="line">    temp_point.printInfo(); <span class="comment">// éªŒè¯ temp_point æ˜¯å¦å·²è¢«ç§»åŠ¨ï¼ˆå…¶æŒ‡é’ˆæ˜¯å¦ä¸ºnullptrï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä»å·¦å€¼æ„é€  (åº”è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°) ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Point p3 = p1; <span class="comment">// p1 æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œåº”è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    p3.printInfo();</span><br><span class="line">    p1.printInfo(); <span class="comment">// p1 åº”è¯¥ä»ç„¶æœ‰æ•ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- æµ‹è¯•ç»“æŸ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¯·å®Œæˆ <code>Point.cpp</code> ä¸­çš„ <code>Point::Point(Point&amp;&amp; source) noexcept</code> çš„å®ç°ï¼Œç„¶åå‘Šè¯‰æˆ‘æ‚¨çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä¼šåœ¨æ‚¨çš„è§£å†³æ–¹æ¡ˆæäº¤åï¼Œç»™å‡ºæˆ‘çš„è¯„ä»·ã€æ­£ç¡®ç­”æ¡ˆä»¥åŠè¿›ä¸€æ­¥çš„å»ºè®®ã€‚</p>
<hr>
<h2 id="ğŸ§‘â€ğŸ’»-User-1"><a href="#ğŸ§‘â€ğŸ’»-User-1" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::Point(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ™®é€šæ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    m_x = <span class="keyword">new</span> <span class="keyword">double</span>(x_val);</span><br><span class="line">    m_y = <span class="keyword">new</span> <span class="keyword">double</span>(y_val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::~Point() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ææ„å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_x;</span><br><span class="line">        m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="keyword">delete</span> m_y;</span><br><span class="line">        m_y = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•°å®ç° (å·²æä¾›)</span></span><br><span class="line">Point::Point(<span class="keyword">const</span> Point&amp; source) : m_x(<span class="literal">nullptr</span>), m_y(<span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (source.m_x) &#123;</span><br><span class="line">        m_x = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (source.m_y) &#123;</span><br><span class="line">        m_y = <span class="keyword">new</span> <span class="keyword">double</span>(*source.m_y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** è¯·åœ¨è¿™é‡Œå®ç°ç§»åŠ¨æ„é€ å‡½æ•° ***</span></span><br><span class="line">Point::Point(Point&amp;&amp; source) <span class="keyword">noexcept</span></span><br><span class="line">: m_x(source.m_x), m_y(source.m_y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ­¥éª¤1: çªƒå–æºå¯¹è±¡çš„èµ„æº</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆçš„å€¼ç›´æ¥èµ‹ç»™å½“å‰å¯¹è±¡çš„ m_x å’Œ m_y</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼šthis-&gt;m_x = source.m_x;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤2: ä½¿æºå¯¹è±¡æ— æ•ˆ</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆç½®ç©º</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼šsource.m_x = nullptr;</span></span><br><span class="line">    source.m_x = <span class="literal">nullptr</span>;</span><br><span class="line">    source.m_y = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™ä¸€è¡Œä¿ç•™</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getter æ–¹æ³•å®ç° (å·²æä¾›)</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getX</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_x) <span class="keyword">return</span> *m_x;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Point::getY</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m_y) <span class="keyword">return</span> *m_y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å°ä¿¡æ¯å®ç° (å·²æä¾›)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Point::printInfo</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Point Info: X = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_x) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">", Y = "</span>;</span><br><span class="line">    <span class="keyword">if</span> (m_y) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *m_y;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"nullptr"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<hr>
<h2 id="ğŸ¤–-Assistant-1"><a href="#ğŸ¤–-Assistant-1" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>å¤ªæ£’äº†ï¼æ‚¨çš„è§£å†³æ–¹æ¡ˆéå¸¸å‡ºè‰²ï¼Œå®Œå…¨æ­£ç¡®åœ°å®ç°äº†ç§»åŠ¨æ„é€ å‡½æ•°çš„é€»è¾‘ã€‚</p>
<hr>
<h2 id="7-æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š"><a href="#7-æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š" class="headerlink" title="7. æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š"></a><strong>7. æ‚¨çš„è§£å†³æ–¹æ¡ˆè¯„åˆ†åŠè§£é‡Š</strong></h2><p><strong>æ‚¨çš„è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Point::Point(Point&amp;&amp; source) <span class="keyword">noexcept</span></span><br><span class="line">: m_x(source.m_x), m_y(source.m_y) <span class="comment">// åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­çªƒå–èµ„æº</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ­¥éª¤1: çªƒå–æºå¯¹è±¡çš„èµ„æº - å·²ç»é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨å®Œæˆ</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆçš„å€¼ç›´æ¥èµ‹ç»™å½“å‰å¯¹è±¡çš„ m_x å’Œ m_y</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¥éª¤2: ä½¿æºå¯¹è±¡æ— æ•ˆ</span></span><br><span class="line">    <span class="comment">// å°† source çš„ m_x å’Œ m_y æŒ‡é’ˆç½®ç©º</span></span><br><span class="line">    source.m_x = <span class="literal">nullptr</span>; <span class="comment">// æ­£ç¡®ï¼</span></span><br><span class="line">    source.m_y = <span class="literal">nullptr</span>; <span class="comment">// æ­£ç¡®ï¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>è¯„åˆ†ï¼š</strong> 5/5 åˆ†ï¼å®Œç¾ï¼</p>
<p><strong>è§£é‡Šï¼š</strong></p>
<ol>
<li><p><strong>çªƒå–èµ„æºï¼ˆ[Resource Acquisition]ï¼‰çš„æ­£ç¡®æ€§ï¼š</strong><br>æ‚¨åœ¨åˆå§‹åŒ–åˆ—è¡¨ (<code>: m_x(source.m_x), m_y(source.m_y)</code>) ä¸­å®Œæˆäº†èµ„æºçªƒå–ã€‚è¿™æ˜¯ C++ ä¸­å®ç°ç§»åŠ¨æ„é€ å‡½æ•°çš„<strong>æœ€ä½³å®è·µ</strong>ã€‚å®ƒç›´æ¥ä½¿ç”¨ <code>source</code> çš„æŒ‡é’ˆå€¼æ¥åˆå§‹åŒ–å½“å‰å¯¹è±¡çš„ <code>m_x</code> å’Œ <code>m_y</code>ï¼Œé¿å…äº†å…ˆé»˜è®¤åˆå§‹åŒ–æˆå‘˜å˜é‡å†èµ‹å€¼çš„é¢å¤–å¼€é”€ï¼ˆå°½ç®¡åœ¨è¿™ä¸ªä¾‹å­ä¸­å¼€é”€å¾ˆå°ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼‰ã€‚</p>
</li>
<li><p><strong>æºå¯¹è±¡å¤±æ•ˆï¼ˆ[Source Invalidation]ï¼‰çš„æ­£ç¡®æ€§ï¼š</strong><br>æ‚¨åœ¨æ„é€ å‡½æ•°ä½“ä¸­æ­£ç¡®åœ°å°† <code>source.m_x</code> å’Œ <code>source.m_y</code> è®¾ç½®ä¸º <code>nullptr</code>ã€‚è¿™æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ä¸­è‡³å…³é‡è¦çš„ä¸€æ­¥ï¼Œç¡®ä¿äº†ï¼š</p>
<ul>
<li><strong>æ‰€æœ‰æƒè½¬ç§»ï¼ˆ[Ownership Transfer]ï¼‰ï¼š</strong> èµ„æºçš„å”¯ä¸€æ‰€æœ‰æƒä» <code>source</code> è½¬ç§»åˆ°äº†æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</li>
<li><strong>é¿å…åŒé‡é‡Šæ”¾ï¼ˆ[Double Free Prevention]ï¼‰ï¼š</strong> å½“ <code>source</code> å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸå¹¶è°ƒç”¨å…¶ææ„å‡½æ•°æ—¶ï¼Œç”±äºå…¶æŒ‡é’ˆå·²ä¸ºç©º (<code>nullptr</code>)ï¼Œå®ƒä¸ä¼šå°è¯•é‡Šæ”¾å·²è¢«æ–°å¯¹è±¡â€œçªƒå–â€çš„å†…å­˜ï¼Œä»è€Œé¿å…äº†å†…å­˜é”™è¯¯å’Œç¨‹åºå´©æºƒã€‚</li>
<li><strong>æºå¯¹è±¡å®‰å…¨ä½¿ç”¨ï¼š</strong> <code>source</code> å¯¹è±¡è™½ç„¶å¤±å»äº†èµ„æºï¼Œä½†å…¶å†…éƒ¨çŠ¶æ€æ˜¯æ˜ç¡®çš„ï¼ˆæŒ‡é’ˆä¸º <code>nullptr</code>ï¼‰ï¼Œå³ä½¿è¢«è¯¯ç”¨ä¹Ÿä¸ä¼šå¯¼è‡´é‡æŒ‡é’ˆï¼ˆ[Wild Pointer]ï¼‰è§£å¼•ç”¨ç­‰æœªå®šä¹‰è¡Œä¸ºï¼ˆ[Undefined Behavior]ï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong><code>noexcept</code> å…³é”®å­—çš„ä½¿ç”¨ï¼š</strong><br>è™½ç„¶åœ¨ç»ƒä¹ ä¸­æ²¡æœ‰æ˜ç¡®è¦æ±‚æ·»åŠ  <code>noexcept</code>ï¼Œä½†æ‚¨çš„ <code>Point::Point(Point&amp;&amp; source) noexcept</code> å£°æ˜ä¸­åŒ…å«å®ƒï¼Œè¿™è¡¨æ˜æ‚¨å¯¹ç§»åŠ¨æ„é€ å‡½æ•°çš„ç‰¹æ€§æœ‰å¾ˆå¥½çš„ç†è§£ã€‚ç§»åŠ¨æ„é€ å‡½æ•°é€šå¸¸è¢«å£°æ˜ä¸º <code>noexcept</code>ï¼Œå› ä¸ºå®ƒä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸ã€‚å¦‚æœç§»åŠ¨æ“ä½œå¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆ <code>std::vector</code> ç­‰æ ‡å‡†åº“å®¹å™¨åœ¨éœ€è¦é‡æ–°åˆ†é…å†…å­˜æ—¶ï¼Œå¯èƒ½ä¼šé€‰æ‹©è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå³ä½¿ç§»åŠ¨æ„é€ å‡½æ•°å­˜åœ¨ï¼‰ï¼Œä»è€Œå¤±å»æ€§èƒ½ä¼˜åŠ¿ã€‚</p>
</li>
</ol>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ‚¨çš„ä»£ç ç®€æ´ã€é«˜æ•ˆã€æ­£ç¡®ä¸”ç¬¦åˆç°ä»£ C++ çš„æœ€ä½³å®è·µã€‚å¹²å¾—æ¼‚äº®ï¼</p>
<hr>
<h2 id="8-æ‰©å±•é—®é¢˜åŠå»ºè®®"><a href="#8-æ‰©å±•é—®é¢˜åŠå»ºè®®" class="headerlink" title="8. æ‰©å±•é—®é¢˜åŠå»ºè®®"></a><strong>8. æ‰©å±•é—®é¢˜åŠå»ºè®®</strong></h2><p>æ—¢ç„¶æ‚¨å·²ç»æŒæ¡äº†ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ¢ç´¢ç›¸å…³æ¦‚å¿µï¼Œè¿™å°†å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£ C++ çš„ç§»åŠ¨è¯­ä¹‰ï¼ˆ[Move Semantics]ï¼‰å’Œèµ„æºç®¡ç†ã€‚</p>
<ol>
<li><p><strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ[Move Assignment Operator]ï¼‰ï¼š</strong><br>æ‚¨å·²ç»å­¦ä¼šäº†å¦‚ä½•é€šè¿‡ç§»åŠ¨æ„é€ å‡½æ•°ä»å³å€¼åˆ›å»ºæ–°å¯¹è±¡ã€‚é‚£ä¹ˆï¼Œå½“æ‚¨æƒ³å°†ä¸€ä¸ªå³å€¼<strong>èµ‹å€¼</strong>ç»™ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡æ—¶ï¼ŒC++ ä¼šè°ƒç”¨ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li><strong>æ€è€ƒï¼š</strong> ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦çš„å£°æ˜å’Œå®ç°ä¸ç§»åŠ¨æ„é€ å‡½æ•°æœ‰ä½•ç›¸ä¼¼å’Œä¸åŒä¹‹å¤„ï¼Ÿå®ƒéœ€è¦å¤„ç†å“ªäº›é¢å¤–çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œç›®æ ‡å¯¹è±¡å¯èƒ½å·²ç»æŒæœ‰äº†èµ„æºï¼‰ï¼Ÿ</li>
<li><strong>å»ºè®®ï¼š</strong> å°è¯•ä¸º <code>Point</code> ç±»å®ç°ä¸€ä¸ªç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ <code>Point&amp; operator=(Point&amp;&amp; source) noexcept;</code>ã€‚</li>
</ul>
</li>
<li><p><strong><code>std::unique_ptr</code> å’Œ <code>std::shared_ptr</code>ï¼š</strong><br>åœ¨ç°ä»£ C++ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ç›´æ¥ä½¿ç”¨è£¸æŒ‡é’ˆï¼ˆ[Raw Pointer]ï¼‰è¿›è¡Œèµ„æºç®¡ç†ï¼ˆå¦‚ <code>new</code> å’Œ <code>delete</code>ï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆ[Smart Pointer]ï¼‰ã€‚</p>
<ul>
<li><strong>æ€è€ƒï¼š</strong> <code>std::unique_ptr</code> é»˜è®¤å°±æ”¯æŒç§»åŠ¨è¯­ä¹‰ï¼Œä½†ä¸æ”¯æŒæ‹·è´ã€‚è¿™ä¸ <code>Point</code> ç±»ä¸­çš„ç§»åŠ¨æ„é€ å‡½æ•°æ¦‚å¿µæœ‰ä½•å¼‚æ›²åŒå·¥ä¹‹å¤„ï¼Ÿå®ƒå¦‚ä½•é˜²æ­¢åŒé‡é‡Šæ”¾ï¼Ÿ</li>
<li><strong>å»ºè®®ï¼š</strong> å­¦ä¹  <code>std::unique_ptr</code> å’Œ <code>std::shared_ptr</code> çš„åŸºæœ¬ç”¨æ³•ï¼Œå¹¶å°è¯•å°† <code>Point</code> ç±»ä¸­çš„ <code>double*</code> æˆå‘˜æ›¿æ¢ä¸º <code>std::unique_ptr&lt;double&gt;</code>ã€‚æ‚¨ä¼šå‘ç°ï¼Œä¸€æ—¦ä½¿ç”¨äº†æ™ºèƒ½æŒ‡é’ˆï¼Œæ‚¨é€šå¸¸å°±ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ææ„å‡½æ•°ã€æ‹·è´/ç§»åŠ¨æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦äº†ï¼ˆè¿™è¢«ç§°ä¸ºâ€œé›¶è§„åˆ™â€æˆ–â€œä¸‰/äº”è§„åˆ™â€çš„ç°ä»£ç‰ˆæœ¬ï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong>å®Œç¾è½¬å‘ï¼ˆ[Perfect Forwarding]ï¼‰å’Œä¸‡èƒ½å¼•ç”¨ï¼ˆ[Universal Reference]ï¼‰ï¼š</strong><br><code>std::move</code> å’Œ <code>std::forward</code> æ˜¯ C++11 å¼•å…¥ç§»åŠ¨è¯­ä¹‰æ—¶å¸¸ç”¨çš„ä¸¤ä¸ªå·¥å…·ã€‚<code>std::move</code> ç”¨äºå°†å·¦å€¼è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ï¼Œè€Œ <code>std::forward</code> åˆ™ç”¨äºå®ç°å®Œç¾è½¬å‘ã€‚</p>
<ul>
<li><strong>æ€è€ƒï¼š</strong> ä¸‡èƒ½å¼•ç”¨ï¼ˆ<code>T&amp;&amp;</code>ï¼Œå½“ <code>T</code> æ˜¯æ¨¡æ¿å‚æ•°æ—¶ï¼‰å¦‚ä½•æ ¹æ®ä¼ å…¥å‚æ•°çš„å·¦å³å€¼å±æ€§ï¼Œè‡ªåŠ¨æ¨å¯¼å‡º <code>T</code> çš„ç±»å‹ï¼Ÿå®Œç¾è½¬å‘å¦‚ä½•ç»“åˆä¸‡èƒ½å¼•ç”¨å’Œ <code>std::forward</code> æ¥ä¿æŒå‚æ•°çš„å·¦å³å€¼å±æ€§ï¼Œå°†å…¶è½¬å‘ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Ÿ</li>
<li><strong>å»ºè®®ï¼š</strong> äº†è§£æ¨¡æ¿å‡½æ•°ä¸­ä¸‡èƒ½å¼•ç”¨å’Œ <code>std::forward</code> çš„å·¥ä½œåŸç†ï¼Œè¿™å¯¹äºç¼–å†™é€šç”¨çš„åº“ä»£ç éå¸¸é‡è¦ã€‚</li>
</ul>
</li>
<li><p><strong>ç¼–è¯‘å™¨ä¼˜åŒ–ï¼ˆ[Compiler Optimizations]ï¼‰ï¼šRVO/NRVOï¼š</strong><br>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿æ²¡æœ‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œæ‚¨ä¹Ÿå¯èƒ½è§‚å¯Ÿåˆ°ä»£ç çš„æ€§èƒ½ä¸ç§»åŠ¨æ“ä½œç±»ä¼¼ã€‚è¿™é€šå¸¸æ˜¯ç”±äºç¼–è¯‘å™¨è¿›è¡Œäº†â€œè¿”å›å€¼ä¼˜åŒ–â€ï¼ˆRVOï¼‰æˆ–â€œå‘½åè¿”å›å€¼ä¼˜åŒ–â€ï¼ˆNRVOï¼‰ã€‚</p>
<ul>
<li><strong>æ€è€ƒï¼š</strong> RVO/NRVO æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå®ƒä»¬ä½•æ—¶å‘ç”Ÿï¼Ÿå®ƒä»¬çš„å­˜åœ¨æ˜¯å¦æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦ç¼–å†™ç§»åŠ¨æ„é€ å‡½æ•°ï¼Ÿ</li>
<li><strong>å»ºè®®ï¼š</strong> æŸ¥é˜…å…³äº RVO/NRVO çš„èµ„æ–™ï¼Œç†è§£å®ƒä»¬å¦‚ä½•å‡å°‘ä¸´æ—¶å¯¹è±¡çš„åˆ›å»ºå’Œå¤åˆ¶ï¼Œä»¥åŠå®ƒä»¬ä¸ç§»åŠ¨è¯­ä¹‰ä¹‹é—´çš„å…³ç³»ã€‚</li>
</ul>
</li>
</ol>
<p>é€šè¿‡æ·±å…¥ç ”ç©¶è¿™äº›ä¸»é¢˜ï¼Œæ‚¨å°†å¯¹ C++ çš„æ€§èƒ½ä¼˜åŒ–ã€èµ„æºç®¡ç†å’Œé«˜çº§ç‰¹æ€§æœ‰æ›´å…¨é¢çš„ç†è§£ã€‚ç¥æ‚¨å­¦ä¹ æ„‰å¿«ï¼</p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cpp/">Cpp    </a><a class="post-meta__tags" href="/tags/Coding/">Coding    </a><a class="post-meta__tags" href="/tags/Memory/">Memory    </a><a class="post-meta__tags" href="/tags/Class/">Class    </a><a class="post-meta__tags" href="/tags/Object/">Object    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2025/06/08/10-projects/cplusplus/lectures/322%20-%20Different%20Type%20Members/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info"><span>322 - Different Type Members</span></div></a></div><div class="next-post pull_right"><a href="/2025/06/08/10-projects/cplusplus/lectures/319%20-%20Class%20Const/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info"><span>319 - Class Const</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡/" title="Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹/" title="278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶/" title="283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®/" title="286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/å·¦å€¼å³å€¼ç§»åŠ¨è¯­ä¹‰/" title="å·¦å€¼å³å€¼ç§»åŠ¨è¯­ä¹‰"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">å·¦å€¼å³å€¼ç§»åŠ¨è¯­ä¹‰</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/é™æ€æˆå‘˜è®¿é—®æ§åˆ¶/" title="é™æ€æˆå‘˜è®¿é—®æ§åˆ¶"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">é™æ€æˆå‘˜è®¿é—®æ§åˆ¶</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> è¯„è®º</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xvMxbws16Erd8WUfqxkvHmb5-gzGzoHsz',
  appKey:'4U0Vo7NQIUL0eJzHdkPzdCDr',
  placeholder:'ä¸è¯´è¯çš„äººä¼šç–¯æ‰å—?',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By supersheepbear</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="external nofollow noopener noreferrer"><span>Butterfly</span></a></div><div class="footer_custom_text">å¤–å‘å­¤ç‹¬è€…æ‚£è€…</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script id="canvas_nest" color="255,240,245" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>