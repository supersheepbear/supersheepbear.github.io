<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>318 - inline static variable | Bear's dream</title><meta name="description" content="318 - inline static variable"><meta name="keywords" content="Cpp,Coding,Tutorial,Development,Class"><meta name="author" content="supersheepbear"><meta name="copyright" content="supersheepbear"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon_1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="p43hXBn3_dLvbyxUzx0eo5eYmj9OVYOV52pdrhBa2sw"><meta name="baidu-site-verification" content="EXLlfLv2pV"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="318 - inline static variable"><meta name="twitter:description" content="318 - inline static variable"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta property="og:type" content="article"><meta property="og:title" content="318 - inline static variable"><meta property="og:url" content="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/318%20-%20inline%20static%20variable/"><meta property="og:site_name" content="Bear's dream"><meta property="og:description" content="318 - inline static variable"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/318%20-%20inline%20static%20variable/"><link rel="prev" title="313 - friend of class" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/313%20-%20friend%20of%20class/"><link rel="next" title="320 - cpp成员常量 pre cpp17" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/320%20-%20cpp%E6%88%90%E5%91%98%E5%B8%B8%E9%87%8F%20pre%20cpp17/"><link rel="stylesheet" href="hfttps://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Bear's dream" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Bear's dream</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 音乐照片</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 学习计划</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200520153141.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">152</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">151</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">20</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 音乐照片</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 学习计划</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#318-Inline-Static-Variable"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">318 - Inline Static Variable</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#🧑‍💻-User"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">🧑‍💻 User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#🤖-Assistant"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">🤖 Assistant</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#C-进阶：深入理解-inline-static-成员变量"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">C++ 进阶：深入理解 inline static 成员变量</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-详细讲解-Detailed-Explanation"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">1. 详细讲解 (Detailed Explanation)</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-static-成员变量回顾"><span class="toc_mobile_items-number">1.4.1.</span> <span class="toc_mobile_items-text">1.1 static 成员变量回顾</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-“一次定义规则”-One-Definition-Rule-ODR"><span class="toc_mobile_items-number">1.4.2.</span> <span class="toc_mobile_items-text">1.2 “一次定义规则” (One Definition Rule, ODR)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-inline-static-成员变量的引入-C-17"><span class="toc_mobile_items-number">1.4.3.</span> <span class="toc_mobile_items-text">1.3 inline static 成员变量的引入 (C++17)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-4-inline-关键字的作用"><span class="toc_mobile_items-number">1.4.4.</span> <span class="toc_mobile_items-text">1.4 inline 关键字的作用</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-5-C-版本兼容性"><span class="toc_mobile_items-number">1.4.5.</span> <span class="toc_mobile_items-text">1.5 C++ 版本兼容性</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-代码示例-Code-Example"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">2. 代码示例 (Code Example)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-问答闪卡-QA-Flash-Cards"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">3. 问答闪卡 (QA Flash Cards)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-常见误解与错误-Common-Misunderstandings-and-Mistakes"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">4. 常见误解与错误 (Common Misunderstandings and Mistakes)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-编程练习-Coding-Exercise"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">5. 编程练习 (Coding Exercise)</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#318-Inline-Static-Variable"><span class="toc-number">1.</span> <span class="toc-text">318 - Inline Static Variable</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#🧑‍💻-User"><span class="toc-number">1.1.</span> <span class="toc-text">🧑‍💻 User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#🤖-Assistant"><span class="toc-number">1.2.</span> <span class="toc-text">🤖 Assistant</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-进阶：深入理解-inline-static-成员变量"><span class="toc-number">1.3.</span> <span class="toc-text">C++ 进阶：深入理解 inline static 成员变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-详细讲解-Detailed-Explanation"><span class="toc-number">1.4.</span> <span class="toc-text">1. 详细讲解 (Detailed Explanation)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-static-成员变量回顾"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.1 static 成员变量回顾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-“一次定义规则”-One-Definition-Rule-ODR"><span class="toc-number">1.4.2.</span> <span class="toc-text">1.2 “一次定义规则” (One Definition Rule, ODR)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-inline-static-成员变量的引入-C-17"><span class="toc-number">1.4.3.</span> <span class="toc-text">1.3 inline static 成员变量的引入 (C++17)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-inline-关键字的作用"><span class="toc-number">1.4.4.</span> <span class="toc-text">1.4 inline 关键字的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-C-版本兼容性"><span class="toc-number">1.4.5.</span> <span class="toc-text">1.5 C++ 版本兼容性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-代码示例-Code-Example"><span class="toc-number">1.5.</span> <span class="toc-text">2. 代码示例 (Code Example)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-问答闪卡-QA-Flash-Cards"><span class="toc-number">1.6.</span> <span class="toc-text">3. 问答闪卡 (QA Flash Cards)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-常见误解与错误-Common-Misunderstandings-and-Mistakes"><span class="toc-number">1.7.</span> <span class="toc-text">4. 常见误解与错误 (Common Misunderstandings and Mistakes)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-编程练习-Coding-Exercise"><span class="toc-number">1.8.</span> <span class="toc-text">5. 编程练习 (Coding Exercise)</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)"><div id="post-info"><div id="post-title"><div class="posttitle">318 - inline static variable</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2025-06-08<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2025-06-08</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/">10-projects</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/">cplusplus</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/lectures/">lectures</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2025/06/08/10-projects/cplusplus/lectures/318%20-%20inline%20static%20variable/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2025/06/08/10-projects/cplusplus/lectures/318%20-%20inline%20static%20variable/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="318-Inline-Static-Variable"><a href="#318-Inline-Static-Variable" class="headerlink" title="318 - Inline Static Variable"></a>318 - Inline Static Variable</h1><h2 id="🧑‍💻-User"><a href="#🧑‍💻-User" class="headerlink" title="🧑‍💻 User"></a>🧑‍💻 User</h2><p>In this lecture, we’re going to learn about inline static member variables, and these are static membervariables you can set up and initialize them in the class definition itself.If you remember in the last lecture, we weren’t able to do something like this, and if we did that,we did get a compiler error.If we marked the member variable as inline, we are telling the compiler to allow this syntax here tocompile.And what it is going to do is to constrain this member variable to the translation unit where this classis going to show up and that’s going to avoid problems and that’s going to be avoiding one definitionrule issues.And this is going to work.We can’t really say much about how this is going to work under the hood.We’re going to have more details to understand that starting the next chapter.But for now, note that if you want to initialize your static member variable inside the class, youcan mark it as inline and it is going to work.Now that you know this, we’re going to head over to Visual Studio code and play with this a littlemore.Okay.So here we are in our working folder.The current project is in line static member variables.We’re going to grab the files from the last project because we have a good starting point from there.So we’re going to go there and grab everything except for the rooster file because we’re going to bebuilding our own in this lecture and we’re going to paste them in place and we’re going to open thisup in Visual Studio code pretty quick.Okay, We’re going to open up our main CPP file and the point files, and I don’t think we need thesome other translation file anymore so we can ditch it and really take this out.And let’s see, let’s see what we can do.We can delete that.We don’t need this anymore.Let’s remove this and we are going to go in our class and mark our static member variable as inlineand we’re going to be allowed to initialize that like this.The syntax is going to work now because this guy is in line and the compiler knows that this is notgoing to be problematic.If we go in the main function, we can use our program like we have been using it in the last lectureand it is going to work.We’re going to see a one and a four printed out because that’s what we got in the last lecture.And the point count was basically how many points we have created in our program.At this point, we have one, which is this guy here.So we print a one, we’re going to add three points that we store in this array.And if we print here, we’re going to get four points.So let’s build this with GCC.We’re going to do that.The world is good.We can clear and run Rooster.We should see a one and a four.And this is working exactly as we expect.This is really all I wanted you to see in this lecture that you can use inline static member variablesif you want to initialize your thanks in the class declaration itself.And another thing I should point out is that this was only possible starting in C plus plus 17.So if you are on C plus plus 14 or 11 or any other C plus plus version, this is not going to work,but we are using C plus plus 20 here.So this is working.So this is really all I had to share in this lecture.I hope you found it interesting.We are going to stop here in this one.In the next one, we’re going to learn about static constants.Go ahead and finish up here and meet me there.</p>
<hr>
<h2 id="🤖-Assistant"><a href="#🤖-Assistant" class="headerlink" title="🤖 Assistant"></a>🤖 Assistant</h2><p>你好！很高兴能帮助你学习C++。作为一个C++开发者和你的老师，我将用最清晰、最详细的方式来讲解“inline static 成员变量”这个概念。</p>
<hr>
<h2 id="C-进阶：深入理解-inline-static-成员变量"><a href="#C-进阶：深入理解-inline-static-成员变量" class="headerlink" title="C++ 进阶：深入理解 inline static 成员变量"></a><strong>C++ 进阶：深入理解 <code>inline static</code> 成员变量</strong></h2><p><strong>课程摘要：</strong> 本课程将详细讲解C++17引入的 <code>inline static</code> 成员变量。你将学会如何在类定义中直接初始化静态成员变量，以及 <code>inline</code> 关键字在此处的特殊作用，从而避免传统静态成员初始化中的“一次定义规则” [One Definition Rule (ODR)] 问题。</p>
<hr>
<h2 id="1-详细讲解-Detailed-Explanation"><a href="#1-详细讲解-Detailed-Explanation" class="headerlink" title="1. 详细讲解 (Detailed Explanation)"></a><strong>1. 详细讲解 (Detailed Explanation)</strong></h2><p>在C++中，<code>static</code> 关键字有很多用途，其中之一就是修饰类的成员变量。我们首先来回顾一下 <code>static</code> 成员变量，然后引入 <code>inline static</code> 的概念。</p>
<h3 id="1-1-static-成员变量回顾"><a href="#1-1-static-成员变量回顾" class="headerlink" title="1.1 static 成员变量回顾"></a>1.1 <code>static</code> 成员变量回顾</h3><ul>
<li><p><strong>定义：</strong> 当一个类的成员变量被声明为 <code>static</code> 时，它就不再属于类的某个具体对象，而是属于整个类本身。这意味着：</p>
<ul>
<li><strong>共享性：</strong> 所有的类对象共享同一个 <code>static</code> 成员变量的副本。无论你创建多少个类的对象，它们都访问和修改的是同一个 <code>static</code> 成员变量。</li>
<li><strong>生命周期：</strong> <code>static</code> 成员变量的生命周期与程序的生命周期相同。它在程序启动时被创建，在程序结束时被销毁，而不是在对象创建时创建，对象销毁时销毁。</li>
<li><strong>访问方式：</strong> 你可以通过类名直接访问 <code>static</code> 成员变量（例如 <code>ClassName::static_variable</code>），也可以通过对象访问，但通常推荐通过类名访问，因为它更清晰地表明了变量的类级别属性。</li>
</ul>
</li>
<li><p><strong>传统初始化方式：</strong> 在C++17之前（以及对于非 <code>const static</code> 整型成员变量），<code>static</code> 成员变量通常不能在类定义内部直接初始化。你需要在类定义之外，在一个 <code>源文件</code> [.cpp file] 中进行定义和初始化。</p>
<ul>
<li><strong>为什么不能在类内部直接初始化？</strong> 这涉及到C++的“一次定义规则” [One Definition Rule (ODR)]。如果一个 <code>static</code> 成员变量在头文件中被声明，并在头文件中直接初始化，那么当这个头文件被多个 <code>源文件</code> [source files] 包含时，这个 <code>static</code> 成员变量就会在每个 <code>源文件</code> 对应的 <code>翻译单元</code> [translation unit] 中都被定义一次。链接器在尝试将这些 <code>翻译单元</code> 组合成一个可执行文件时，就会发现同一个变量被定义了多次，从而导致链接错误。</li>
</ul>
<p><strong>举例说明传统方式：</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Point.h</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Point();</span><br><span class="line">    <span class="comment">// 声明一个静态成员变量</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> point_count;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Point.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span></span></span><br><span class="line"><span class="comment">// 在源文件中定义并初始化静态成员变量</span></span><br><span class="line"><span class="keyword">int</span> Point::point_count = <span class="number">0</span>; <span class="comment">// 必须在这里初始化</span></span><br><span class="line">Point::Point() &#123;</span><br><span class="line">    point_count++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这种方式确保了 <code>point_count</code> 在整个程序中只有一个定义。</p>
</li>
</ul>
<h3 id="1-2-“一次定义规则”-One-Definition-Rule-ODR"><a href="#1-2-“一次定义规则”-One-Definition-Rule-ODR" class="headerlink" title="1.2 “一次定义规则” (One Definition Rule, ODR)"></a>1.2 “一次定义规则” (One Definition Rule, ODR)</h3><p>“一次定义规则” [One Definition Rule (ODR)] 是C++编程中一个非常重要的概念。它规定了在整个程序中，每个非内联 [non-inline] 的函数、每个变量、每个类型等都只能有唯一的定义。如果同一个实体被定义了多次，就会导致链接错误。对于 <code>static</code> 成员变量而言，传统的做法就是将其定义和初始化放在一个 <code>.cpp</code> 文件中，以确保它只被定义一次。</p>
<h3 id="1-3-inline-static-成员变量的引入-C-17"><a href="#1-3-inline-static-成员变量的引入-C-17" class="headerlink" title="1.3 inline static 成员变量的引入 (C++17)"></a>1.3 <code>inline static</code> 成员变量的引入 (C++17)</h3><p>从C++17标准开始，C++引入了一个非常方便的特性：允许在类定义内部直接初始化 <code>static</code> 成员变量，只需要给它加上 <code>inline</code> 关键字。</p>
<ul>
<li><p><strong>语法：</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ClassName.h</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keyword">int</span> static_member_variable = initial_value;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>它解决了什么问题？</strong> 它的主要目的是为了方便，特别是对于那些需要在头文件中定义和初始化的 <code>static</code> 成员变量，比如在 <code>header-only</code> 库中。通过 <code>inline static</code>，你不再需要额外的 <code>.cpp</code> 文件来定义和初始化这些静态成员。</p>
</li>
</ul>
<h3 id="1-4-inline-关键字的作用"><a href="#1-4-inline-关键字的作用" class="headerlink" title="1.4 inline 关键字的作用"></a>1.4 <code>inline</code> 关键字的作用</h3><p>你可能已经知道，<code>inline</code> 关键字可以用于函数，作为对编译器的“建议”，希望编译器将函数体直接展开到调用点，以减少函数调用的开销。但当 <code>inline</code> 用于 <code>static</code> 成员变量时，它的作用完全不同，它主要与“一次定义规则” [One Definition Rule (ODR)] 相关：</p>
<ul>
<li><strong>允许在多个翻译单元中定义：</strong> 当一个 <code>static</code> 成员变量被标记为 <code>inline</code> 时，编译器就知道，即使这个变量在多个 <code>翻译单元</code> [translation units]（即多个 <code>.cpp</code> 文件编译后的目标文件）中都被定义和初始化了，它也是合法的。</li>
<li><strong>链接器处理：</strong> 链接器在最终链接时会确保所有这些定义都指向同一个实际的变量实例，从而避免了链接错误。它就像编译器和链接器之间的一个特殊约定：<code>inline</code> 的 <code>static</code> 成员变量允许在多个地方出现定义，但最终只会被“挑选”一个出来使用。</li>
</ul>
<p><strong>总结一下 <code>inline static</code> 的核心：</strong><br>它允许你在 <code>头文件</code> [header file] 中的类定义内部声明和初始化 <code>static</code> 成员变量，同时避免了传统 <code>static</code> 成员变量可能导致的 <code>ODR</code> 问题。这使得代码更简洁，特别是对于小型项目或 <code>header-only</code> 库非常有用。</p>
<h3 id="1-5-C-版本兼容性"><a href="#1-5-C-版本兼容性" class="headerlink" title="1.5 C++ 版本兼容性"></a>1.5 C++ 版本兼容性</h3><p><strong>非常重要的一点：</strong> <code>inline static</code> 成员变量是在 <strong>C++17</strong> 标准中引入的。这意味着如果你使用C++11、C++14或更早的标准，这个特性将不可用，编译器会报错。在学习或使用时，请确保你的编译器支持C++17或更高版本（例如C++20）。本课程中，我们假设你使用的是C++17或C++20。</p>
<h2 id="2-代码示例-Code-Example"><a href="#2-代码示例-Code-Example" class="headerlink" title="2. 代码示例 (Code Example)"></a><strong>2. 代码示例 (Code Example)</strong></h2><p>让我们根据课程内容，通过一个具体的代码示例来理解 <code>inline static</code> 成员变量的使用。</p>
<p><strong>目标：</strong> 我们将创建一个 <code>Point</code> 类，并使用 <code>inline static</code> 成员变量 <code>point_count</code> 来追踪创建了多少个 <code>Point</code> 对象。</p>
<p>首先，设置你的项目。假设你有一个名为 <code>inline_static_member_variables</code> 的工作文件夹。</p>
<p><strong>文件结构：</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inline_static_member_variables&#x2F;</span><br><span class="line">├── Point.h</span><br><span class="line">└── main.cpp</span><br></pre></td></tr></table></figure></div></p>
<p><strong>Point.h (类的定义)</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once <span class="comment">// 防止头文件被多次包含</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 构造函数：每创建一个Point对象，就增加point_count</span></span><br><span class="line">    Point(); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 析构函数：虽然这里我们不减少point_count，但好的实践会考虑资源释放</span></span><br><span class="line">    <span class="comment">// ~Point(); </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取当前Point对象的ID（假设我们给每个Point一个独特的ID）</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_id</span><span class="params">()</span> <span class="keyword">const</span></span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++17特性：inline static 成员变量</span></span><br><span class="line">    <span class="comment">// 我们现在可以在类定义内部直接声明并初始化静态成员变量</span></span><br><span class="line">    <span class="comment">// 它是一个int类型，名为 point_count，初始值为0</span></span><br><span class="line">    <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keyword">int</span> point_count = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> m_id; <span class="comment">// 每个Point对象的唯一ID</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></p>
<p><strong>main.cpp (程序入口)</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // 用于输入输出</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;   // 用于存储Point对象</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Point.h"</span>  <span class="comment">// 包含Point类的定义</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Point类的实现，放在main.cpp中或单独的Point.cpp中</span></span><br><span class="line"><span class="comment">// 为了简化，我们直接放在main.cpp中（实际项目中Point.cpp更规范）</span></span><br><span class="line">Point::Point() &#123;</span><br><span class="line">    <span class="comment">// 每次创建Point对象时，m_id 设置为当前的 point_count 值，然后 point_count 递增</span></span><br><span class="line">    <span class="comment">// 这样每个Point对象都会有一个从0开始递增的唯一ID</span></span><br><span class="line">    m_id = point_count; </span><br><span class="line">    point_count++; <span class="comment">// 每次构造函数被调用时，静态变量 point_count 就会增加</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Point::get_id</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> m_id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"欢迎来到 inline static 成员变量学习！"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 在创建任何Point对象之前，打印 point_count</span></span><br><span class="line">    <span class="comment">// 此时 point_count 应该为 0 (或者如果Point::Point() 已经初始化了第一个对象，则为1)</span></span><br><span class="line">    <span class="comment">// 根据Point::Point()的实现，m_id = point_count; point_count++;</span></span><br><span class="line">    <span class="comment">// 如果 main 函数中第一个 Point 是 `Point p1;` 那么第一个 m_id 为 0，point_count 变为 1</span></span><br><span class="line">    <span class="comment">// 如果是 Point::point_count = 0; 那么 m_id 为 0。</span></span><br><span class="line">    <span class="comment">// 在这里我们是创建了一个 Point 对象 p1。</span></span><br><span class="line">    Point p1; <span class="comment">// 创建第一个Point对象</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"创建第一个Point对象后，当前 Point 数量: "</span> &lt;&lt; Point::point_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// 预计输出 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 创建一个Point对象的数组，并添加一些对象</span></span><br><span class="line">    <span class="comment">// 这将创建 3 个额外的Point对象</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Point&gt; points_array;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">        points_array.emplace_back(); <span class="comment">// 使用emplace_back效率更高</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"再创建3个Point对象后，当前 Point 数量: "</span> &lt;&lt; Point::point_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// 预计输出 1 + 3 = 4</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"示例完成！"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></p>
<p><strong>编译和运行：</strong></p>
<ol>
<li><strong>保存文件：</strong> 将上述代码分别保存为 <code>Point.h</code> 和 <code>main.cpp</code>。</li>
<li><strong>打开终端/命令提示符：</strong> 导航到你保存文件的目录。</li>
<li><strong>编译 (使用 g++ 或 clang++)：</strong><br>为了确保使用C++17或更高标准，请添加 <code>-std=c++17</code> 或 <code>-std=c++20</code> 标志。<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ main.cpp -o my_program -std=c++17 -Wall -Wextra</span><br></pre></td></tr></table></figure></div>
<ul>
<li><code>g++</code>: C++ 编译器（如果你在Windows上，可能需要安装 MinGW 或 MSYS2；在Linux/macOS上通常预装）。</li>
<li><code>main.cpp</code>: 要编译的源文件。</li>
<li><code>-o my_program</code>: 指定输出可执行文件的名称为 <code>my_program</code> (Windows上是 <code>my_program.exe</code>)。</li>
<li><code>-std=c++17</code>: 启用C++17标准。</li>
<li><code>-Wall -Wextra</code>: 启用所有常用警告和额外警告，帮助你写出更健壮的代码。</li>
</ul>
</li>
<li><strong>运行：</strong><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./my_program</span><br></pre></td></tr></table></figure></div>
<strong>预期输出：</strong><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">------------------------------------------</span><br><span class="line">欢迎来到 inline static 成员变量学习！</span><br><span class="line">------------------------------------------</span><br><span class="line">创建第一个Point对象后，当前 Point 数量: 1</span><br><span class="line">再创建3个Point对象后，当前 Point 数量: 4</span><br><span class="line">------------------------------------------</span><br><span class="line">示例完成！</span><br><span class="line">------------------------------------------</span><br></pre></td></tr></table></figure></div>
这个输出与课程中提到的预期输出 <code>1</code> 和 <code>4</code> 完全一致。</li>
</ol>
<h2 id="3-问答闪卡-QA-Flash-Cards"><a href="#3-问答闪卡-QA-Flash-Cards" class="headerlink" title="3. 问答闪卡 (QA Flash Cards)"></a><strong>3. 问答闪卡 (QA Flash Cards)</strong></h2><p><strong>Q1:</strong> <code>inline static</code> 成员变量和普通的 <code>static</code> 成员变量在声明和初始化上有什么不同？<br><strong>A1:</strong> 普通的 <code>static</code> 成员变量通常在类定义内部声明，但在类定义外部的一个源文件中定义并初始化（因为要遵守ODR）。而 <code>inline static</code> 成员变量允许在类定义内部直接声明并初始化，并且可以在多个翻译单元中出现，链接器会处理好 ODR 问题。</p>
<p><strong>Q2:</strong> 为什么C++17之前不能在类定义内部直接初始化 <code>static</code> 成员变量（除了 <code>const static</code> 整型）？<br><strong>A2:</strong> 主要是因为“一次定义规则” [One Definition Rule (ODR)]。如果头文件中的 <code>static</code> 成员变量在类定义内部被初始化，当该头文件被多个源文件包含时，这个变量就会被定义多次，导致链接错误。</p>
<p><strong>Q3:</strong> <code>inline</code> 关键字用于 <code>static</code> 成员变量时，其主要作用是什么？<br><strong>A3:</strong> <code>inline</code> 关键字在这里并不意味着强制内联代码，而是告诉编译器和链接器，允许这个 <code>static</code> 成员变量在多个 <code>翻译单元</code> [translation units] 中被定义。链接器在最终链接时会确保所有这些定义都指向同一个实际的变量实例，从而避免了 ODR 问题。</p>
<p><strong>Q4:</strong> 从哪个C++标准版本开始，<code>inline static</code> 成员变量才被允许使用？<br><strong>A4:</strong> 从 <strong>C++17</strong> 标准开始。</p>
<h2 id="4-常见误解与错误-Common-Misunderstandings-and-Mistakes"><a href="#4-常见误解与错误-Common-Misunderstandings-and-Mistakes" class="headerlink" title="4. 常见误解与错误 (Common Misunderstandings and Mistakes)"></a><strong>4. 常见误解与错误 (Common Misunderstandings and Mistakes)</strong></h2><ol>
<li><strong>误解 <code>inline</code> 的含义：</strong> 最常见的误解是认为 <code>inline static</code> 成员变量的 <code>inline</code> 关键字意味着像内联函数一样，会提升性能或将变量值直接“内联”到使用它的地方。实际上，这里的 <code>inline</code> 与性能无关，它是一个与“一次定义规则” [One Definition Rule (ODR)] 相关的语言规则，允许变量在多个翻译单元中被定义。</li>
<li><strong>C++版本不兼容：</strong> 尝试在C++14或更早版本的项目中编译使用 <code>inline static</code> 成员变量的代码，会导致编译错误。新手可能不清楚这个特性是C++17才引入的。</li>
<li><strong>忘记 <code>static</code> 关键字：</strong> 错误地将 <code>inline</code> 关键字用于非 <code>static</code> 成员变量。<code>inline</code> 只能用于 <code>static</code> 成员变量（或函数），对于普通的成员变量，它没有意义。</li>
<li><strong>误以为所有 <code>static</code> 成员变量都可以这样初始化：</strong> 只有 <strong><code>inline static</code></strong> 成员变量才可以在类内部直接初始化。传统的非 <code>inline static</code> 成员变量（特别是如果你的C++版本低于C++17或者需要旧的行为）仍然需要在类外定义和初始化。</li>
<li><strong>过度使用或滥用：</strong> 尽管 <code>inline static</code> 很方便，但并不是所有 <code>static</code> 成员变量都适合在头文件中初始化。例如，如果静态成员变量的初始化涉及复杂逻辑、依赖其他库或在多个 <code>.cpp</code> 文件中有不同的用途（虽然这种情况不常见且通常是设计问题），则传统的在 <code>.cpp</code> 文件中初始化可能更合适。但在大多数简单计数器或常量场景下，<code>inline static</code> 是非常棒的。</li>
</ol>
<h2 id="5-编程练习-Coding-Exercise"><a href="#5-编程练习-Coding-Exercise" class="headerlink" title="5. 编程练习 (Coding Exercise)"></a><strong>5. 编程练习 (Coding Exercise)</strong></h2><p>现在，请你尝试完成下面的编程练习。你需要修改现有的代码，使其能够追踪并显示程序中所有 <code>Dog</code> 对象的数量。</p>
<p><strong>任务：</strong></p>
<p>在 <code>Dog</code> 类中添加一个 <code>inline static</code> 成员变量 <code>dog_count</code>，用于在每次创建 <code>Dog</code> 对象时增加计数。在 <code>main</code> 函数中，分别在创建第一个 <code>Dog</code> 对象后和创建更多 <code>Dog</code> 对象后，打印当前的 <code>dog_count</code> 值。</p>
<p><strong><code>Dog.h</code>:</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Dog(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name);</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 在这里添加 inline static 成员变量 dog_count 并初始化为 0</span></span><br><span class="line">    <span class="comment">// 例如：inline static int some_variable = 0;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<p><strong><code>main.cpp</code>:</strong></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Dog.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Dog 类的实现 (为了简化，这里直接提供)</span></span><br><span class="line">Dog::Dog(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name) : m_name(name) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Dog "</span> &lt;&lt; m_name &lt;&lt; <span class="string">" created."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 在这里增加 dog_count 的值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dog::print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"This dog's name is: "</span> &lt;&lt; m_name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Dog Counter Exercise ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 创建第一个 Dog 对象，并打印当前的 Dog 数量</span></span><br><span class="line">    <span class="comment">// 例如：Dog d1("Buddy");</span></span><br><span class="line">    <span class="comment">//      std::cout &lt;&lt; "Current dog count: " &lt;&lt; Dog::some_variable &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 创建一个包含 2 个 Dog 对象的 vector，并打印当前的 Dog 数量</span></span><br><span class="line">    <span class="comment">// 例如：std::vector&lt;Dog&gt; dogs;</span></span><br><span class="line">    <span class="comment">//      dogs.emplace_back("Max");</span></span><br><span class="line">    <span class="comment">//      dogs.emplace_back("Bella");</span></span><br><span class="line">    <span class="comment">//      std::cout &lt;&lt; "Current dog count after adding more: " &lt;&lt; Dog::some_variable &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Exercise End ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>请你将代码填写完整，然后告诉我你的解决方案。</p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cpp/">Cpp    </a><a class="post-meta__tags" href="/tags/Coding/">Coding    </a><a class="post-meta__tags" href="/tags/Tutorial/">Tutorial    </a><a class="post-meta__tags" href="/tags/Development/">Development    </a><a class="post-meta__tags" href="/tags/Class/">Class    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2025/06/08/10-projects/cplusplus/lectures/313%20-%20friend%20of%20class/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>313 - friend of class</span></div></a></div><div class="next-post pull_right"><a href="/2025/06/08/10-projects/cplusplus/lectures/320%20-%20cpp%E6%88%90%E5%91%98%E5%B8%B8%E9%87%8F%20pre%20cpp17/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>320 - cpp成员常量 pre cpp17</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/282 - cpp结构体与类的区别和用法/" title="282 - cpp结构体与类的区别和用法"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">282 - cpp结构体与类的区别和用法</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/313 - friend of class/" title="313 - friend of class"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">313 - friend of class</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/329 - 跨文件命名空间/" title="329 - 跨文件命名空间"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">329 - 跨文件命名空间</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/317 - cpp 类级别数据/" title="317 - cpp 类级别数据"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">317 - cpp 类级别数据</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/diff between constexpr and define/" title="diff between constexpr and define"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">diff between constexpr and define</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/静态成员访问控制/" title="静态成员访问控制"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">静态成员访问控制</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xvMxbws16Erd8WUfqxkvHmb5-gzGzoHsz',
  appKey:'4U0Vo7NQIUL0eJzHdkPzdCDr',
  placeholder:'不说话的人会疯掉吗?',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By supersheepbear</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="external nofollow noopener noreferrer"><span>Butterfly</span></a></div><div class="footer_custom_text">外向孤独者患者</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script id="canvas_nest" color="255,240,245" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>