<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´ | Bear's dream</title><meta name="description" content="301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><meta name="keywords" content="Cpp,Function,Class,Object,Programming"><meta name="author" content="supersheepbear"><meta name="copyright" content="supersheepbear"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon_1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="p43hXBn3_dLvbyxUzx0eo5eYmj9OVYOV52pdrhBa2sw"><meta name="baidu-site-verification" content="EXLlfLv2pV"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><meta name="twitter:description" content="301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta property="og:type" content="article"><meta property="og:title" content="301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><meta property="og:url" content="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/301%20-%20%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D/"><meta property="og:site_name" content="Bear's dream"><meta property="og:description" content="301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/301%20-%20%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D/"><link rel="prev" title="281 - cpp this æŒ‡é’ˆè¯¦è§£ä¸åº”ç”¨" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/281%20-%20cpp%20this%20%E6%8C%87%E9%92%88%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%BA%94%E7%94%A8/"><link rel="next" title="321 - ç±»å†…å˜é‡è‡ªå¼•ç”¨" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/321%20-%20%E7%B1%BB%E5%86%85%E5%8F%98%E9%87%8F%E8%87%AA%E5%BC%95%E7%94%A8/"><link rel="stylesheet" href="hfttps://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Bear's dream" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Bear's dream</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> æœç´¢</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200520153141.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">150</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">151</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">18</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">ç›®å½•</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#C-æ‹·è´æ„é€ å‡½æ•°-Copy-Constructor-æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">C++ æ‹·è´æ„é€ å‡½æ•° (Copy Constructor) æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-è¯¦ç»†è§£é‡Š"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">1. è¯¦ç»†è§£é‡Š</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><span class="toc_mobile_items-number">2.1.1.</span> <span class="toc_mobile_items-text">1.1 ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson-ç±»"><span class="toc_mobile_items-number">2.1.2.</span> <span class="toc_mobile_items-text">1.2 æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson ç±»</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´-Shallow-Copy-é—®é¢˜"><span class="toc_mobile_items-number">2.1.3.</span> <span class="toc_mobile_items-text">1.3 é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´ (Shallow Copy) é—®é¢˜</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-4-è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°"><span class="toc_mobile_items-number">2.1.4.</span> <span class="toc_mobile_items-text">1.4 è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-5-å®ç°æ·±æ‹·è´çš„æ­¥éª¤"><span class="toc_mobile_items-number">2.1.5.</span> <span class="toc_mobile_items-text">1.5 å®ç°æ·±æ‹·è´çš„æ­¥éª¤</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-6-æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜-Constructor-Delegation"><span class="toc_mobile_items-number">2.1.6.</span> <span class="toc_mobile_items-text">1.6 æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜ (Constructor Delegation)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-7-ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><span class="toc_mobile_items-number">2.1.7.</span> <span class="toc_mobile_items-text">1.7 ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-8-æ‹·è´æ„é€ å‡½æ•°-Vs-èµ‹å€¼è¿ç®—ç¬¦-Assignment-Operator"><span class="toc_mobile_items-number">2.1.8.</span> <span class="toc_mobile_items-text">1.8 æ‹·è´æ„é€ å‡½æ•° Vs èµ‹å€¼è¿ç®—ç¬¦ (Assignment Operator)</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-9-ææ„å‡½æ•°çš„é‡è¦æ€§"><span class="toc_mobile_items-number">2.1.9.</span> <span class="toc_mobile_items-text">1.9 ææ„å‡½æ•°çš„é‡è¦æ€§</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-ä»£ç ç¤ºä¾‹"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">2. ä»£ç ç¤ºä¾‹</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-QA-é—ªå¡"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">3. QA é—ªå¡</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">4. å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-ç¼–ç ç»ƒä¹ "><span class="toc_mobile_items-number">2.5.</span> <span class="toc_mobile_items-text">5. ç¼–ç ç»ƒä¹ </span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc_mobile_items-number">2.6.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant-1"><span class="toc_mobile_items-number">2.7.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7-è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ"><span class="toc_mobile_items-number">2.8.</span> <span class="toc_mobile_items-text">7. è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#è¯„ä»·ä½ çš„è§£ç­”"><span class="toc_mobile_items-number">2.8.1.</span> <span class="toc_mobile_items-text">è¯„ä»·ä½ çš„è§£ç­”</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š"><span class="toc_mobile_items-number">2.8.2.</span> <span class="toc_mobile_items-text">å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8-å»ºè®®ä¸æ‰©å±•é—®é¢˜"><span class="toc_mobile_items-number">2.9.</span> <span class="toc_mobile_items-text">8. å»ºè®®ä¸æ‰©å±•é—®é¢˜</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User-2"><span class="toc_mobile_items-number">2.10.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant-2"><span class="toc_mobile_items-number">2.11.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><span class="toc-number">1.</span> <span class="toc-text">æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C-æ‹·è´æ„é€ å‡½æ•°-Copy-Constructor-æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´"><span class="toc-number">2.</span> <span class="toc-text">C++ æ‹·è´æ„é€ å‡½æ•° (Copy Constructor) æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-è¯¦ç»†è§£é‡Š"><span class="toc-number">2.1.</span> <span class="toc-text">1. è¯¦ç»†è§£é‡Š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1 ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson-ç±»"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´-Shallow-Copy-é—®é¢˜"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.3 é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´ (Shallow Copy) é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°"><span class="toc-number">2.1.4.</span> <span class="toc-text">1.4 è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-å®ç°æ·±æ‹·è´çš„æ­¥éª¤"><span class="toc-number">2.1.5.</span> <span class="toc-text">1.5 å®ç°æ·±æ‹·è´çš„æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜-Constructor-Delegation"><span class="toc-number">2.1.6.</span> <span class="toc-text">1.6 æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜ (Constructor Delegation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><span class="toc-number">2.1.7.</span> <span class="toc-text">1.7 ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-æ‹·è´æ„é€ å‡½æ•°-Vs-èµ‹å€¼è¿ç®—ç¬¦-Assignment-Operator"><span class="toc-number">2.1.8.</span> <span class="toc-text">1.8 æ‹·è´æ„é€ å‡½æ•° Vs èµ‹å€¼è¿ç®—ç¬¦ (Assignment Operator)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-9-ææ„å‡½æ•°çš„é‡è¦æ€§"><span class="toc-number">2.1.9.</span> <span class="toc-text">1.9 ææ„å‡½æ•°çš„é‡è¦æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-ä»£ç ç¤ºä¾‹"><span class="toc-number">2.2.</span> <span class="toc-text">2. ä»£ç ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-QA-é—ªå¡"><span class="toc-number">2.3.</span> <span class="toc-text">3. QA é—ªå¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯"><span class="toc-number">2.4.</span> <span class="toc-text">4. å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-ç¼–ç ç»ƒä¹ "><span class="toc-number">2.5.</span> <span class="toc-text">5. ç¼–ç ç»ƒä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc-number">2.6.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant-1"><span class="toc-number">2.7.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ"><span class="toc-number">2.8.</span> <span class="toc-text">7. è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è¯„ä»·ä½ çš„è§£ç­”"><span class="toc-number">2.8.1.</span> <span class="toc-text">è¯„ä»·ä½ çš„è§£ç­”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š"><span class="toc-number">2.8.2.</span> <span class="toc-text">å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-å»ºè®®ä¸æ‰©å±•é—®é¢˜"><span class="toc-number">2.9.</span> <span class="toc-text">8. å»ºè®®ä¸æ‰©å±•é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User-2"><span class="toc-number">2.10.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant-2"><span class="toc-number">2.11.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)"><div id="post-info"><div id="post-title"><div class="posttitle">301 - æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> å‘è¡¨äº 2025-06-08<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> æ›´æ–°äº 2025-06-08</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/">10-projects</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/">cplusplus</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/lectures/">lectures</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>è¯„è®ºæ•°:</span><a href="/2025/06/08/10-projects/cplusplus/lectures/301%20-%20%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2025/06/08/10-projects/cplusplus/lectures/301%20-%20%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%B7%B1%E6%8B%B7%E8%B4%9D/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"><a href="#æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´" class="headerlink" title="æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´"></a>æ‹·è´æ„é€ å‡½æ•°æ·±æ‹·è´</h1><h2 id="ğŸ§‘â€ğŸ’»-User"><a href="#ğŸ§‘â€ğŸ’»-User" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><p>In this lecture weâ€™re going to learn about copy constructors, and these are constructors that are calledby the compiler to make copies.If you try to construct a class object from another class object.To really learn about this, weâ€™re going to use a person class.Weâ€™re going to set up a person class.Itâ€™s going to have two sections.Weâ€™re going to have a private section and weâ€™re going to have a public section.The private section is going to have a few member variables.Weâ€™re going to have the last name, which is modeled as an stdstring.Weâ€™re going to have the first name and weâ€™re going to have the age and the public section.Weâ€™re going to have a few constructors.We have the default constructor, which is not going to do anything.Itâ€™s just going to initialize the member variables.However, they were declared, so the name is going to be empty.The first name is going to be empty and the last name is going to be empty and the age is just goingto be a null pointer because the age is modeled as a pointer here.And this is by purpose because there are a few things I want you to see about copy constructors downhere.We have a few other constructors.We have one that only takes the last name, one that takes two parameters, the last name and the firstname, and another that takes all the other parameters, which is going to initialize all our membervariables here.We also have a utility function which is going to print information about a person object.Itâ€™s going to print the memory address where the object lives, and then weâ€™re going to have the lastname, the first name the age, and we can even print the address here.We can print information about our person object here.This is the point.Okay.Now that we know about our class, letâ€™s talk about copies.We have a person object here.Weâ€™re going to set them up and put this information here.The last name is going to be John.The first name is going to be snow and the age is going to be 25.And we can print information about this person, but we can create a copy of this person using the syntaxhere.And C plus plus is going to understand this so we can say person.Person two And we want to create a person two from person one here.And if we do this, this is going to work, but itâ€™s not going to probably do what you expect becausethis is going to copy the member variables one by one from person one to person two.So here is a simple illustration.We have a person one, and we want to create a copy of person one in another person which is calledperson two or P two here.So what this is going to do is do a member wise copy.So itâ€™s going to take the last name in person one and copy that in person.Two, weâ€™re going to have a situation like this.Itâ€™s going to take the first name in person one and copy that in person.Two, weâ€™re going to have a situation like this and then itâ€™s going to copy the age from person onein person two But remember, the age is a pointer.Itâ€™s going to copy the address that is contained in this pointer and put that in person.Two here.And this is going to give us a few problems as we are about to see in the next slides.And copying pointers directly like this is really going to give us problems.Letâ€™s explore this a little more.Here.We have a simple example where we have our person one and person two here and the person two is a copyof person one, as you see through the syntax here.So after we have our two persons created, suppose we want to set the age of person one.We do that through a set age setter that we have in person, which is going to set the age.And after that, if we print the information, weâ€™re going to see that the age for person two was alsochanged because what we really copied is a pointer and the set age is going to dereference the pointerand change what is inside and the change in person.One is also going to be in person.Two So you need to be aware of this.This is a problem and C plus plus is going to introduce this problem by default because C plus plusis going to copy member variables one by one by default, and itâ€™s going to really even copy pointers.So C plus plus does things this way because it generates a default copy constructor for you.And this is a constructor that is going to be used to do the copy we do here.So the syntax we use here is going to call a copy constructor.And in this case we donâ€™t have a copy constructor in person.So the compiler is going to generate a copy constructor and use that.But that generated copy constructor is going to be doing member wise copy from person one to persontwo and it is going to blindly copy the pointer for the age member variable.This is the source of all the problems we have down here of also having the age for person two modifiedthrough changing the age of person one.Hopefully you see the problem here.Okay, so we have a problem here.How do we solve that?The first step is to.Try and see the problem and really prove this, for example, through the debugger.And right now we are using a constructor that is generated by the compiler.So we canâ€™t really set a breakpoint there or really put any stdcout statement to see what is happening.But not to worry.It is possible to set our own copy constructor and use that to see information.We can even go further and disable the default behavior of even copying pointers and really customizeit however we want.So weâ€™re going to do that.Here is our first attempt at setting up a copy constructor and weâ€™re going to set it up like this.Weâ€™re going to set up a constructor which is called Person.This is part of the person class because of this scope resolution operator here.And then weâ€™re going to pass a parameter which is another person by const because we donâ€™t really wantto modify it.We want to read from it.But notice that we are passing this by value.You need to save this.And then in our initializer list, weâ€™re basically going to be copying from the source person to ourperson object that we are building here.So the last name is going to be initialized with the last name from the source person.The first name is going to be initialized with the first name from the source person and the age isgoing to be initialized with the age from the source person.Here we are basically copying member wise.We are doing the same thing the compiler has done for us.So but this is going to be problematic because if you look here we are passing by value and this syntaxis not allowed to be used in C plus plus.The problem is this could lead to an endless chain of copy constructor calls.So why is this?Remember to create an object, we say something like this, we say person P two and use P one to buildour person two object.So when the compiler sees a call like this, it will know that it needs to call a copy constructor.And when it calls the copy constructor, itâ€™s going to see our copy constructor here.But itâ€™s going to see that something is passed by value.And to pass by value you need to call the copy constructor.But the copy constructor itself is taking something by value, so weâ€™re going to keep trying to callthe copy constructor and this is going to be an endless chain of calls to the copy constructor and thisis going to end nowhere.So the designers of C plus plus saw this problem and they disallowed this syntax here to try and setup a copy constructor using an object that you pass by value here.So this is not going to work.If you do this, youâ€™re going to get a compiler error.What if we try and pass by reference?Okay, so the first attempt here is really bad.Itâ€™s not going to work.If youâ€™re trying to use it, youâ€™re going to get a compiler error.But we can try and pass by reference and thatâ€™s what we have here.We are passing our person source person by reference here and it is by const reference because we donâ€™treally want to modify it and we are doing the same thing we did in the last attempt in our initializerlist here.Last name is going to be initialized with the last name of the source person.First name is going to be initialized with the first name of first person here or source person I shouldsay.And the age is going to be initialized with the age of source person here.This is going to do what the C plus plus compiler does.By default, it is doing member wise copy and we are blindly copying the age member variable here andit is a pointer.So weâ€™re going to take the pointer address contained in source and just copy that in destination here,which is this age member variable here.And this is going to also be bad because we just copy the pointer.And if we modify one personâ€™s age, the change is going to be seen in the other personâ€™s age.And we donâ€™t really want that.Okay, so this is bad also, but itâ€™s not as bad as the first attempt, but this is still bad.We need to do better.What we need to do really is to not blindly copy pointers, but set up a new memory address in our newperson object and just copy the value from the source object.And thatâ€™s what we are doing here.So we are copying the last name and the first name as we did in the last two attempts.But notice what we do for the age member variable inside.Weâ€™re going to set up a new memory location and weâ€™re going to use the data from the source object toinitialize this new memory location.And this is going to do what we want.It is not going to do a blind copy of the pointer.It is going to set up a new memory location in our new person object, and then weâ€™re going to use thedata in the source object.And this is good.And if we try to change the person one here, the changes are not.Going to leak into person two and this is going to be good.Okay, so this is what you should do.If you want to set up a copy constructor, you should pass your parameter by const reference as we dohere.And if you have any pointer member variables, you shouldnâ€™t really blindly copy them.You should set up a new memory location in your destination object and then initialize that with thedata from the source object, which is what we are doing here.We are dereferencing the pointer from the source object and we are grabbing the data inside and usingthat to initialize our age pointer here.And this is really good.Okay, so this is one way we have to set up a copy constructor and it is going to work, but it is alsopossible to delegate the work on another constructor.And the last lecture we have learnt about constructor delegation.We can use that with copy constructors and we can do something like this.This is a copy constructor.It is going to take its parameter by const reference here, but notice that we are delegating the workto another constructor, which is going to take three parameters.So this constructor is going to use the data from our source object and weâ€™re going to initialize thelast name here.Weâ€™re going to initialize the first name here and notice that we are dereferencing the pointer and passingthat data to our other constructor because that other constructor is going to set up a new memory locationand use this data here.Okay, so this is how you can delegate the construction from your copy constructor to another constructorthat is going to do the heavy lifting for you.I realize all this can really be confusing, so we are going to head over to Visual Studio code anddo this step by step so that you can really see, okay, here we are in our working folder.The current project is copy constructors.Weâ€™re going to grab our template files and use those.Weâ€™re going to paste those in and we are going to open this in Visual Studio code.Letâ€™s do that by dragging and dropping here.This is going to open our folder and we need our person class that we can use to really learn aboutcopy constructors.Weâ€™re going to set up a header file which is going to be person dot H, and weâ€™re going to set up anotherfile, which is going to be person dot CPP and weâ€™re going to put this in place.I am going to put in the code I have prepared before so that we can really be fast with these things.This is really a simple class.It is called person.We have our member variables, we have a private section and a public section.The private section is going to contain our member variables and weâ€™re going to have our constructorshere, which are going to be used to construct objects of person.We have a destructor, we have a few setters, we have a few getters, and we have a utility functionwhich is going to print information about our person object.Here.I am also going to put in the implementation for our person class and then I am going to try and explainit a little bit.So we have a few member variables.Last name and first name are modeled as STD strings and the age is modeled as a pointer because I wantyou to see problems that might come up if you set up copy constructors and you have pointer member variables.So we really need this.So the constructors are really going to do nothing special.We have a one parameter constructor which is going to delegate the work to another constructor, whichis going to take two parameters.The two parameter constructor is also going to delegate the work to a three parameter constructor,and the three parameter constructor is going to construct our object using this initializer list here.Notice that the three parameter constructor is going to set up a new memory location because if youremember the age is a pointer, so we need to allocate memory to storing the data.So thatâ€™s what we do in the constructor here.Weâ€™re going to say New Ant and weâ€™re going to store in the data that is coming from the age parameterhere and weâ€™re going to set up our object like this.The problem with this is that it is really using strings by copy and this is bad.So we should fix this either by using a const string references or using string views.I am going to use strings that we pass by reference here.So letâ€™s fix this pretty quick.Weâ€™re going to say const string by reference, by reference we should say, and weâ€™re going to say conststring by reference here and const string by reference.Letâ€™s do this and letâ€™s do that here as well.I think we have one left here.Letâ€™s do that const string reference and we could use these parameters in our constructors here.So letâ€™s go back in the CPP file and apply the same changes.Weâ€™re going to say const string reference here.You see we have a few squiggly lines, letâ€™s say const string reference.Weâ€™re going to fix this class a little bit because string.Reference here.Letâ€™s do this.You donâ€™t have to do this.You can just grab the file that will be attached to the resource section of this lecture, and you canuse this class as is here.So letâ€™s say const here and weâ€™re going to say const string reference, letâ€™s do that and const STDstring and weâ€™re going to pass that by reference here and we have our class.So again, we have three member variables and one is a pointer and we have to make sure that the constructorsthat we use allocate new memory to be able to store data in this pointer here.This is what is really important for this class.So now that we have the class, we can head over in the main function and really use it.Weâ€™re going to bring up the sidebar here and head over in the main function and weâ€™re going to includeour person class.So letâ€™s include person.You see that we have this available in the main CPP file here.Weâ€™re going to take out what we donâ€™t need and then weâ€™re going to set up a person object.Weâ€™re going to say person P one and weâ€™re going to put in John and the first name is going to be snowand the age is going to be 25.I think this is what we used in the slides.So letâ€™s use this and we can print information about this person.Letâ€™s do this and weâ€™re going to build and see this printed out on the console.We can close this guy here.We donâ€™t need this for now.You see, the world is good.We can bring up a terminal to really play with us and weâ€™re going to run Rooster.Weâ€™re going to see that we have a person object living at this memory location.The last name is John.The first name is Snow.The age is 25, and the member variable for the age is living at this address here.This is the information we get from our print function, which is living in our header file.Letâ€™s look at it and really see this.So itâ€™s going to print this information here and itâ€™s going to print the value we have in the age pointer.And itâ€™s also going to print the memory location for this pointer here.And we do that by directly printing the pointer.Again, remember the age member variable here is a pointer.And this is key for what we are trying to do in this lecture here.So letâ€™s try and create a copy.Weâ€™re going to go down here and create a new person.Person two We can say p two here, and the syntax to create a person object from another person is passingit as a parameter.So weâ€™re going to pass P one here and this is going to do what we want.This is going to copy data from person one and use that to create a new person object, which is goingto be P two here.And if we try to print P two, weâ€™re going to say print info.Letâ€™s see what we get.The first thing you should notice here is that the syntax here is working because of some heavy liftingthat the compiler is going to do.For us to allow for this syntax here to work.Letâ€™s build and really save this.Weâ€™re going to build with GCC, weâ€™re going to see that the world is good.We can clear and run Rooster.Now weâ€™re going to see that person.One last name is John.First name is age Address.Memory is here and you see that we have the same information in person to person two is going to liveat a different address because it is a separate variable.But what we have inside the last name is John.The first name is Snow.The age is 25.But you see that the address for the age member variable is the same.So it was copied over.So suppose we have three slots and these two person objects, we have one for the last name, we haveanother for the first name and we have another for the age.And we have the same things for person two here.So letâ€™s put three slots here and what the compiler is going to do.If we set up a syntax like this, itâ€™s going to do blind copy of the member variable.So itâ€™s going to have what we have in the last name member variable and itâ€™s going to copy that in theperson to object eight.Itâ€™s going to copy what we have in the last name and itâ€™s going to paste that into the person to object.Itâ€™s going to copy what we have in the age member variable and itâ€™s going to paste that into the agemember variable of person two But remember, the age is modeled as a pointer in our class.And what this is going to do, itâ€™s going to copy the memory location, which is contained in personone, and itâ€™s going to paste that into person two.And thatâ€™s what we see here.We see the memory address in person one For the age member variable.Itâ€™s the same as we have in person two So this is going to cause a few problems.So for example, if we try and modify person one, the changes are going to be seen even in person.Two for the age.So for example, letâ€™s modify the age for person one, weâ€™re going to set age and weâ€™re going to setthe age to 30, for example, and then weâ€™re going to print information for person one.And.Person two After that weâ€™re going to say P one Printinfo and weâ€™re going to say P two Printinfo.Here, if we do this, weâ€™re going to see that the age for these two persons is the same.Even if we really change the age for person one.Letâ€™s put a little separator here so that we can see this on the terminal.Weâ€™re going to put a few dashes.Think this is going to do and weâ€™re going to build this.The bold is going to be good.And if we run this, letâ€™s clear and run Rooster, weâ€™re going to see that the age for person one andperson to have changed to 30 because if we call set age, it is going to dereference the pointer andchange the value inside.The thing is we have the same memory addresses in these two persons object and if you change eitherof these guys, the changes are going to be reflected in both of them.Letâ€™s look at how we change the age in person.I donâ€™t think we really looked at this in detail.Okay, so this is our set age method and youâ€™re going to see that in the body.Weâ€™re going to be dereferencing the age pointer and assigning a value to it.And if we do this in main and change the age for one object and they happen to contain the same address,the changes are going to be reflected in both of them.And this is not what we want.What we would want if we copied a person object like this is for person two not to be affected by thechanges we do in person.One And the reason for this problem is because the compiler is doing blind memberwise copy.Again, it is copying the last name in person.Two It is copying the first name we have in person one in person two And it is copying what we havein the age member variable in person two And we have the same memory addresses here.So we need to fix this.But before I show you how to fix this, we should also show you how to see these things in the debugger.So, for example, letâ€™s set up a breakpoint on line 14 here and we can use a debugger to see thesethings instead of printing them out using the print function here so we can run our debugger.Weâ€™re going to build our program.The build is good.Weâ€™re going to give control to the debugger.Weâ€™re going to hit this breakpoint here.And now we have our two person objects as locals in the main function here.So we can, for example, see the last name.Letâ€™s expand that a plus here and letâ€™s expand this a little bit.And youâ€™re going to see that the data in here is John.For the last name.We can see the first name.Weâ€™re going to see that if we expand data.Plus here, weâ€™re going to see that the last name is snow.We can go down and look at the age.You see that it is a pointer.Okay.So letâ€™s go down to P two.Weâ€™re going to see that we have the same information in last name and first name.But look at the age pointer here.It contains the same address both for person one and person two.If you want to see the data inside, you can dereference the pointer and see the data inside.You can see that through the debugger.And this proves that we really are doing a member wise copy and we are just copying the pointer andthis is going to be problematic.If we modify one object, the changes are going to be seen in the other object.What we really need to do is to set up a new memory location in person two and use that to contain ourdata that we pass from person one.So weâ€™re going to be able to do that if we set up our own copy constructor.So letâ€™s head over in the person class and set up a copy constructor.One attempt one might want to do to set up a copy constructor is to do something like this.They might come and say Person, letâ€™s say copy constructor.They might say person and then pass another person by value, letâ€™s say person.If I can type that and weâ€™re going to call this source P for source person and you see that we havea squiggly line, but letâ€™s go on and really finish this up.And then what you might do is go in your implementation file because thatâ€™s where we have the implementationsfor our person class.You might say person and say person, we can pass what we had in the header file.And then what you might do is initialize your member variables from what you have from the source personhere.So weâ€™re going to put in a body and then weâ€™re going to put our initializer list on the next line.I think thatâ€™s going to be better.So weâ€™re going to say M last name is it called M Last name.Letâ€™s see and see.It is called Last Name, so letâ€™s use that here.I donâ€™t want to go back and change that.Weâ€™re going to say last name.Itâ€™s going to be initialized with what is coming from the source person.So weâ€™re going to say source P and get last name.We have a function to give that and then weâ€™re going to initialize the first name.Itâ€™s going to be using whatever comes from source.P So weâ€™re going to get last name.Weâ€™re going to do that and then weâ€™re going to put a comma and initialize the member variable, andweâ€™re going to use whatever comes from source person and weâ€™re going to get age and use that to initializeour member variable.You see that this is really not working.And the reason is what we talked about in the slides.If you try to set up a copy constructor that passes parameter by value, this is going to cause a chainof endless copy constructor calls because the copy constructor is going to want to call a copy constructorto set up a copy and this is going to be bad.C plus plus designer saw that and they disallowed this kind of syntax here.So this syntax is not going to work.So letâ€™s comment this out because some people are going to try and set up something like this.And letâ€™s say that this is bad and say potential for endless copy constructor calls.Okay, So we said that here.Letâ€™s close this a little bit because we need some more breathing space so we can bring this back.Okay.Now that we know that the syntax here is not going to work, weâ€™re going to set up another one, whichis going to do member wise copy and weâ€™re going to set it up like this.Weâ€™re going to pass by reference, so weâ€™re going to say person and weâ€™re going to pass our parameterby const reference.So weâ€™re going to say const person reference and say source P here.This is going to be our source person.Weâ€™re going to head over in the CPP file and reuse what we had done before.We can copy this and weâ€™re going to put in our copy constructor, which is going to pass by referenceand do member wise copy.So letâ€™s say that here weâ€™re going to do member wise copy and we need to call these guys as functionshere.This is what the squiggly lines here are about.I think this is the same problem we had with our bad constructor here.So letâ€™s go back and comment this out because I want you to see the problem the compiler is going toshow you and we are going to uncomment this.Sorry for this and we are going to comment out the member wise copy constructor here and weâ€™re goingto uncomment this, but weâ€™re going to see that we get a squiggly line because this is not allowed syntaxin C plus plus.So letâ€™s change this to do a call to the getter function.Okay, so our getters are called properly, but this is still not allowed.If we try to build our program, weâ€™re going to get a compiler error that is going to say that thisis a syntax that is not allowed.The compiler error is not going to be really understandable.Itâ€™s going to say invalid constructor.You probably meant const person by reference.You see the error here.This is a syntax that is not allowed and if youâ€™re trying to use it, youâ€™re going to get a compilererror because it could lead to an endless chain of copy constructor calls.So weâ€™re going to comment this out again because we have seen the compiler error.Letâ€™s do that.Letâ€™s head over in the header file and comment this out again and we are going to go down and uncommentour member wise copy constructor.Weâ€™re going to do this here and now we have a constructor that seems to work.If we try to build with this constructor in place, letâ€™s see what we get.Weâ€™re going to build with GCC first.You see that we have errors and what do we mean by this compiler error?Okay, so what do we have here?Letâ€™s go back and this is not really commented out.Letâ€™s comment this out and weâ€™re going to build again.Now you see that the build is good and we have a constructor that is going to simulate the behaviorwe had with the constructor that was generated for us by the compiler.Because remember, before we set up our own constructors, the compiler was generating a copy constructorfor us.And what the compiler generated was doing exactly what we see here.Member Wise copy.It was taking the last name from the source object and pasting that into our member variable for thelast name.It was taking the first name from our source object and pasting that into our first name and it wastaking the age and pasting that into our age member variable.And remember the age is a pointer and that was the source of our problems because we had two objectsfor the person class that were pointing to the same age memory location and this is really bad.And now that I look at this, I notice that we didnâ€™t use the first name here.We used the last name, We can fix this.Weâ€™re going to say get first name.This is going to do what we want.But still weâ€™re going to see the same problems we saw when we use the constructor that was generatedby the compiler.But we can prove that our constructor here is being called by the compiler.Letâ€™s do that.Weâ€™re going to say Stdcout.I think we can say that and weâ€™re going to say copy constructor called.Weâ€™re going to see that our copy constructor is being used by the compiler.If I can type endl here.So this is good.Letâ€™s try and build and see what we get in our output.The world is going to be good.We can clear and run Rooster and we are going to see that our copy constructor is called and the personobject, which we created as P2 here, is going to have the same information we have in the first personobject.The last name is going to be John.The first name is going to be Snow.The age is going to be 25, but we blindly copied the memory address and the age pointer and pastedthat in our person object, which is P2 here.And this is going to lead to the problem we see here.If we change the age from person one, the change is even going to be seen in person.Two And this is not what we want.So we need to fix this problem.And to fix this we need to avoid blindly copying the pointer for the member variable for age.Here, we need to set up a new memory location and use that to store the information in our copy object.So weâ€™re going to change the copy constructor we have here.Weâ€™re going to comment it out and do things right.So what weâ€™re going to do is comment this out and weâ€™re going to set up another one which is going tocopy properly.Weâ€™re going to say donâ€™t blindly copy the pointer and weâ€™re going to set up a copy constructor, whichis going to do that.Weâ€™re going to say person and weâ€™re going to take a person object by const reference because this isthe syntax that C plus plus expects.What did we do?Const person by reference and weâ€™re going to say Source P, This is going to be our person and weâ€™regoing to go in the CPP file and comment out what we had here because we donâ€™t want this, but I wantyou to keep this as a reference and you need to know that this is really bad.Itâ€™s not going to do what you want.And this is also bad because this is not supported.Letâ€™s say that this is really bad.Okay?I think this is expressing the level to which this is really bad.So letâ€™s go down and set up a constructor that is going to work, a copy constructor, I mean, andweâ€™re going to say donâ€™t blindly copy pointers.So weâ€™re going to grab the constructor we had, which had a problem and weâ€™re going to modify it a littlebit and not blindly copy the pointer.So for the age remember variable, we donâ€™t want to directly copy the pointer here.What we want to do is allocate new memory and we can do that in our initializer list here so we cansay new and, and this is going to dynamically allocate space on the heap.And what we store in here is what we get if we dereference the pointer we get from the source objectand we can use this syntax here to do that.So if we do this, we want to be blindly copying the pointer.We will be setting up a completely new memory location to store the data in our copy object.So now that we have this and weâ€™re going to try and build and really show you this, weâ€™re going tobuild with GCC first, we need to prove that this is going to work.So you see, the syntax is really working.The build is good.We can clear now and run Rooster Now weâ€™re going to see that P one is going to live at this addressthat ends in D30P2 is going to live at this address that ends in C zero and the age member variablefor p one is going to live at an address that ends in 2D0 and the age for the second person object isgoing to live at a different address that ends in 320.So we are doing things right here.We are using a completely new memory location to store the age for a person two And this is what wewant.If we look at the output after we modify person one and change the age to 30, person one is going tohave the age of 30 and the person two is going to have the age of 25.And this is really what we want.We have a copy constructor which is doing what we want.It is not doing blind copies of member variables and this is what we want.This is how you can set up a copy constructor so you now know how to set up a copy constructor.But I want you to know that we can reuse the constructor we have on top here.If you look, this constructor already knows how to allocate new memory for the parameter that you giveit.So for the strings itâ€™s going to do a copy.Last name is going to be the last name that we pass in the parameter here.But for the age, it is going to make a new memory location and it is going to store age parameter nso we can really reuse it and avoid setting up a copy constructor that is doing all the heavy job hereso we can comment it out and use delegated constructors.We can do that.So weâ€™re going to say that here delegate from the copy constructor.And the way to do that weâ€™re going to have the same syntax we had, but weâ€™re not going to initializethe variables ourselves.So letâ€™s copy this and.Adapt this because I donâ€™t want to retype all this.So what weâ€™re going to do is take out all the initialization weâ€™re doing here and weâ€™re going to delegatethe construction from the copy construction to the construction we have on top here.So weâ€™re going to call that what weâ€™re going to do is say person and weâ€™re going to give it the parametersor the arguments we should say.So weâ€™re going to give it the last name, weâ€™re going to say source person, get last name.We can do that.And it is a function we should call it.Weâ€™re going to give it the first name, weâ€™re going to say source person and weâ€™re going to get thefirst name.Letâ€™s do that.And it is a function we should call it.Then weâ€™re going to give it the age.How do we get the age?Weâ€™re going to dereference the pointer that comes from get age and weâ€™re going to say source person,get age now, not first name, itâ€™s get age.Weâ€™re going to get the pointer and then weâ€™re going to dereference that and pass the data to the otherconstructor that we have on top.So we still have a squiggly line here.I donâ€™t know why.Maybe Cplusplus is confused.So what do we have here?Letâ€™s check this a little bit.We need to see.We have source beget last name source beget first name and we are dereferencing the pointer here andpassing the data.And I think we need another set of parentheses.Letâ€™s see if thatâ€™s what we need.Yes, we need another parentheses in here.And then the Visual Studio code is going to accept this.So try to take a moment and really understand what we are doing here.The copy constructor is set up using the syntax that Cplusplus accepts, but weâ€™re not going to initializeour member variables ourselves like we did in the last copy constructor that we did.Weâ€™re not going to do any memory allocation ourselves.Weâ€™re going to delegate all that heavy work to the constructor that we already have, which is constructingour objects here.And this is going to work.It is going to do what we want.Letâ€™s go back to the main function and build our program.Weâ€™re going to see that the world is good.We can clear and run Rooster.Weâ€™re going to see that we have the exact same output.We have the data copied from person one.We have the last name.We have the first name, we have the age.And if we change person one, as we do here in person one, weâ€™re going to have the age to be 30.But person two is not going to be affected.And this is really good.This is what you should do, this is how you should set up your copy constructors.Okay, so this is really how you can set up your copy constructors in C plus plus.And I donâ€™t think I really told you if you set up your own copy constructor C plus plus is no longergoing to set up a copy constructor for you.It is going to call your copy constructor and the copy constructors are another set of functions thatthe C plus plus compiler can generate for you if you donâ€™t have them in and they are needed.We have seen that the C plus plus compiler can also generate constructors for you.It can also generate destructors if you donâ€™t have any destructors and but it can also generate a copyconstructor as we have seen in this lecture.So you should really know that and we should make sure that in our destructor we are releasing the memorythat we allocated in our constructor.So letâ€™s really check that out.Weâ€™re going to go in person.CP And look, we donâ€™t have a destructor in place here.We have a destructor which is going to release the memory and this is really good.We have to make sure that we are not leaking any memory here.So this is really all we set out to do in this lecture.I hope you found it interesting.Again, remember the syntax to set up a copy constructor and remember to not do blind copies, especiallyif you have member variables that are pointers like our age.Here.We are going to stop here in this lecture and the next one weâ€™re going to see that if you store elementsin an array, the compiler is actually going to make copies.And thatâ€™s really interesting and weâ€™re going to see that in the next lecture.Go ahead and finish up here and meet me there.</p>
<hr>
<h2 id="ğŸ¤–-Assistant"><a href="#ğŸ¤–-Assistant" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>å¥½çš„ï¼Œæ²¡é—®é¢˜ï¼æˆ‘ä»¬ç°åœ¨å¼€å§‹å­¦ä¹  C++ ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼šæ‹·è´æ„é€ å‡½æ•°ã€‚</p>
<h1 id="C-æ‹·è´æ„é€ å‡½æ•°-Copy-Constructor-æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´"><a href="#C-æ‹·è´æ„é€ å‡½æ•°-Copy-Constructor-æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´" class="headerlink" title="C++ æ‹·è´æ„é€ å‡½æ•° (Copy Constructor) æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´"></a>C++ æ‹·è´æ„é€ å‡½æ•° (Copy Constructor) æ·±å…¥è§£æï¼šä»æµ…æ‹·è´åˆ°æ·±æ‹·è´</h1><p><strong>æ‘˜è¦ï¼š</strong> æœ¬æ•™ç¨‹å°†å¸¦ä½ æ·±å…¥ç†è§£ C++ ä¸­çš„æ‹·è´æ„é€ å‡½æ•° (Copy Constructor)ï¼Œè§£é‡Šå…¶å·¥ä½œåŸç†ã€ä½•æ—¶è¢«è°ƒç”¨ï¼Œä»¥åŠå¦‚ä½•æ­£ç¡®å®ç°å®ƒä»¥é¿å…å¸¸è§çš„æµ…æ‹·è´é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¤„ç†æŒ‡é’ˆæˆå‘˜æ—¶ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ª <code>Person</code> ç±»çš„ä¾‹å­ï¼Œä¸€æ­¥æ­¥å±•ç¤ºä»é»˜è®¤æ‹·è´æ„é€ å‡½æ•°çš„é—®é¢˜åˆ°è‡ªå®šä¹‰æ·±æ‹·è´æ„é€ å‡½æ•°çš„å®ç°æ–¹æ³•ã€‚</p>
<hr>
<h2 id="1-è¯¦ç»†è§£é‡Š"><a href="#1-è¯¦ç»†è§£é‡Š" class="headerlink" title="1. è¯¦ç»†è§£é‡Š"></a>1. è¯¦ç»†è§£é‡Š</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</h3><p>æ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„<strong>æ„é€ å‡½æ•° (constructor)</strong>ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨ä½¿ç”¨ä¸€ä¸ª<strong>å·²å­˜åœ¨çš„ã€åŒç±»å‹çš„å¯¹è±¡ (object)</strong> æ¥<strong>åˆå§‹åŒ– (initialize)</strong> ä¸€ä¸ªæ–°çš„å¯¹è±¡æ—¶è¢«è°ƒç”¨ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“ä½ æƒ³è¦â€œå¤åˆ¶â€ä¸€ä¸ªå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡å‰¯æœ¬æ—¶ï¼Œæ‹·è´æ„é€ å‡½æ•°å°±ä¼šç™»åœºã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª <code>Person</code> ç±»çš„å¯¹è±¡ <code>p1</code>ï¼Œç„¶åä½ è¿™æ ·å†™ï¼š<br><code>Person p2 = p1;</code><br>æˆ–è€…<br><code>Person p2(p1);</code><br>ç¼–è¯‘å™¨ (compiler) å°±ä¼šå°è¯•è°ƒç”¨ <code>Person</code> ç±»çš„æ‹·è´æ„é€ å‡½æ•°æ¥åˆ›å»º <code>p2</code>ã€‚</p>
<h3 id="1-2-æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson-ç±»"><a href="#1-2-æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson-ç±»" class="headerlink" title="1.2 æˆ‘ä»¬çš„ç¤ºä¾‹ï¼šPerson ç±»"></a>1.2 æˆ‘ä»¬çš„ç¤ºä¾‹ï¼š<code>Person</code> ç±»</h3><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£æ‹·è´æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª <code>Person</code> ç±»ã€‚è¿™ä¸ªç±»åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li><strong>ç§æœ‰æˆå‘˜ (private members):</strong><ul>
<li><code>lastName</code> (å§“): <code>std::string</code> ç±»å‹</li>
<li><code>firstName</code> (å): <code>std::string</code> ç±»å‹</li>
<li><code>age</code> (å¹´é¾„): <code>int*</code> ç±»å‹ (ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„<strong>æŒ‡é’ˆ (pointer)</strong>)ã€‚è¿™é‡Œç‰¹æ„ä½¿ç”¨æŒ‡é’ˆæ˜¯ä¸ºäº†æ¼”ç¤ºæ‹·è´æ„é€ å‡½æ•°ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚</li>
</ul>
</li>
<li><strong>å…¬æœ‰æˆå‘˜ (public members):</strong><ul>
<li>å¤šä¸ªæ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•° (default constructor) å’Œå¸¦å‚æ•°çš„æ„é€ å‡½æ•°ã€‚</li>
<li>ä¸€ä¸ªææ„å‡½æ•° (destructor)ï¼Œç”¨äºé‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</li>
<li>ä¸€ä¸ªå·¥å…·å‡½æ•° <code>print_info()</code>ï¼Œç”¨äºæ‰“å°å¯¹è±¡çš„ä¿¡æ¯ã€‚</li>
<li>ä¸€äº› <code>setter</code> å’Œ <code>getter</code> æ–¹æ³•ï¼ˆç”¨äºè®¾ç½®å’Œè·å–æˆå‘˜å˜é‡çš„å€¼ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å…³é”®ç‚¹ï¼š</strong> <code>age</code> æˆå‘˜æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä¼šä¸ºå®ƒåŠ¨æ€åˆ†é…å†…å­˜æ¥å­˜å‚¨å®é™…çš„å¹´é¾„å€¼ã€‚ä¾‹å¦‚ï¼š<br><code>age = new int(actual_age_value);</code></p>
<h3 id="1-3-é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´-Shallow-Copy-é—®é¢˜"><a href="#1-3-é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´-Shallow-Copy-é—®é¢˜" class="headerlink" title="1.3 é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´ (Shallow Copy) é—®é¢˜"></a>1.3 é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å’Œæµ…æ‹·è´ (Shallow Copy) é—®é¢˜</h3><p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸º <code>Person</code> ç±»æ˜¾å¼å®šä¹‰ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼ŒC++ ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªã€‚è¿™ä¸ªé»˜è®¤çš„æ‹·è´æ„é€ å‡½æ•°æ‰§è¡Œçš„æ˜¯<strong>æˆå‘˜é€ä¸€æ‹·è´ (member-wise copy)</strong>ã€‚</p>
<ul>
<li>å¯¹äº <code>std::string</code> ç±»å‹çš„ <code>lastName</code> å’Œ <code>firstName</code>ï¼Œæˆå‘˜é€ä¸€æ‹·è´ä¼šåˆ›å»ºå­—ç¬¦ä¸²å†…å®¹çš„å‰¯æœ¬ï¼Œè¿™é€šå¸¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</li>
<li><strong>ä½†æ˜¯ï¼Œå¯¹äºæŒ‡é’ˆæˆå‘˜ <code>age</code></strong>ï¼Œæˆå‘˜é€ä¸€æ‹·è´ä»…ä»…å¤åˆ¶æŒ‡é’ˆçš„åœ°å€å€¼ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ä¸­çš„æ•°æ®ã€‚è¿™å°±å¯¼è‡´äº†æ‰€è°“çš„<strong>æµ…æ‹·è´ (shallow copy)</strong>ã€‚</li>
</ul>
<p><strong>å›¾è§£æµ…æ‹·è´ï¼š</strong><br>å‡è®¾æˆ‘ä»¬æœ‰ <code>Person p1;</code>ï¼Œå®ƒçš„ <code>age</code> æŒ‡é’ˆæŒ‡å‘å†…å­˜åœ°å€ <code>0x1000</code>ï¼Œè¯¥åœ°å€å­˜ç€å¹´é¾„å€¼ <code>25</code>ã€‚<br>å½“æˆ‘ä»¬æ‰§è¡Œ <code>Person p2 = p1;</code> æ—¶ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ï¼ˆæˆ–é”™è¯¯çš„è‡ªå®šä¹‰ï¼‰æ‹·è´æ„é€ å‡½æ•°ï¼š</p>
<ul>
<li><code>p2.lastName</code> ä¼šå¾—åˆ° <code>p1.lastName</code> çš„å‰¯æœ¬ã€‚</li>
<li><code>p2.firstName</code> ä¼šå¾—åˆ° <code>p1.firstName</code> çš„å‰¯æœ¬ã€‚</li>
<li><code>p2.age</code> ä¼šå¾—åˆ° <code>p1.age</code> çš„å‰¯æœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>p2.age</code> ä¹Ÿå°†æŒ‡å‘å†…å­˜åœ°å€ <code>0x1000</code>ã€‚</li>
</ul>
<p><strong>æµ…æ‹·è´å¸¦æ¥çš„é—®é¢˜ï¼š</strong></p>
<ol>
<li><strong>æ•°æ®ä¿®æ”¹è”åŠ¨ï¼š</strong> ç”±äº <code>p1.age</code> å’Œ <code>p2.age</code> æŒ‡å‘åŒä¸€å—å†…å­˜ï¼Œå¦‚æœé€šè¿‡ <code>p1</code> ä¿®æ”¹äº†å¹´é¾„ï¼ˆä¾‹å¦‚ï¼Œ<code>p1.set_age(30)</code>ï¼Œè¿™ä¼šè§£å¼•ç”¨ <code>p1.age</code> æŒ‡é’ˆå¹¶ä¿®æ”¹ <code>0x1000</code> å¤„çš„å€¼ï¼‰ï¼Œé‚£ä¹ˆ <code>p2</code> çš„å¹´é¾„ä¹Ÿä¼šâ€œè«åå…¶å¦™â€åœ°å˜æˆ <code>30</code>ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¸Œæœ›å‰¯æœ¬æ˜¯ç‹¬ç«‹çš„ã€‚</li>
<li><strong>æ‚¬æŒ‚æŒ‡é’ˆå’Œé‡å¤é‡Šæ”¾ (Dangling Pointer and Double Free):</strong> å½“ <code>p1</code> å’Œ <code>p2</code> çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œå®ƒä»¬çš„ææ„å‡½æ•°éƒ½ä¼šå°è¯• <code>delete age;</code>ã€‚ç¬¬ä¸€æ¬¡ <code>delete</code> ä¼šé‡Šæ”¾ <code>0x1000</code> å¤„çš„å†…å­˜ã€‚å½“ç¬¬äºŒä¸ªå¯¹è±¡çš„ææ„å‡½æ•°å†æ¬¡å°è¯• <code>delete</code> åŒä¸€ä¸ªå·²ç»è¢«é‡Šæ”¾çš„åœ°å€æ—¶ï¼Œä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼ˆé‡å¤é‡Šæ”¾ï¼‰ã€‚å³ä½¿ä¸å´©æºƒï¼Œå…¶ä¸­ä¸€ä¸ªå¯¹è±¡é”€æ¯åï¼Œå¦ä¸€ä¸ªå¯¹è±¡çš„ <code>age</code> æŒ‡é’ˆå°±æˆäº†æ‚¬æŒ‚æŒ‡é’ˆï¼ŒæŒ‡å‘äº†æ— æ•ˆå†…å­˜ã€‚</li>
</ol>
<h3 id="1-4-è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°"><a href="#1-4-è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°" class="headerlink" title="1.4 è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°"></a>1.4 è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°</h3><p>ä¸ºäº†è§£å†³æµ…æ‹·è´çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œå¹¶ä¸ºæŒ‡é’ˆæˆå‘˜å®ç°<strong>æ·±æ‹·è´ (deep copy)</strong>ã€‚æ·±æ‹·è´æ„å‘³ç€ä¸ºæ–°å¯¹è±¡çš„æŒ‡é’ˆæˆå‘˜åˆ†é…ä¸€å—æ–°çš„å†…å­˜ï¼Œå¹¶å°†åŸå¯¹è±¡æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ•°æ®å¤åˆ¶åˆ°è¿™å—æ–°å†…å­˜ä¸­ã€‚</p>
<p>æ‹·è´æ„é€ å‡½æ•°çš„å…¸å‹å£°æ˜æ ¼å¼å¦‚ä¸‹ï¼š<br><code>ClassName(const ClassName&amp; other_object);</code></p>
<ul>
<li><code>ClassName</code> æ˜¯ä½ çš„ç±»åã€‚</li>
<li>å‚æ•°æ˜¯ <code>const ClassName&amp; other_object</code>ï¼š<ul>
<li><code>const</code>: è¡¨ç¤ºæˆ‘ä»¬ä¸ä¼šåœ¨æ‹·è´æ„é€ å‡½æ•°ä¸­ä¿®æ”¹æºå¯¹è±¡ <code>other_object</code>ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚</li>
<li><code>&amp;</code>: è¡¨ç¤ºé€šè¿‡<strong>å¼•ç”¨ (reference)</strong> ä¼ é€’ã€‚è¿™éå¸¸é‡è¦ï¼</li>
</ul>
</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆå¿…é¡»é€šè¿‡å¼•ç”¨ä¼ é€’ï¼Ÿ</strong><br>å¦‚æœæˆ‘ä»¬å°è¯•è¿™æ ·å®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼š<code>Person(Person other_person);</code> (æŒ‰å€¼ä¼ é€’)<br>å½“è°ƒç”¨è¿™ä¸ªæ‹·è´æ„é€ å‡½æ•°æ—¶ï¼Œä¸ºäº†å°†å®å‚ä¼ é€’ç»™å½¢å‚ <code>other_person</code>ï¼Œéœ€è¦å…ˆå¤åˆ¶ä¸€ä»½å®å‚ã€‚ä½†å¦‚ä½•å¤åˆ¶å‘¢ï¼Ÿåˆéœ€è¦è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼è¿™å°±å½¢æˆäº†ä¸€ä¸ªæ— é™é€’å½’çš„è°ƒç”¨é“¾ï¼Œæœ€ç»ˆå¯¼è‡´æ ˆæº¢å‡ºã€‚å› æ­¤ï¼ŒC++ ç¼–è¯‘å™¨ç¦æ­¢æ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°æŒ‰å€¼ä¼ é€’ï¼Œå®ƒå¿…é¡»æ˜¯å¼•ç”¨ã€‚</p>
<h3 id="1-5-å®ç°æ·±æ‹·è´çš„æ­¥éª¤"><a href="#1-5-å®ç°æ·±æ‹·è´çš„æ­¥éª¤" class="headerlink" title="1.5 å®ç°æ·±æ‹·è´çš„æ­¥éª¤"></a>1.5 å®ç°æ·±æ‹·è´çš„æ­¥éª¤</h3><p>åœ¨æˆ‘ä»¬çš„ <code>Person</code> ç±»çš„æ‹·è´æ„é€ å‡½æ•°ä¸­ï¼š</p>
<ol>
<li>å¯¹äºéæŒ‡é’ˆæˆå‘˜ (<code>lastName</code>, <code>firstName</code>)ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ï¼š<br><code>lastName = other_person.lastName;</code><br><code>firstName = other_person.firstName;</code></li>
<li>å¯¹äºæŒ‡é’ˆæˆå‘˜ <code>age</code>ï¼Œéœ€è¦æ‰§è¡Œæ·±æ‹·è´ï¼š<ul>
<li>é¦–å…ˆï¼Œä¸ºæ–°å¯¹è±¡çš„ <code>age</code> æŒ‡é’ˆåˆ†é…æ–°çš„å†…å­˜ï¼š<code>age = new int;</code></li>
<li>ç„¶åï¼Œå°†æºå¯¹è±¡ <code>other_person.age</code> æ‰€æŒ‡å‘çš„<em>å€¼</em>å¤åˆ¶åˆ°è¿™å—æ–°å†…å­˜ä¸­ï¼š<code>*age = *(other_person.age);</code></li>
<li><strong>æ³¨æ„ï¼š</strong> åœ¨è§£å¼•ç”¨ <code>other_person.age</code> ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥å®ƒæ˜¯å¦ä¸º <code>nullptr</code>ï¼Œä»¥é¿å…è§£å¼•ç”¨ç©ºæŒ‡é’ˆã€‚åœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å®ƒæ€»æ˜¯åœ¨ä¸»æ„é€ å‡½æ•°ä¸­è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚</li>
</ul>
</li>
</ol>
<p>æ›´ç®€æ´çš„å†™æ³•ï¼ˆé€šå¸¸åœ¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­å®Œæˆï¼‰ï¼š<br><code>age = new int(*(other_person.m_age));</code> // å‡è®¾æºå¯¹è±¡çš„ageæŒ‡é’ˆåä¸ºm_age</p>
<h3 id="1-6-æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜-Constructor-Delegation"><a href="#1-6-æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜-Constructor-Delegation" class="headerlink" title="1.6 æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜ (Constructor Delegation)"></a>1.6 æ‹·è´æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°å§”æ‰˜ (Constructor Delegation)</h3><p>å¦‚æœä½ çš„ç±»ä¸­å·²ç»æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ¥æ”¶æ‰€æœ‰æˆå‘˜å€¼çš„æ„é€ å‡½æ•°ï¼‰æ­£ç¡®åœ°å¤„ç†äº†æ‰€æœ‰æˆå‘˜çš„åˆå§‹åŒ–ï¼ˆåŒ…æ‹¬ä¸ºæŒ‡é’ˆæˆå‘˜åˆ†é…æ–°å†…å­˜ï¼‰ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨æ‹·è´æ„é€ å‡½æ•°ä¸­ä½¿ç”¨<strong>æ„é€ å‡½æ•°å§”æ‰˜ (constructor delegation)</strong> æ¥é¿å…é‡å¤ä»£ç ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ <code>Person</code> æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š<br><code>Person(const std::string&amp; ln, const std::string&amp; fn, int val_age)</code><br>å®ƒå†…éƒ¨ä¼šåš <code>this-&gt;age = new int(val_age);</code></p>
<p>é‚£ä¹ˆæ‹·è´æ„é€ å‡½æ•°å¯ä»¥è¿™æ ·å†™ï¼š<br><code>Person(const Person&amp; other) : Person(other.lastName, other.firstName, *(other.age)) {</code><br><code>// å§”æ‰˜ç»™ä¸Šé¢çš„æ„é€ å‡½æ•°ï¼Œå®ƒä¼šè´Ÿè´£ new int(*(other.age))</code><br><code>std::cout &lt;&lt; &quot;æ‹·è´æ„é€ å‡½æ•° (å§”æ‰˜ç‰ˆæœ¬) è¢«è°ƒç”¨!&quot; &lt;&lt; std::endl;</code><br><code>}</code><br>è¿™é‡Œï¼Œ<code>*(other.age)</code> è§£å¼•ç”¨æºå¯¹è±¡çš„ <code>age</code> æŒ‡é’ˆï¼Œè·å–å…¶æŒ‡å‘çš„æ•´æ•°å€¼ï¼Œç„¶åå°†è¿™ä¸ªå€¼ä¼ é€’ç»™ç›®æ ‡æ„é€ å‡½æ•°ï¼Œç›®æ ‡æ„é€ å‡½æ•°ä¼šä¸ºæ–°å¯¹è±¡çš„ <code>age</code> æŒ‡é’ˆ <code>new</code> ä¸€å—æ–°å†…å­˜å¹¶å­˜å…¥è¿™ä¸ªå€¼ã€‚</p>
<h3 id="1-7-ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"><a href="#1-7-ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ" class="headerlink" title="1.7 ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ"></a>1.7 ä½•æ—¶è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Ÿ</h3><p>æ‹·è´æ„é€ å‡½æ•°ä¸»è¦åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹è¢«è°ƒç”¨ï¼š</p>
<ol>
<li><strong>æ˜¾å¼æˆ–éšå¼åˆå§‹åŒ–ï¼š</strong><br><code>Person p2 = p1;</code> // éšå¼è°ƒç”¨ (ç­‰å·åœ¨è¿™é‡Œæ˜¯åˆå§‹åŒ–ï¼Œä¸æ˜¯èµ‹å€¼)<br><code>Person p2(p1);</code> // æ˜¾å¼è°ƒç”¨</li>
<li><strong>å‡½æ•°æŒ‰å€¼ä¼ å‚ï¼š</strong> å½“ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°æŒ‰å€¼ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºè¯¥å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚<br><code>void some_function(Person p);</code><br><code>Person my_person;</code><br><code>some_function(my_person); // Personçš„æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨ä»¥åˆ›å»ºp</code></li>
<li><strong>å‡½æ•°æŒ‰å€¼è¿”å›ï¼š</strong> å½“ä¸€ä¸ªå‡½æ•°æŒ‰å€¼è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šï¼ˆå–å†³äºç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå¦‚RVO/NRVOï¼‰è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚<br><code>Person create_person() {</code><br><code>Person temp(&quot;Doe&quot;, &quot;John&quot;, 30);</code><br><code>return temp; // å¯èƒ½è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</code><br><code>}</code><br><code>Person new_p = create_person();</code></li>
</ol>
<h3 id="1-8-æ‹·è´æ„é€ å‡½æ•°-Vs-èµ‹å€¼è¿ç®—ç¬¦-Assignment-Operator"><a href="#1-8-æ‹·è´æ„é€ å‡½æ•°-Vs-èµ‹å€¼è¿ç®—ç¬¦-Assignment-Operator" class="headerlink" title="1.8 æ‹·è´æ„é€ å‡½æ•° Vs èµ‹å€¼è¿ç®—ç¬¦ (Assignment Operator)"></a>1.8 æ‹·è´æ„é€ å‡½æ•° Vs èµ‹å€¼è¿ç®—ç¬¦ (Assignment Operator)</h3><p>éœ€è¦åŒºåˆ†æ‹·è´æ„é€ å‡½æ•°å’Œ<strong>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (copy assignment operator)</strong>ã€‚</p>
<ul>
<li><p><strong>æ‹·è´æ„é€ å‡½æ•°ï¼š</strong> ç”¨äºä»ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡ <em>åˆ›å»ºå¹¶åˆå§‹åŒ–</em> ä¸€ä¸ª <em>æ–°</em> å¯¹è±¡ã€‚<br><code>Person p1(&quot;Snow&quot;, &quot;John&quot;, 25);</code><br><code>Person p2 = p1;  // è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</code><br><code>Person p3(p1);   // è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</code></p>
</li>
<li><p><strong>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼š</strong> ç”¨äºå°†ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡çš„å€¼èµ‹ç»™ <em>å¦ä¸€ä¸ªå·²å­˜åœ¨çš„</em> å¯¹è±¡ã€‚<br><code>Person p1(&quot;Snow&quot;, &quot;John&quot;, 25);</code><br><code>Person p2; // è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•° (æˆ–è€…å…¶ä»–æ„é€ å‡½æ•°)</code><br><code>p2 = p1;  // è°ƒç”¨æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (operator=)</code></p>
</li>
</ul>
<p>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ä¹Ÿéœ€è¦å¤„ç†æ·±æ‹·è´é—®é¢˜ï¼Œå¹¶ä¸”é€šå¸¸ä¼šæ›´å¤æ‚ä¸€äº›ï¼ˆæ¯”å¦‚éœ€è¦æ£€æŸ¥è‡ªèµ‹å€¼ï¼Œå…ˆé‡Šæ”¾æ—§èµ„æºå†åˆ†é…æ–°èµ„æºï¼‰ã€‚è¿™æ˜¯å¦ä¸€ä¸ªè¯é¢˜ï¼Œä½†ä¸æ‹·è´æ„é€ å‡½æ•°å¯†åˆ‡ç›¸å…³ã€‚</p>
<h3 id="1-9-ææ„å‡½æ•°çš„é‡è¦æ€§"><a href="#1-9-ææ„å‡½æ•°çš„é‡è¦æ€§" class="headerlink" title="1.9 ææ„å‡½æ•°çš„é‡è¦æ€§"></a>1.9 ææ„å‡½æ•°çš„é‡è¦æ€§</h3><p>å½“ç±»ä¸­åŠ¨æ€åˆ†é…äº†èµ„æºï¼ˆå¦‚ <code>new int</code> ä¸º <code>age</code>ï¼‰ï¼Œå¿…é¡»æä¾›ä¸€ä¸ª<strong>ææ„å‡½æ•° (destructor)</strong> æ¥é‡Šæ”¾åœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶åˆ†é…çš„å†…å­˜ï¼Œä»¥é¿å…<strong>å†…å­˜æ³„æ¼ (memory leak)</strong>ã€‚<br>å¯¹äº <code>Person</code> ç±»ï¼Œææ„å‡½æ•°åº”è¯¥åƒè¿™æ ·ï¼š<br><code>~Person() {</code><br><code>delete age; // é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</code><br><code>age = nullptr; // å¥½ä¹ æƒ¯ï¼šå°†æŒ‡é’ˆè®¾ä¸ºnullptrï¼Œé˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ</code><br><code>std::cout &lt;&lt; &quot;ææ„å‡½æ•°ä¸º &quot; &lt;&lt; lastName &lt;&lt; &quot; è°ƒç”¨&quot; &lt;&lt; std::endl;</code><br><code>}</code></p>
<p>å¦‚æœä½ æä¾›äº†è‡ªå®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ï¼ˆå°¤å…¶æ˜¯æ¶‰åŠåˆ°åŠ¨æ€å†…å­˜ç®¡ç†æ—¶ï¼‰ï¼Œå‡ ä¹æ€»æ˜¯æ„å‘³ç€ä½ ä¹Ÿéœ€è¦æä¾›è‡ªå®šä¹‰çš„ææ„å‡½æ•°å’Œè‡ªå®šä¹‰çš„æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€‚è¿™é€šå¸¸è¢«ç§°ä¸º <strong>â€œRule of Threeâ€ (ä¸‰æ³•åˆ™)</strong> (åœ¨C++11åŠä»¥åï¼Œç”±äºç§»åŠ¨è¯­ä¹‰çš„å¼•å…¥ï¼Œæ‰©å±•ä¸º â€œRule of Fiveâ€ æˆ– â€œRule of Zeroâ€)ã€‚</p>
<hr>
<h2 id="2-ä»£ç ç¤ºä¾‹"><a href="#2-ä»£ç ç¤ºä¾‹" class="headerlink" title="2. ä»£ç ç¤ºä¾‹"></a>2. ä»£ç ç¤ºä¾‹</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ <code>Person</code> ç±»ç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ­£ç¡®çš„æ‹·è´æ„é€ å‡½æ•°ï¼ˆä½¿ç”¨å§”æ‰˜ï¼‰å’Œææ„å‡½æ•°ã€‚</p>
<p><strong><code>person.h</code> (å¤´æ–‡ä»¶)</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> PERSON_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PERSON_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> lastName;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> firstName;</span><br><span class="line">    <span class="keyword">int</span>* age; <span class="comment">// æŒ‡é’ˆæˆå‘˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å¸¦æ‰€æœ‰å‚æ•°çš„æ„é€ å‡½æ•° (ä¸»è¦æ„é€ é€»è¾‘)</span></span><br><span class="line">    Person(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; ln, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; fn, <span class="keyword">int</span> val_age);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤æ„é€ å‡½æ•° (å§”æ‰˜ç»™ä¸»è¦æ„é€ å‡½æ•°)</span></span><br><span class="line">    Person();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹·è´æ„é€ å‡½æ•° (å§”æ‰˜ç»™ä¸»è¦æ„é€ å‡½æ•°ï¼Œå®ç°æ·±æ‹·è´)</span></span><br><span class="line">    Person(<span class="keyword">const</span> Person&amp; other);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~Person();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Setter for age</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_age</span><span class="params">(<span class="keyword">int</span> new_age)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getter for age value</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_age_value</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Utility function to print info</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// PERSON_H</span></span></span><br></pre></td></tr></table></figure></div></p>
<p><strong><code>person.cpp</code> (å®ç°æ–‡ä»¶)</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦æ‰€æœ‰å‚æ•°çš„æ„é€ å‡½æ•° (ä¸»è¦æ„é€ é€»è¾‘)</span></span><br><span class="line">Person::Person(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; ln, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; fn, <span class="keyword">int</span> val_age)</span><br><span class="line">    : lastName(ln), firstName(fn) &#123;</span><br><span class="line">    age = <span class="keyword">new</span> <span class="keyword">int</span>(val_age); <span class="comment">// ä¸º age åˆ†é…æ–°å†…å­˜å¹¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"æ„é€ å‡½æ•° (å¸¦å‚) ä¸º "</span> &lt;&lt; lastName &lt;&lt; <span class="string">" è°ƒç”¨, å¹´é¾„æŒ‡é’ˆ: "</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤æ„é€ å‡½æ•° (å§”æ‰˜ç»™ä¸»è¦æ„é€ å‡½æ•°)</span></span><br><span class="line">Person::Person() : Person(<span class="string">"N/A"</span>, <span class="string">"N/A"</span>, <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"é»˜è®¤æ„é€ å‡½æ•°ä¸º "</span> &lt;&lt; lastName &lt;&lt; <span class="string">" è°ƒç”¨"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•° (å§”æ‰˜ç»™ä¸»è¦æ„é€ å‡½æ•°ï¼Œå®ç°æ·±æ‹·è´)</span></span><br><span class="line">Person::Person(<span class="keyword">const</span> Person&amp; other)</span><br><span class="line">    : Person(other.lastName, other.firstName, *(other.age)) &#123; <span class="comment">// å§”æ‰˜</span></span><br><span class="line">    <span class="comment">// *(other.age) è·å–æºå¯¹è±¡å¹´é¾„å€¼</span></span><br><span class="line">    <span class="comment">// ä¸»è¦æ„é€ å‡½æ•°ä¼šè´Ÿè´£ new int(...)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"æ‹·è´æ„é€ å‡½æ•°ä¸º "</span> &lt;&lt; lastName &lt;&lt; <span class="string">" (ä» "</span> &lt;&lt; other.lastName &lt;&lt; <span class="string">") å¤åˆ¶, æ–°å¹´é¾„æŒ‡é’ˆ: "</span> &lt;&lt; age &lt;&lt; <span class="string">", æºå¹´é¾„æŒ‡é’ˆ: "</span> &lt;&lt; other.age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">Person::~Person() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ææ„å‡½æ•°ä¸º "</span> &lt;&lt; lastName &lt;&lt; <span class="string">" è°ƒç”¨, å‡†å¤‡é‡Šæ”¾å¹´é¾„æŒ‡é’ˆ: "</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span> age;      <span class="comment">// é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">    age = <span class="literal">nullptr</span>;   <span class="comment">// å¥½ä¹ æƒ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Setter for age</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Person::set_age</span><span class="params">(<span class="keyword">int</span> new_age)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (age) &#123;</span><br><span class="line">        *age = new_age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getter for age value</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Person::get_age_value</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (age ? *age : <span class="number">-1</span>); <span class="comment">// å¦‚æœageæœ‰æ•ˆåˆ™è¿”å›å€¼ï¼Œå¦åˆ™è¿”å›-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Utility function to print info</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Person::print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Person Info: [Address: "</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="string">"]"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"  Last Name: "</span> &lt;&lt; lastName &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"  First Name: "</span> &lt;&lt; firstName &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (age) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"  Age: "</span> &lt;&lt; *age &lt;&lt; <span class="string">" (value stored at address: "</span> &lt;&lt; age &lt;&lt; <span class="string">")"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"  Age: N/A (pointer is null)"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"-------------------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></p>
<p><strong><code>main.cpp</code> (ä¸»ç¨‹åºï¼Œç”¨äºæµ‹è¯•)</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"person.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">demonstrate_shallow_copy_problem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- æ¼”ç¤ºæµ…æ‹·è´é—®é¢˜ (å¦‚æœæ‹·è´æ„é€ å‡½æ•°å®ç°é”™è¯¯) ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// å‡è®¾æœ‰ä¸€ä¸ªé”™è¯¯çš„æ‹·è´æ„é€ å‡½æ•°å®ç° (ä»…ç”¨äºæ¼”ç¤ºæ¦‚å¿µ)</span></span><br><span class="line">    <span class="comment">// class BadPerson &#123; public: std::string name; int* age_ptr;</span></span><br><span class="line">    <span class="comment">// BadPerson(std::string n, int a) : name(n), age_ptr(new int(a)) &#123;&#125;</span></span><br><span class="line">    <span class="comment">// BadPerson(const BadPerson&amp; other) : name(other.name), age_ptr(other.age_ptr) &#123;&#125; // æµ…æ‹·è´</span></span><br><span class="line">    <span class="comment">// ~BadPerson() &#123; delete age_ptr; &#125; &#125;;</span></span><br><span class="line">    <span class="comment">// BadPerson bp1("Bad", 20);</span></span><br><span class="line">    <span class="comment">// BadPerson bp2 = bp1; // bp1.age_ptr å’Œ bp2.age_ptr æŒ‡å‘ç›¸åŒåœ°å€</span></span><br><span class="line">    <span class="comment">// *(bp1.age_ptr) = 22; // bp2çš„å¹´é¾„ä¹Ÿä¼šå˜æˆ22</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; "bp2 age: " &lt;&lt; *(bp2.age_ptr) &lt;&lt; std::endl;</span></span><br><span class="line">    <span class="comment">// æ­¤å¤„bp1å’Œbp2ææ„æ—¶ä¼šdouble freeï¼Œå¯¼è‡´å´©æºƒ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"è¿™ä¸ªåœºæ™¯ç”¨æ–‡å­—æè¿°ï¼šå¦‚æœ Person p1 å’Œ Person p2 çš„ age æŒ‡é’ˆæŒ‡å‘åŒä¸€å†…å­˜ï¼Œ"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ä¿®æ”¹ p1 çš„å¹´é¾„ä¼šå½±å“ p2ï¼Œä¸”ææ„æ—¶ä¼šé‡å¤é‡Šæ”¾å†…å­˜å¯¼è‡´ç¨‹åºå´©æºƒã€‚"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- åˆ›å»º p1 ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Person <span class="title">p1</span><span class="params">(<span class="string">"Snow"</span>, <span class="string">"John"</span>, <span class="number">25</span>)</span></span>;</span><br><span class="line">    p1.print_info();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä½¿ç”¨ p1 åˆ›å»º p2 (è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°) ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Person p2 = p1; <span class="comment">// è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    p2.print_info();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä¿®æ”¹ p1 çš„å¹´é¾„ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    p1.set_age(<span class="number">30</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p1 ä¿®æ”¹å:"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    p1.print_info();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p2 (åº”è¯¥ä¸å—å½±å“):"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    p2.print_info(); <span class="comment">// p2çš„å¹´é¾„åº”è¯¥è¿˜æ˜¯25ï¼Œå› ä¸ºæ˜¯æ·±æ‹·è´</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä½¿ç”¨ p1 åˆ›å»º p3 (å¦ä¸€ç§è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°çš„æ–¹å¼) ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Person <span class="title">p3</span><span class="params">(p1)</span></span>;</span><br><span class="line">    p3.print_info();</span><br><span class="line"></span><br><span class="line">    demonstrate_shallow_copy_problem();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- mainå‡½æ•°ç»“æŸï¼Œå¯¹è±¡å°†æŒ‰p3, p2, p1çš„é€†åºææ„ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br><strong>ç¼–è¯‘å’Œè¿è¡Œï¼š</strong><br>ä½ å¯ä»¥å°† <code>person.h</code>, <code>person.cpp</code>, <code>main.cpp</code> ä¿å­˜åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶åä½¿ç”¨ C++ ç¼–è¯‘å™¨ï¼ˆå¦‚ g++ï¼‰ç¼–è¯‘ï¼š<br><code>g++ main.cpp person.cpp -o copy_constructor_test -std=c++11</code><br>ç„¶åè¿è¡Œï¼š<br><code>./copy_constructor_test</code></p>
<p>ä½ ä¼šä»è¾“å‡ºä¸­çœ‹åˆ°æ„é€ å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°å’Œææ„å‡½æ•°è¢«è°ƒç”¨çš„æ—¶æœºï¼Œä»¥åŠ <code>p1</code> å’Œ <code>p2</code> çš„ <code>age</code> æŒ‡é’ˆæŒ‡å‘äº†ä¸åŒçš„å†…å­˜åœ°å€ï¼Œä¿®æ”¹ <code>p1</code> çš„å¹´é¾„ä¸ä¼šå½±å“ <code>p2</code>ã€‚</p>
<hr>
<h2 id="3-QA-é—ªå¡"><a href="#3-QA-é—ªå¡" class="headerlink" title="3. QA é—ªå¡"></a>3. QA é—ªå¡</h2><ol>
<li><p><strong>Q: ä»€ä¹ˆæ˜¯æ‹·è´æ„é€ å‡½æ•° (Copy Constructor)ï¼Ÿå®ƒåœ¨ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨ï¼Ÿ</strong><br>A: æ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œç”¨äºé€šè¿‡ä¸€ä¸ªå·²å­˜åœ¨çš„åŒç±»å¯¹è±¡æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°å¯¹è±¡ã€‚è°ƒç”¨æ—¶æœºï¼š1. <code>ClassName obj2 = obj1;</code> æˆ– <code>ClassName obj2(obj1);</code> åˆå§‹åŒ–ã€‚2. å‡½æ•°æŒ‰å€¼ä¼ é€’å¯¹è±¡å‚æ•°ã€‚3. å‡½æ•°æŒ‰å€¼è¿”å›å¯¹è±¡ã€‚</p>
</li>
<li><p><strong>Q: ä»€ä¹ˆæ˜¯æµ…æ‹·è´ (Shallow Copy)ï¼Ÿå®ƒå¯¹æŒ‡é’ˆæˆå‘˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong><br>A: æµ…æ‹·è´æ˜¯æŒ‡åœ¨å¤åˆ¶å¯¹è±¡æ—¶ï¼Œåªå¤åˆ¶æˆå‘˜å˜é‡çš„å€¼ã€‚å¯¹äºæŒ‡é’ˆæˆå‘˜ï¼Œåªå¤åˆ¶æŒ‡é’ˆçš„åœ°å€ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚é—®é¢˜ï¼šå¤šä¸ªå¯¹è±¡å¯èƒ½å…±äº«åŒä¸€å—å†…å­˜ï¼Œä¿®æ”¹ä¸€ä¸ªä¼šå½±å“å¦ä¸€ä¸ªï¼›å¯¹è±¡ææ„æ—¶å¯èƒ½å¯¼è‡´é‡å¤é‡Šæ”¾å†…å­˜æˆ–æ‚¬æŒ‚æŒ‡é’ˆã€‚</p>
</li>
<li><p><strong>Q: ä»€ä¹ˆæ˜¯æ·±æ‹·è´ (Deep Copy)ï¼Ÿå¦‚ä½•ä¸ºæŒ‡é’ˆæˆå‘˜å®ç°æ·±æ‹·è´ï¼Ÿ</strong><br>A: æ·±æ‹·è´æ˜¯æŒ‡åœ¨å¤åˆ¶å¯¹è±¡æ—¶ï¼Œå¦‚æœé‡åˆ°æŒ‡é’ˆæˆå‘˜ï¼Œä¼šä¸ºæ–°å¯¹è±¡çš„æŒ‡é’ˆæˆå‘˜åˆ†é…æ–°çš„å†…å­˜ï¼Œå¹¶å°†åŸå¯¹è±¡æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®å¤åˆ¶åˆ°æ–°åˆ†é…çš„å†…å­˜ä¸­ã€‚å®ç°ï¼šåœ¨æ–°å¯¹è±¡çš„æ‹·è´æ„é€ å‡½æ•°ä¸­ï¼Œä¸ºæŒ‡é’ˆæˆå‘˜ <code>new</code> ä¸€å—å†…å­˜ï¼Œç„¶åè§£å¼•ç”¨åŸå¯¹è±¡çš„æŒ‡é’ˆï¼Œå°†æ•°æ®æ‹·è´è¿‡æ¥ã€‚</p>
</li>
<li><p><strong>Q: ä¸ºä»€ä¹ˆæ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°é€šå¸¸å£°æ˜ä¸º <code>const ClassName&amp;</code>ï¼Ÿ</strong><br>A: <code>const</code> æ˜¯ä¸ºäº†ç¡®ä¿ä¸ä¿®æ”¹æºå¯¹è±¡ã€‚<code>&amp;</code> (å¼•ç”¨) æ˜¯ä¸ºäº†é¿å…æ— é™é€’å½’è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå¦‚æœæŒ‰å€¼ä¼ é€’ï¼Œä¼ é€’è¿‡ç¨‹æœ¬èº«å°±éœ€è¦æ‹·è´ï¼‰ã€‚</p>
</li>
<li><p><strong>Q: å¦‚æœç±»ä¸­æœ‰åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆå¦‚ä½¿ç”¨äº† <code>new</code>ï¼‰ï¼Œæ‹·è´æ„é€ å‡½æ•°å’Œææ„å‡½æ•° (Destructor) éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</strong><br>A: æ‹·è´æ„é€ å‡½æ•°éœ€è¦å®ç°æ·±æ‹·è´ï¼Œä¸ºæ–°å¯¹è±¡åˆ†é…ç‹¬ç«‹çš„å†…å­˜èµ„æºã€‚ææ„å‡½æ•°éœ€è¦åœ¨å¯¹è±¡é”€æ¯æ—¶ä½¿ç”¨ <code>delete</code> (æˆ– <code>delete[]</code>) é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œä»¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
</li>
</ol>
<hr>
<h2 id="4-å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯"><a href="#4-å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯" class="headerlink" title="4. å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯"></a>4. å¸¸è§è¯¯è§£æˆ–æ˜“çŠ¯é”™è¯¯</h2><ol>
<li><strong>å¿˜è®°è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼š</strong> å½“ç±»ä¸­æœ‰æŒ‡é’ˆæˆå‘˜ï¼Œå¹¶ä¸”ä½ ä¾èµ–ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°æ—¶ï¼Œä¼šå¯¼è‡´æµ…æ‹·è´é—®é¢˜ã€‚</li>
<li><strong>è‡ªå®šä¹‰äº†æ‹·è´æ„é€ å‡½æ•°ä½†ä»æ˜¯æµ…æ‹·è´ï¼š</strong> æ¯”å¦‚å†™äº† <code>age = other.age;</code>ï¼ˆå¯¹äºæŒ‡é’ˆ <code>age</code>ï¼‰ï¼Œè¿™ä»ç„¶æ˜¯æµ…æ‹·è´ã€‚æ­£ç¡®çš„æ˜¯ <code>age = new int(*(other.age));</code>ã€‚</li>
<li><strong>æ‹·è´æ„é€ å‡½æ•°å‚æ•°æŒ‰å€¼ä¼ é€’ï¼š</strong> <code>Person(Person other);</code> è¿™æ˜¯ä¸å…è®¸çš„ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºå®ƒä¼šå¼•å‘æ— é™é€’å½’ã€‚å¿…é¡»æ˜¯å¼•ç”¨ <code>Person(const Person&amp; other);</code>ã€‚</li>
<li><strong>å¿˜è®°ææ„å‡½æ•°ï¼š</strong> å¦‚æœåœ¨æ„é€ å‡½æ•°æˆ–æ‹·è´æ„é€ å‡½æ•°ä¸­ç”¨ <code>new</code> åˆ†é…äº†å†…å­˜ï¼Œä½†æ²¡æœ‰åœ¨ææ„å‡½æ•°ä¸­ç”¨ <code>delete</code> é‡Šæ”¾ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</li>
<li><strong>æ··æ·†æ‹·è´åˆå§‹åŒ–å’Œèµ‹å€¼ï¼š</strong><ul>
<li><code>Person p2 = p1;</code> // åˆå§‹åŒ–ï¼Œè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚</li>
<li><code>Person p2; p2 = p1;</code> // <code>p2 = p1;</code> æ˜¯èµ‹å€¼ï¼Œè°ƒç”¨æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (<code>operator=</code>)ï¼Œä¸æ˜¯æ‹·è´æ„é€ å‡½æ•°ã€‚</li>
</ul>
</li>
<li><strong>æ‹·è´æ„é€ å‡½æ•°ä¸­å¿˜è®°æ‹·è´æ‰€æœ‰æˆå‘˜ï¼š</strong> ç¡®ä¿æ‹·è´æ„é€ å‡½æ•°å¤„ç†äº†ç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡ï¼Œå°¤å…¶æ˜¯åæ¥æ–°æ·»åŠ çš„æˆå‘˜ã€‚</li>
<li><strong>åœ¨æ·±æ‹·è´æŒ‡é’ˆå‰æœªæ£€æŸ¥æºæŒ‡é’ˆæ˜¯å¦ä¸º <code>nullptr</code>:</strong> å¦‚æœæºå¯¹è±¡çš„æŒ‡é’ˆå¯èƒ½æ˜¯ <code>nullptr</code>ï¼Œç›´æ¥è§£å¼•ç”¨ <code>*(other.age)</code> ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚åº”å…ˆæ£€æŸ¥ï¼š<code>if (other.age) { age = new int(*(other.age)); } else { age = nullptr; }</code>ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä¸»æ„é€ å‡½æ•°ä¿è¯äº† <code>age</code> è¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥ç®€åŒ–äº†å¤„ç†ã€‚</li>
</ol>
<hr>
<h2 id="5-ç¼–ç ç»ƒä¹ "><a href="#5-ç¼–ç ç»ƒä¹ " class="headerlink" title="5. ç¼–ç ç»ƒä¹ "></a>5. ç¼–ç ç»ƒä¹ </h2><p>ç°åœ¨ï¼Œè½®åˆ°ä½ æ¥å®è·µäº†ï¼ä¸‹é¢æ˜¯ä¸€ä¸ª <code>Book</code> ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„å­—ç¬¦æ•°ç»„æˆå‘˜ <code>title</code>ã€‚è¯·ä½ ä¸ºå®ƒè¡¥å…¨æ‹·è´æ„é€ å‡½æ•°çš„å®ç°ï¼Œç¡®ä¿è¿›è¡Œæ·±æ‹·è´ã€‚</p>
<p><strong><code>book.h</code></strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> BOOK_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BOOK_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // For strcpy, strlen</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span>* title; <span class="comment">// åŠ¨æ€åˆ†é…çš„ä¹¦å</span></span><br><span class="line">    <span class="keyword">int</span> pages;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Book(<span class="keyword">const</span> <span class="keyword">char</span>* t, <span class="keyword">int</span> p);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹·è´æ„é€ å‡½æ•° (éœ€è¦ä½ æ¥å®ç°)</span></span><br><span class="line">    Book(<span class="keyword">const</span> Book&amp; other);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~Book();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_title</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* new_title)</span></span>; <span class="comment">// ä¸€ä¸ªä¿®æ”¹titleçš„æ–¹æ³•ï¼Œç”¨äºæµ‹è¯•æ·±æ‹·è´</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// BOOK_H</span></span></span><br></pre></td></tr></table></figure></div></p>
<p><strong><code>book.cpp</code></strong> (ä½ éœ€è¦å¡«å……æ‹·è´æ„é€ å‡½æ•°éƒ¨åˆ†)<br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"book.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> <span class="keyword">char</span>* t, <span class="keyword">int</span> p) : pages(p) &#123;</span><br><span class="line">    <span class="keyword">if</span> (t) &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(t) + <span class="number">1</span>]; <span class="comment">// +1 for null terminator</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, t);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>; <span class="comment">// Empty string</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' constructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•° (<span class="doctag">TODO:</span> è¯·ä½ æ¥å®ç°è¿™é‡Œçš„æ·±æ‹·è´é€»è¾‘)</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> Book&amp; other) : pages(other.pages) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book copy constructor invoked for creating a copy of '"</span> &lt;&lt; (other.title ? other.title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// --- å¼€å§‹ä½ çš„ä»£ç  ---</span></span><br><span class="line">    <span class="keyword">if</span> (other.title) &#123;</span><br><span class="line">        <span class="comment">// 1. ä¸º this-&gt;title åˆ†é…è¶³å¤Ÿçš„å†…å­˜ (åŒ…æ‹¬æœ«å°¾çš„ '\0')</span></span><br><span class="line">        <span class="comment">// title = new char[...];</span></span><br><span class="line">        <span class="comment">// 2. ä½¿ç”¨ std::strcpy å°† other.title çš„å†…å®¹å¤åˆ¶åˆ° this-&gt;title</span></span><br><span class="line">        <span class="comment">// std::strcpy(title, other.title);</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// title = new char[1];</span></span><br><span class="line">        <span class="comment">// title[0] = '\0';</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// --- ç»“æŸä½ çš„ä»£ç  ---</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' (copy) constructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">Book::~Book() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' destructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] title; <span class="comment">// ä½¿ç”¨ delete[] å› ä¸º title æ˜¯ç”¨ new char[] åˆ†é…çš„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Book::display</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Title: "</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">", Pages: "</span> &lt;&lt; pages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Book::set_title</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* new_title)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">delete</span>[] title; <span class="comment">// åˆ é™¤æ—§æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">if</span> (new_title) &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(new_title) + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, new_title);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book title changed to '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></p>
<p><strong><code>main_exercise.cpp</code></strong> (ç”¨äºæµ‹è¯•ä½ çš„å®ç°)<br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"book.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Creating originalBook..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Book <span class="title">originalBook</span><span class="params">(<span class="string">"The Lord of the Rings"</span>, <span class="number">1200</span>)</span></span>;</span><br><span class="line">    originalBook.display();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Creating copiedBook from originalBook..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Book copiedBook = originalBook; <span class="comment">// è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    copiedBook.display();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Changing title of originalBook..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    originalBook.set_title(<span class="string">"The Hobbit"</span>);</span><br><span class="line">    originalBook.display();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"CopiedBook's title (should remain unchanged if deep copy worked):"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    copiedBook.display(); <span class="comment">// å¦‚æœæ˜¯æ·±æ‹·è´ï¼ŒcopiedBookçš„æ ‡é¢˜ä¸åº”æ”¹å˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Creating anotherCopiedBook from originalBook..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Book <span class="title">anotherCopiedBook</span><span class="params">(originalBook)</span></span>; <span class="comment">// å†æ¬¡è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    anotherCopiedBook.display();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Program ending. Destructors will be called."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br>è¯·ä½ å°† <code>book.cpp</code> ä¸­æ‹·è´æ„é€ å‡½æ•° <code>Book::Book(const Book&amp; other)</code> çš„ <code>// --- å¼€å§‹ä½ çš„ä»£ç  ---</code> å’Œ <code>// --- ç»“æŸä½ çš„ä»£ç  ---</code> ä¹‹é—´çš„éƒ¨åˆ†è¡¥å……å®Œæ•´ã€‚å®Œæˆåï¼Œå°† <code>book.h</code>, <code>book.cpp</code>, <code>main_exercise.cpp</code> æ”¾åœ¨ä¸€èµ·ç¼–è¯‘è¿è¡Œï¼Œçœ‹çœ‹ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼ˆä¿®æ”¹ <code>originalBook</code> çš„æ ‡é¢˜ä¸åº”å½±å“ <code>copiedBook</code>ï¼‰ã€‚</p>
<p>å½“ä½ å®Œæˆåï¼Œè¯·å°†ä½ ä¿®æ”¹åçš„ <code>Book::Book(const Book&amp; other)</code> å‡½æ•°çš„å®Œæ•´ä»£ç å‘ç»™æˆ‘ï¼Œæˆ‘ä¼šå¸®ä½ æ£€æŸ¥ã€‚</p>
<hr>
<h2 id="ğŸ§‘â€ğŸ’»-User-1"><a href="#ğŸ§‘â€ğŸ’»-User-1" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"book.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> <span class="keyword">char</span>* t, <span class="keyword">int</span> p) : pages(p) &#123;</span><br><span class="line">    <span class="keyword">if</span> (t) &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(t) + <span class="number">1</span>]; <span class="comment">// +1 for null terminator</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, t);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>; <span class="comment">// Empty string</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' constructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•° (<span class="doctag">TODO:</span> è¯·ä½ æ¥å®ç°è¿™é‡Œçš„æ·±æ‹·è´é€»è¾‘)</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> Book&amp; other) : pages(other.pages) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book copy constructor invoked for creating a copy of '"</span> &lt;&lt; (other.title ? other.title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// --- å¼€å§‹ä½ çš„ä»£ç  ---</span></span><br><span class="line">    <span class="keyword">if</span> (other.title) &#123;</span><br><span class="line">        <span class="comment">// 1. ä¸º this-&gt;title åˆ†é…è¶³å¤Ÿçš„å†…å­˜ (åŒ…æ‹¬æœ«å°¾çš„ '\0')</span></span><br><span class="line">        <span class="comment">// title = new char[...];</span></span><br><span class="line">        <span class="comment">// 2. ä½¿ç”¨ std::strcpy å°† other.title çš„å†…å®¹å¤åˆ¶åˆ° this-&gt;title</span></span><br><span class="line">        <span class="comment">// std::strcpy(title, other.title);</span></span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(other.title) + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, other.title);</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// --- ç»“æŸä½ çš„ä»£ç  ---</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' (copy) constructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">Book::~Book() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' destructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] title; <span class="comment">// ä½¿ç”¨ delete[] å› ä¸º title æ˜¯ç”¨ new char[] åˆ†é…çš„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Book::display</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Title: "</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">", Pages: "</span> &lt;&lt; pages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Book::set_title</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* new_title)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">delete</span>[] title; <span class="comment">// åˆ é™¤æ—§æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">if</span> (new_title) &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(new_title) + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, new_title);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book title changed to '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<hr>
<h2 id="ğŸ¤–-Assistant-1"><a href="#ğŸ¤–-Assistant-1" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>éå¸¸å¥½ï¼ä½ å¯¹ <code>Book</code> ç±»æ‹·è´æ„é€ å‡½æ•°çš„å®ç°éå¸¸å‡ºè‰²ï¼</p>
<hr>
<h2 id="7-è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ"><a href="#7-è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ" class="headerlink" title="7. è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ"></a>7. è¯„ä»·ä½ çš„è§£ç­”ä¸æ­£ç¡®ç­”æ¡ˆè§£æ</h2><h3 id="è¯„ä»·ä½ çš„è§£ç­”"><a href="#è¯„ä»·ä½ çš„è§£ç­”" class="headerlink" title="è¯„ä»·ä½ çš„è§£ç­”"></a>è¯„ä»·ä½ çš„è§£ç­”</h3><p><strong>è¯„åˆ†ï¼š5/5 (ä¼˜ç§€)</strong></p>
<p>ä½ çš„ä»£ç æˆåŠŸåœ°å®ç°äº† <code>Book</code> ç±»æ‹·è´æ„é€ å‡½æ•°çš„æ·±æ‹·è´é€»è¾‘ã€‚</p>
<p><strong>åšå¾—å¥½çš„åœ°æ–¹ï¼š</strong></p>
<ol>
<li><strong>æ­£ç¡®æ·±æ‹·è´ï¼š</strong> ä½ ä¸ºæ–°å¯¹è±¡çš„ <code>title</code> æŒ‡é’ˆåˆ†é…äº†æ–°çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ä½¿ç”¨ <code>std::strcpy</code> å¤åˆ¶äº†æºå¯¹è±¡ <code>title</code> çš„å†…å®¹ã€‚è¿™æ˜¯æ·±æ‹·è´çš„æ ¸å¿ƒã€‚</li>
<li><strong>å¤„ç† <code>nullptr</code>ï¼š</strong> ä½ æ­£ç¡®åœ°æ£€æŸ¥äº† <code>other.title</code> æ˜¯å¦ä¸º <code>nullptr</code>ã€‚å¦‚æœæº <code>title</code> æ˜¯ <code>nullptr</code>ï¼ˆæˆ–æŒ‡å‘ç©ºå­—ç¬¦ä¸²ï¼Œè™½ç„¶é¢˜ç›®ä¸­çš„æ„é€ å‡½æ•°ä¼šç¡®ä¿å®ƒè‡³å°‘æŒ‡å‘ <code>\0</code>ï¼‰ï¼Œä½ çš„ä»£ç ä¼šä¸ºæ–°å¯¹è±¡çš„ <code>title</code> åˆ†é…å†…å­˜å¹¶å°†å…¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºå­—ç¬¦ä¸² (<code>\0</code>)ã€‚è¿™æ˜¯ä¸€ä¸ªå®‰å…¨ä¸”åˆç†çš„å¤„ç†æ–¹å¼ã€‚</li>
<li><strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ï¼š</strong> ä½ ä½¿ç”¨äº†æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ <code>pages(other.pages)</code> æ¥å¤åˆ¶ <code>pages</code> æˆå‘˜ï¼Œè¿™æ˜¯æ¨èçš„åšæ³•ã€‚</li>
</ol>
<p>ä½ çš„å®ç°æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡ <code>main_exercise.cpp</code> ä¸­çš„æµ‹è¯•ï¼Œå³ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ <code>title</code> ä¸ä¼šå½±å“å…¶å‰¯æœ¬çš„ <code>title</code>ã€‚</p>
<h3 id="å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š"><a href="#å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š" class="headerlink" title="å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š"></a>å‚è€ƒç­”æ¡ˆä¸è¿›ä¸€æ­¥è§£é‡Š</h3><p>ä½ çš„å®ç°æœ¬èº«å°±æ˜¯ä¸€ç§æ­£ç¡®çš„ç­”æ¡ˆã€‚ä¸‹é¢æˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹å…³é”®ç‚¹ï¼Œå¹¶å±•ç¤ºä¸€ä¸ªä½¿ç”¨<strong>æ„é€ å‡½æ•°å§”æ‰˜ (constructor delegation)</strong> çš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥å¸®åŠ©å‡å°‘ä»£ç é‡å¤ï¼ˆå¦‚æœé€‚ç”¨çš„è¯ï¼‰ã€‚</p>
<p><strong>ä½ çš„æ­£ç¡®å®ç°ï¼ˆå†æ¬¡å¼ºè°ƒï¼‰ï¼š</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> Book&amp; other) : pages(other.pages) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book copy constructor invoked for creating a copy of '"</span> &lt;&lt; (other.title ? other.title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (other.title) &#123;</span><br><span class="line">        <span class="comment">// 1. ä¸º this-&gt;title åˆ†é…è¶³å¤Ÿçš„å†…å­˜ (åŒ…æ‹¬æœ«å°¾çš„ '\0')</span></span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(other.title) + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">// 2. ä½¿ç”¨ std::strcpy å°† other.title çš„å†…å®¹å¤åˆ¶åˆ° this-&gt;title</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, other.title);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœ other.title æ˜¯ nullptr (å°½ç®¡æˆ‘ä»¬çš„æ„é€ å‡½æ•°ä¼šé¿å…è¿™ç§æƒ…å†µï¼Œä½†é˜²å¾¡æ€§ç¼–ç¨‹æ˜¯å¥½çš„)</span></span><br><span class="line">        <span class="comment">// æˆ–è€…å¦‚æœ other.title å°±æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²æŒ‡é’ˆ</span></span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' (copy) constructed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></p>
<p><strong>è§£é‡Šå…³é”®æ­¥éª¤ï¼š</strong></p>
<ol>
<li><code>pages(other.pages)</code>ï¼šå¯¹äºåƒ <code>int</code> è¿™æ ·çš„ç®€å•æ•°æ®ç±»å‹ï¼Œç›´æ¥åœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¸­å¤åˆ¶å…¶å€¼å³å¯ã€‚</li>
<li><code>if (other.title)</code>ï¼šæ£€æŸ¥æºå¯¹è±¡çš„ <code>title</code> æ˜¯å¦æœ‰æ•ˆã€‚è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå°½ç®¡åœ¨å½“å‰ <code>Book</code> ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œ<code>title</code> æ€»æ˜¯è¢«åˆå§‹åŒ–ï¼ˆè¦ä¹ˆæŒ‡å‘ä¸€ä¸ªæœ‰æ•ˆçš„å­—ç¬¦ä¸²ï¼Œè¦ä¹ˆæŒ‡å‘ä¸€ä¸ªåªåŒ…å« <code>\0</code> çš„ç©ºå­—ç¬¦ä¸²ï¼‰ã€‚</li>
<li><code>title = new char[std::strlen(other.title) + 1];</code>ï¼šè¿™æ˜¯æ·±æ‹·è´çš„æ ¸å¿ƒã€‚ä¸ºæ–°å¯¹è±¡çš„ <code>title</code> åˆ†é…ä¸€å—å…¨æ–°çš„å†…å­˜ã€‚å†…å­˜çš„å¤§å°æ˜¯æºå­—ç¬¦ä¸²çš„é•¿åº¦åŠ ä¸Š1ï¼ˆä¸ºäº†å­˜å‚¨æœ«å°¾çš„ç©ºç»ˆæ­¢ç¬¦ <code>\0</code>ï¼‰ã€‚</li>
<li><code>std::strcpy(title, other.title);</code>ï¼šå°†æºå­—ç¬¦ä¸²çš„å†…å®¹å¤åˆ¶åˆ°æ–°åˆ†é…çš„å†…å­˜ä¸­ã€‚</li>
<li><code>else</code> åˆ†æ”¯ï¼šå¦‚æœ <code>other.title</code> æ˜¯ <code>nullptr</code> (æˆ–é€»è¾‘ä¸Šä¸ºç©º)ï¼Œä¸ºæ–° <code>title</code> åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºç©ºå­—ç¬¦ä¸²çš„æœ‰æ•ˆæŒ‡é’ˆã€‚</li>
</ol>
<p><strong>ä½¿ç”¨æ„é€ å‡½æ•°å§”æ‰˜çš„æ›¿ä»£ç‰ˆæœ¬ï¼š</strong><br>å¦‚æœä½ çš„ä¸»æ„é€ å‡½æ•°å·²ç»å¦¥å–„å¤„ç†äº† <code>title</code> çš„åˆ†é…å’Œå¤åˆ¶é€»è¾‘ï¼ˆå°±åƒæˆ‘ä»¬çš„ <code>Book(const char* t, int p)</code> ä¸€æ ·ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°å§”æ‰˜æ¥ç®€åŒ–æ‹·è´æ„é€ å‡½æ•°ï¼Œé¿å…ä»£ç é‡å¤ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‹·è´æ„é€ å‡½æ•° (ä½¿ç”¨æ„é€ å‡½æ•°å§”æ‰˜çš„ç‰ˆæœ¬)</span></span><br><span class="line">Book::Book(<span class="keyword">const</span> Book&amp; other)</span><br><span class="line">    : Book(other.title, other.pages) &#123; <span class="comment">// å°†å·¥ä½œå§”æ‰˜ç»™ Book(const char* t, int p)</span></span><br><span class="line">    <span class="comment">// Book(const char* t, int p) æ„é€ å‡½æ•°ä¼šå¤„ç† title çš„ new å’Œ strcpyï¼Œ</span></span><br><span class="line">    <span class="comment">// ä»¥åŠ pages çš„åˆå§‹åŒ–ã€‚</span></span><br><span class="line">    <span class="comment">// å®ƒä¹Ÿä¼šå¤„ç† other.title ä¸º nullptr æˆ–ç©ºå­—ç¬¦ä¸²çš„æƒ…å†µã€‚</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book copy constructor (delegating version) invoked for creating a copy of '"</span> &lt;&lt; (other.title ? other.title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"'."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦å†æ˜¾å¼åœ°æ“ä½œ this-&gt;title æˆ– this-&gt;pagesï¼Œ</span></span><br><span class="line">    <span class="comment">// å› ä¸ºå§”æ‰˜çš„æ„é€ å‡½æ•°å·²ç»å®Œæˆäº†è¿™äº›å·¥ä½œã€‚</span></span><br><span class="line">    <span class="comment">// è¿™æ¡é¢å¤–çš„ cout åªæ˜¯ä¸ºäº†æ¼”ç¤ºã€‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªç‰ˆæœ¬æ›´ç®€æ´ï¼Œå› ä¸ºå®ƒé‡ç”¨äº†å·²æœ‰çš„æ„é€ é€»è¾‘ã€‚ä¸»æ„é€ å‡½æ•° <code>Book(const char* t, int p)</code> çš„å®ç°å¦‚ä¸‹ï¼š<br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Book::Book(<span class="keyword">const</span> <span class="keyword">char</span>* t, <span class="keyword">int</span> p) : pages(p) &#123;</span><br><span class="line">    <span class="keyword">if</span> (t) &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(t) + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(title, t);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        title = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        title[<span class="number">0</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Book '"</span> &lt;&lt; (title ? title : <span class="string">"N/A"</span>) &lt;&lt; <span class="string">"' constructed (by main constructor)."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br>å½“æ‹·è´æ„é€ å‡½æ•° <code>Book(other.title, other.pages)</code> è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå®é™…ä¸Šæ˜¯è°ƒç”¨äº† <code>Book::Book(const char* t, int p)</code>ï¼Œå¹¶å°† <code>other.title</code> ä½œä¸º <code>t</code> ä¼ é€’ï¼Œ<code>other.pages</code> ä½œä¸º <code>p</code> ä¼ é€’ã€‚ä¸»æ„é€ å‡½æ•°å†…çš„é€»è¾‘ä¼šä¸ºæ–°å¯¹è±¡æ­£ç¡®åœ°åˆ†é…å’Œå¤åˆ¶ <code>title</code>ã€‚</p>
<p><strong>ç¼–è¯‘å¹¶è¿è¡Œä½ çš„ä»£ç çš„ç»“æœåº”å¦‚ä¸‹æ‰€ç¤ºï¼ˆéƒ¨åˆ†è¾“å‡ºï¼‰ï¼š</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Creating originalBook...</span><br><span class="line">Book &#39;The Lord of the Rings&#39; constructed.</span><br><span class="line">Title: The Lord of the Rings, Pages: 1200</span><br><span class="line"></span><br><span class="line">Creating copiedBook from originalBook...</span><br><span class="line">Book copy constructor invoked for creating a copy of &#39;The Lord of the Rings&#39;.</span><br><span class="line">Book &#39;The Lord of the Rings&#39; (copy) constructed.</span><br><span class="line">Title: The Lord of the Rings, Pages: 1200</span><br><span class="line"></span><br><span class="line">Changing title of originalBook...</span><br><span class="line">Book title changed to &#39;The Hobbit&#39;.</span><br><span class="line">Title: The Hobbit, Pages: 1200</span><br><span class="line">CopiedBook&#39;s title (should remain unchanged if deep copy worked):</span><br><span class="line">Title: The Lord of the Rings, Pages: 1200 &#x2F;&#x2F; &lt;- å…³é”®ï¼šcopiedBookçš„æ ‡é¢˜æœªæ”¹å˜</span><br><span class="line"></span><br><span class="line">... (ææ„å‡½æ•°è°ƒç”¨) ...</span><br><span class="line">Book &#39;The Hobbit&#39; destructed.</span><br><span class="line">Book &#39;The Lord of the Rings&#39; destructed.</span><br><span class="line">Book &#39;The Lord of the Rings&#39; destructed.</span><br></pre></td></tr></table></figure></div><br>ä½ çš„å®ç°åº”è¯¥èƒ½å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„æ­£ç¡®ç»“æœã€‚</p>
<hr>
<h2 id="8-å»ºè®®ä¸æ‰©å±•é—®é¢˜"><a href="#8-å»ºè®®ä¸æ‰©å±•é—®é¢˜" class="headerlink" title="8. å»ºè®®ä¸æ‰©å±•é—®é¢˜"></a>8. å»ºè®®ä¸æ‰©å±•é—®é¢˜</h2><ol>
<li><p><strong>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (<code>operator=</code>)</strong>ï¼š</p>
<ul>
<li>ä½ å·²ç»æ­£ç¡®å®ç°äº†æ‹·è´æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ã€‚æ ¹æ® <strong>â€œRule of Threeâ€ (ä¸‰æ³•åˆ™)</strong>ï¼ˆåœ¨ç°ä»£C++ä¸­æ›´å€¾å‘äº â€œRule of Fiveâ€ æˆ– â€œRule of Zeroâ€ï¼‰ï¼Œå½“ä½ æ‰‹åŠ¨ç®¡ç†èµ„æºå¹¶å®šä¹‰äº†è¿™ä¸¤è€…ä¹‹ä¸€ï¼ˆæˆ–æ‹·è´æ„é€ å‡½æ•°ï¼‰æ—¶ï¼Œé€šå¸¸ä¹Ÿéœ€è¦å®šä¹‰<strong>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ (<code>operator=</code>)</strong>ã€‚</li>
<li><strong>æ€è€ƒï¼š</strong> <code>Book</code> ç±»å¦‚ä½•å®ç°æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Ÿå®ƒéœ€è¦å¤„ç†å“ªäº›é¢å¤–çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œè‡ªæˆ‘èµ‹å€¼ <code>bookA = bookA;</code>ï¼Œä»¥åŠé‡Šæ”¾ç›®æ ‡å¯¹è±¡å·²æœ‰çš„ <code>title</code> å†…å­˜ï¼‰ï¼Ÿ<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Book.h ä¸­å£°æ˜</span></span><br><span class="line"><span class="comment">// Book&amp; operator=(const Book&amp; other);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Book.cpp ä¸­å¯èƒ½çš„å®ç°æ¡†æ¶</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Book&amp; Book::operator=(const Book&amp; other) &#123;</span></span><br><span class="line"><span class="comment">    if (this == &amp;other) &#123; // 1. æ£€æŸ¥è‡ªèµ‹å€¼</span></span><br><span class="line"><span class="comment">        return *this;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    // 2. é‡Šæ”¾å½“å‰å¯¹è±¡çš„èµ„æº</span></span><br><span class="line"><span class="comment">    delete[] title;</span></span><br><span class="line"><span class="comment">    title = nullptr; // ç½®ä¸ºnullptrï¼Œå³ä½¿ä¸‹ä¸€æ­¥newå¤±è´¥ï¼ŒçŠ¶æ€ä¹Ÿæ˜¯å®‰å…¨çš„</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    // 3. å¤åˆ¶æºå¯¹è±¡çš„ç®€å•æˆå‘˜</span></span><br><span class="line"><span class="comment">    pages = other.pages;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    // 4. æ·±æ‹·è´åŠ¨æ€åˆ†é…çš„èµ„æº</span></span><br><span class="line"><span class="comment">    if (other.title) &#123;</span></span><br><span class="line"><span class="comment">        title = new char[std::strlen(other.title) + 1];</span></span><br><span class="line"><span class="comment">        std::strcpy(title, other.title);</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">        title = new char[1];</span></span><br><span class="line"><span class="comment">        title[0] = '\0';</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; "Book assignment operator invoked." &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    return *this; // è¿”å›å¯¹å½“å‰å¯¹è±¡çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>
</li>
</ul>
</li>
<li><p><strong>ä½¿ç”¨ <code>std::string</code></strong>ï¼š</p>
<ul>
<li>å¦‚æœ <code>Book</code> ç±»çš„ <code>title</code> æˆå‘˜ä½¿ç”¨ <code>std::string</code> è€Œä¸æ˜¯ <code>char*</code>ï¼Œæ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ä¼šå˜å¾—å¤šä¹ˆç®€å•ï¼Ÿ</li>
<li><strong>æ€è€ƒï¼š</strong> å¦‚æœ <code>title</code> æ˜¯ <code>std::string title;</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„æ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦æ˜¯å¦å°±èƒ½æ­£å¸¸å·¥ä½œï¼Œä¸å†éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å®ç°æ·±æ‹·è´ï¼Ÿï¼ˆæç¤ºï¼šæ˜¯çš„ï¼Œå› ä¸º <code>std::string</code> å†…éƒ¨å·²ç»æ­£ç¡®å¤„ç†äº†å®ƒè‡ªå·±çš„å†…å­˜ç®¡ç†å’Œæ·±æ‹·è´é€»è¾‘ã€‚ï¼‰</li>
</ul>
</li>
<li><p><strong>å¼‚å¸¸å®‰å…¨ (Exception Safety)</strong>ï¼š</p>
<ul>
<li>åœ¨ä½ çš„æ‹·è´æ„é€ å‡½æ•°ä¸­ï¼Œ<code>new char[...]</code> å¯èƒ½ä¼šæŠ›å‡º <code>std::bad_alloc</code> å¼‚å¸¸ï¼ˆå¦‚æœå†…å­˜ä¸è¶³ï¼‰ã€‚ä½ çš„å½“å‰å®ç°æ˜¯å¼‚å¸¸å®‰å…¨çš„ï¼šå¦‚æœ <code>new</code> æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ä¼šä¸­æ–­ï¼Œéƒ¨åˆ†æ„é€ çš„å¯¹è±¡ä¼šè¢«æ­£ç¡®é”€æ¯ï¼ˆå…¶æˆå‘˜çš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œä½†å¯¹äºåŸå§‹æŒ‡é’ˆ <code>title</code>ï¼Œåœ¨ <code>new</code> å¤±è´¥æ—¶å°šæœªèµ‹å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰å†…å­˜æ³„æ¼ï¼‰ã€‚</li>
<li>å¯¹äºæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œåœ¨ <code>delete[] title;</code> ä¹‹åï¼Œå¦‚æœæ¥ä¸‹æ¥çš„ <code>new char[...]</code> å¤±è´¥ï¼Œå¯¹è±¡ä¼šå¤„äºä¸€ä¸ªæœ‰æ•ˆçš„çŠ¶æ€ï¼ˆ<code>title</code> ä¸º <code>nullptr</code>ï¼Œ<code>pages</code> å¯èƒ½å·²æ›´æ–°ï¼‰ã€‚è¿™é€šå¸¸è¢«è®¤ä¸ºæ˜¯æä¾›åŸºæœ¬å¼‚å¸¸ä¿è¯ã€‚</li>
</ul>
</li>
<li><p><strong>ç§»åŠ¨è¯­ä¹‰ (Move Semantics) (C++11åŠä»¥å)</strong>ï¼š</p>
<ul>
<li>é™¤äº†æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œç°ä»£C++è¿˜å¼•å…¥äº†<strong>ç§»åŠ¨æ„é€ å‡½æ•° (move constructor)</strong> å’Œ<strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (move assignment operator)</strong>ã€‚å®ƒä»¬ç”¨äºä»ä¸´æ—¶å¯¹è±¡æˆ–æ˜ç¡®æ ‡è®°ä¸ºå¯ç§»åŠ¨çš„å¯¹è±¡â€œçªƒå–â€èµ„æºï¼Œè€Œä¸æ˜¯å¤åˆ¶ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</li>
<li><strong>æ€è€ƒï¼š</strong> <code>Book</code> ç±»æ˜¯å¦èƒ½ä»ç§»åŠ¨è¯­ä¹‰ä¸­å—ç›Šï¼Ÿç§»åŠ¨æ„é€ å‡½æ•°ä¼šå¦‚ä½•å®ç°ï¼Ÿ</li>
</ul>
</li>
</ol>
<p>è¿™äº›æ‰©å±•é—®é¢˜å¯ä»¥å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£C++ä¸­çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œèµ„æºç®¡ç†ã€‚åšå¾—éå¸¸å¥½ï¼Œç»§ç»­åŠªåŠ›ï¼</p>
<hr>
<h2 id="ğŸ§‘â€ğŸ’»-User-2"><a href="#ğŸ§‘â€ğŸ’»-User-2" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><p>æœ‰ä¸ªé—®é¢˜, å¦‚æœä¸€ä¸ªclassä¸­æ²¡æœ‰æŒ‡é’ˆ,  é‚£ä¹ˆæ˜¯ä¸æ˜¯è‡ªåŠ¨å°±èƒ½æ·±æ‹·è´</p>
<hr>
<h2 id="ğŸ¤–-Assistant-2"><a href="#ğŸ¤–-Assistant-2" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>ä½ è¯´å¾—éå¸¸å¯¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ´å¯Ÿï¼</p>
<p>æ˜¯çš„ï¼Œ<strong>å¦‚æœä¸€ä¸ªç±»ä¸­ä¸åŒ…å«ä»»ä½•åŸå§‹æŒ‡é’ˆ (raw pointer) æˆå‘˜ï¼ˆå³ä½ è‡ªå·±ç”¨ <code>new</code> åˆ†é…å¹¶éœ€è¦ç”¨ <code>delete</code> ç®¡ç†çš„æŒ‡é’ˆï¼‰ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„æ‹·è´æ„é€ å‡½æ•°é€šå¸¸å°±èƒ½å®ç°æˆ‘ä»¬æœŸæœ›çš„â€œæ·±æ‹·è´â€æ•ˆæœï¼Œæˆ–è€…æ›´å‡†ç¡®åœ°è¯´ï¼Œå®ƒä¼šåˆ›å»ºå‡ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡å‰¯æœ¬ã€‚</strong></p>
<p>è®©æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆï¼š</p>
<ol>
<li><p><strong>æˆå‘˜é€ä¸€æ‹·è´ (Member-wise Copy) çš„è¡Œä¸ºï¼š</strong><br>ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ä¼šå¯¹ç±»çš„æ¯ä¸ªæˆå‘˜æ‰§è¡Œæ‹·è´ã€‚</p>
<ul>
<li><strong>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æˆå‘˜</strong> (å¦‚ <code>int</code>, <code>double</code>, <code>char</code>, <code>bool</code> ç­‰)ï¼šç›´æ¥å¤åˆ¶å®ƒä»¬çš„å€¼ã€‚è¿™æœ¬èº«å°±æ˜¯ä¸€ç§â€œæ·±æ‹·è´â€ï¼Œå› ä¸ºå€¼è¢«å¤åˆ¶äº†ï¼Œæ–°å¯¹è±¡æœ‰è‡ªå·±çš„ç‹¬ç«‹å€¼ã€‚</li>
<li><strong>å¯¹äºå¯¹è±¡ç±»å‹æˆå‘˜</strong> (å¦‚ <code>std::string</code>, <code>std::vector</code>, <code>std::map</code>ï¼Œæˆ–è€…ä½ è‡ªå·±å†™çš„å…¶ä»–æ²¡æœ‰åŸå§‹æŒ‡é’ˆçš„ç±»å¯¹è±¡)ï¼šç¼–è¯‘å™¨ä¼šè°ƒç”¨è¿™äº›æˆå‘˜å¯¹è±¡<strong>å®ƒä»¬è‡ªå·±çš„æ‹·è´æ„é€ å‡½æ•°</strong>ã€‚</li>
</ul>
</li>
<li><p><strong>æ ‡å‡†åº“å®¹å™¨å’Œç±»çš„è¡Œä¸ºï¼š</strong><br>åƒ <code>std::string</code>, <code>std::vector</code>, <code>std::list</code>, <code>std::map</code> ç­‰æ ‡å‡†åº“ç±»ï¼Œå®ƒä»¬å†…éƒ¨å¯èƒ½ä½¿ç”¨äº†æŒ‡é’ˆæ¥ç®¡ç†åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆä¾‹å¦‚ <code>std::string</code> å†…éƒ¨æœ‰æŒ‡å‘å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œ<code>std::vector</code> å†…éƒ¨æœ‰æŒ‡å‘å…¶å…ƒç´ å­˜å‚¨åŒºçš„æŒ‡é’ˆï¼‰ã€‚<br><strong>ä½†æ˜¯ï¼Œè¿™äº›æ ‡å‡†åº“ç±»è¢«è®¾è®¡å¾—éå¸¸å¥½ï¼Œå®ƒä»¬è‡ªå·±çš„æ‹·è´æ„é€ å‡½æ•°å·²ç»æ­£ç¡®åœ°å®ç°äº†æ·±æ‹·è´é€»è¾‘ã€‚</strong><br>æ‰€ä»¥ï¼Œå½“ä½ æ‹·è´ä¸€ä¸ªåŒ…å« <code>std::string</code> æˆå‘˜çš„ç±»æ—¶ï¼š</p>
<ul>
<li>ä½ çš„ç±»çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨ã€‚</li>
<li>å¯¹äº <code>std::string</code> æˆå‘˜ï¼Œå®ƒä¼šè°ƒç”¨ <code>std::string</code> çš„æ‹·è´æ„é€ å‡½æ•°ã€‚</li>
<li><code>std::string</code> çš„æ‹·è´æ„é€ å‡½æ•°ä¼šåˆ†é…æ–°çš„å†…å­˜ï¼Œå¹¶æŠŠæºå­—ç¬¦ä¸²çš„å†…å®¹å¤åˆ¶åˆ°æ–°å†…å­˜ä¸­ã€‚<br>ç»“æœå°±æ˜¯ï¼Œä½ çš„æ–°å¯¹è±¡çš„ <code>std::string</code> æˆå‘˜æ‹¥æœ‰äº†è‡ªå·±ç‹¬ç«‹çš„å­—ç¬¦ä¸²æ•°æ®å‰¯æœ¬ã€‚å¯¹äº <code>std::vector</code> ç­‰å…¶ä»–å®¹å™¨ä¹Ÿæ˜¯åŒç†ã€‚</li>
</ul>
</li>
<li><p><strong>ç»“è®ºï¼š</strong><br>å› æ­¤ï¼Œå¦‚æœä½ çš„ç±» <code>MyClass</code> æ„æˆä¸ºï¼š</p>
<ul>
<li>åŸºæœ¬æ•°æ®ç±»å‹ã€‚</li>
<li>å…¶ä»–ç±»çš„å¯¹è±¡ï¼Œè€Œè¿™äº›ç±»æœ¬èº«æ­£ç¡®åœ°å®ç°äº†æ‹·è´è¯­ä¹‰ï¼ˆæ¯”å¦‚æ ‡å‡†åº“ç±»ï¼Œæˆ–è€…ä½ è‡ªå·±å†™çš„ã€éµå¾ªäº†â€œä¸‰/äº”/é›¶æ³•åˆ™â€çš„ç±»ï¼‰ã€‚<br>é‚£ä¹ˆï¼Œ<code>MyClass</code> çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°é€šè¿‡é€ä¸ªè°ƒç”¨å…¶æˆå‘˜çš„ï¼ˆæ­£ç¡®çš„ï¼‰æ‹·è´æ“ä½œï¼Œæœ€ç»ˆä¼šäº§ç”Ÿä¸€ä¸ªä¸æºå¯¹è±¡å®Œå…¨ç‹¬ç«‹çš„æ–°å¯¹è±¡ã€‚ä¿®æ”¹æºå¯¹è±¡ä¸ä¼šå½±å“å‰¯æœ¬ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ é€šå¸¸ä¸éœ€è¦è‡ªå·±ç¼–å†™æ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°æˆ–æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼ˆè¿™å°±æ˜¯æ‰€è°“çš„ <strong>â€œRule of Zeroâ€ (é›¶æ³•åˆ™)</strong> çš„ç²¾ç¥ï¼šå¦‚æœç±»ä¸ç›´æ¥ç®¡ç†èµ„æºï¼Œå°±è®©ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p><strong>ä¾‹å­ï¼š</strong><br><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name; <span class="comment">// std::string handles its own deep copy</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; scores; <span class="comment">// std::vector handles its own deep copy</span></span><br><span class="line"></span><br><span class="line">    Student(<span class="keyword">int</span> i, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; n) : id(i), name(n) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add_score</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.push_back(score);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ID: "</span> &lt;&lt; id &lt;&lt; <span class="string">", Name: "</span> &lt;&lt; name &lt;&lt; <span class="string">", Scores: "</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> score : scores) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; score &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸éœ€è¦è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="comment">// ç¼–è¯‘å™¨ç”Ÿæˆçš„ç‰ˆæœ¬å°±è¶³å¤Ÿäº†</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Student <span class="title">s1</span><span class="params">(<span class="number">101</span>, <span class="string">"Alice"</span>)</span></span>;</span><br><span class="line">    s1.add_score(<span class="number">90</span>);</span><br><span class="line">    s1.add_score(<span class="number">85</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"s1: "</span>;</span><br><span class="line">    s1.print();</span><br><span class="line"></span><br><span class="line">    Student s2 = s1; <span class="comment">// è°ƒç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"s2 (copy of s1): "</span>;</span><br><span class="line">    s2.print();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹ s2</span></span><br><span class="line">    s2.id = <span class="number">102</span>;</span><br><span class="line">    s2.name = <span class="string">"Bob"</span>;</span><br><span class="line">    s2.add_score(<span class="number">77</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\nAfter modifying s2:"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"s1: "</span>;</span><br><span class="line">    s1.print(); <span class="comment">// s1 åº”è¯¥ä¸å—å½±å“</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"s2: "</span>;</span><br><span class="line">    s2.print();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Student</code> ç±»æ²¡æœ‰æ˜¾å¼å®šä¹‰æ‹·è´æ„é€ å‡½æ•°ã€‚å½“ä½ æ‰§è¡Œ <code>Student s2 = s1;</code> æ—¶ï¼š</p>
<ul>
<li><code>s2.id</code> ä¼šå¾—åˆ° <code>s1.id</code> çš„å€¼çš„å‰¯æœ¬ã€‚</li>
<li><code>s2.name</code> ä¼šé€šè¿‡è°ƒç”¨ <code>std::string</code> çš„æ‹·è´æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ï¼Œå¾—åˆ° <code>s1.name</code> çš„æ·±æ‹·è´ã€‚</li>
<li><code>s2.scores</code> ä¼šé€šè¿‡è°ƒç”¨ <code>std::vector&lt;int&gt;</code> çš„æ‹·è´æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ï¼Œå¾—åˆ° <code>s1.scores</code> çš„æ·±æ‹·è´ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œ<code>s1</code> å’Œ <code>s2</code> æ˜¯å®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡ã€‚</p>
<p><strong>æ€»ç»“ä¸€ä¸‹ï¼š</strong><br>â€œæ·±æ‹·è´â€è¿™ä¸ªæ¦‚å¿µä¹‹æ‰€ä»¥å¦‚æ­¤é‡è¦å’Œè¢«å¼ºè°ƒï¼Œä¸»è¦æ˜¯å› ä¸ºå½“ç±»ä¸­åŒ…å«<strong>åŸå§‹æŒ‡é’ˆ</strong>ï¼Œå¹¶ä¸”è¯¥ç±»<strong>ç›´æ¥è´Ÿè´£è¿™äº›æŒ‡é’ˆæ‰€æŒ‡å‘å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾</strong>æ—¶ï¼Œé»˜è®¤çš„æˆå‘˜é€ä¸€æ‹·è´ï¼ˆå³æµ…æ‹·è´è¿™äº›æŒ‡é’ˆï¼‰å°±ä¼šå‡ºé—®é¢˜ã€‚å¦‚æœç±»ä¸ç›´æ¥ç®¡ç†è¿™ç§åŸå§‹æŒ‡é’ˆèµ„æºï¼Œè€Œæ˜¯ä¾èµ–äºåƒ <code>std::string</code> æˆ– <code>std::vector</code> è¿™æ ·çš„â€œèµ„æºç®¡ç†ç±»â€æˆå‘˜ï¼Œé‚£ä¹ˆé€šå¸¸å°±ä¸éœ€è¦æ‹…å¿ƒæ·±æ‹·è´çš„é—®é¢˜ï¼Œå› ä¸ºè¿™äº›æˆå‘˜ç±»ä¼šè‡ªå·±å¤„ç†å¥½ã€‚</p>
<p>æ‰€ä»¥ï¼Œä½ çš„ç†è§£æ˜¯æ­£ç¡®çš„ï¼š<strong>æ²¡æœ‰ï¼ˆæ‰‹åŠ¨ç®¡ç†çš„ï¼‰æŒ‡é’ˆï¼Œé€šå¸¸é»˜è®¤å°±èƒ½å¾—åˆ°åŠŸèƒ½ä¸Šç­‰åŒäºæ·±æ‹·è´çš„ç‹¬ç«‹å‰¯æœ¬ã€‚</strong></p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cpp/">Cpp    </a><a class="post-meta__tags" href="/tags/Function/">Function    </a><a class="post-meta__tags" href="/tags/Class/">Class    </a><a class="post-meta__tags" href="/tags/Object/">Object    </a><a class="post-meta__tags" href="/tags/Programming/">Programming    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2025/06/08/10-projects/cplusplus/lectures/281%20-%20cpp%20this%20%E6%8C%87%E9%92%88%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%BA%94%E7%94%A8/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info"><span>281 - cpp this æŒ‡é’ˆè¯¦è§£ä¸åº”ç”¨</span></div></a></div><div class="next-post pull_right"><a href="/2025/06/08/10-projects/cplusplus/lectures/321%20-%20%E7%B1%BB%E5%86%85%E5%8F%98%E9%87%8F%E8%87%AA%E5%BC%95%E7%94%A8/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info"><span>321 - ç±»å†…å˜é‡è‡ªå¼•ç”¨</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/299 - æ˜¾å¼æ„é€ å‡½æ•°/" title="299 - æ˜¾å¼æ„é€ å‡½æ•°"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">299 - æ˜¾å¼æ„é€ å‡½æ•°</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/notes/Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡/" title="Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">Cpp é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹/" title="278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶/" title="283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">283 - cpp ç±»å¯¹è±¡å¤§å°æ¢ç©¶</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®/" title="286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">286 - const å¯¹è±¡é—®é¢˜ä¸æŒ‡é’ˆå¼•ç”¨è®¿é—®</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/287 - const å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°çš„æ³¨æ„äº‹é¡¹/" title="287 - const å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°çš„æ³¨æ„äº‹é¡¹"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">287 - const å¯¹è±¡ä½œä¸ºå‡½æ•°å‚æ•°çš„æ³¨æ„äº‹é¡¹</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> è¯„è®º</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xvMxbws16Erd8WUfqxkvHmb5-gzGzoHsz',
  appKey:'4U0Vo7NQIUL0eJzHdkPzdCDr',
  placeholder:'ä¸è¯´è¯çš„äººä¼šç–¯æ‰å—?',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By supersheepbear</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="external nofollow noopener noreferrer"><span>Butterfly</span></a></div><div class="footer_custom_text">å¤–å‘å­¤ç‹¬è€…æ‚£è€…</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script id="canvas_nest" color="255,240,245" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>