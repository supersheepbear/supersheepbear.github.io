<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾ | Bear's dream</title><meta name="description" content="279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><meta name="keywords" content="Cpp,Coding,Tutorial,Development,Memory"><meta name="author" content="supersheepbear"><meta name="copyright" content="supersheepbear"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon_1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="p43hXBn3_dLvbyxUzx0eo5eYmj9OVYOV52pdrhBa2sw"><meta name="baidu-site-verification" content="EXLlfLv2pV"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><meta name="twitter:description" content="279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta property="og:type" content="article"><meta property="og:title" content="279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><meta property="og:url" content="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/279%20-%20cpp%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%EF%BC%9A%E5%AF%B9%E8%B1%A1%E9%94%80%E6%AF%81%E6%97%B6%E7%9A%84%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE/"><meta property="og:site_name" content="Bear's dream"><meta property="og:description" content="279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/279%20-%20cpp%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%EF%BC%9A%E5%AF%B9%E8%B1%A1%E9%94%80%E6%AF%81%E6%97%B6%E7%9A%84%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE/"><link rel="prev" title="282 - cppç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«å’Œç”¨æ³•" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/282%20-%20cpp%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%8E%E7%B1%BB%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E7%94%A8%E6%B3%95/"><link rel="next" title="278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹" href="https://yxiong.org/2025/06/08/10-projects/cplusplus/lectures/278%20-%20cpp%20%E6%8C%87%E9%92%88%E7%AE%A1%E7%90%86%E7%B1%BB%E5%AF%B9%E8%B1%A1%E7%A4%BA%E4%BE%8B/"><link rel="stylesheet" href="hfttps://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Bear's dream" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Bear's dream</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> æœç´¢</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200520153141.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">178</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">160</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">23</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> éŸ³ä¹ç…§ç‰‡</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> ç…§ç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å­¦ä¹ è®¡åˆ’</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">ç›®å½•</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">C++ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">C++ ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ğŸ¤–-Assistant-1"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">ğŸ¤– Assistant</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><span class="toc-number">1.</span> <span class="toc-text">C++ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«"><span class="toc-number">2.</span> <span class="toc-text">C++ ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ§‘â€ğŸ’»-User-1"><span class="toc-number">2.1.</span> <span class="toc-text">ğŸ§‘â€ğŸ’» User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ¤–-Assistant-1"><span class="toc-number">2.2.</span> <span class="toc-text">ğŸ¤– Assistant</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)"><div id="post-info"><div id="post-title"><div class="posttitle">279 - cppææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> å‘è¡¨äº 2025-06-08<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> æ›´æ–°äº 2025-06-08</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/">10-projects</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/">cplusplus</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/10-projects/cplusplus/lectures/">lectures</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>è¯„è®ºæ•°:</span><a href="/2025/06/08/10-projects/cplusplus/lectures/279%20-%20cpp%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%EF%BC%9A%E5%AF%B9%E8%B1%A1%E9%94%80%E6%AF%81%E6%97%B6%E7%9A%84%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2025/06/08/10-projects/cplusplus/lectures/279%20-%20cpp%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%EF%BC%9A%E5%AF%B9%E8%B1%A1%E9%94%80%E6%AF%81%E6%97%B6%E7%9A%84%E5%86%85%E5%AD%98%E9%87%8A%E6%94%BE/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="C-ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"><a href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾" class="headerlink" title="C++ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾"></a>C++ææ„å‡½æ•°ï¼šå¯¹è±¡é”€æ¯æ—¶çš„å†…å­˜é‡Šæ”¾</h1><h2 id="ğŸ§‘â€ğŸ’»-User"><a href="#ğŸ§‘â€ğŸ’»-User" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><p>In this lecture, weâ€™re going to learn about the structures.The structures are spatial functions or methods in a class that are called by the compiler to destroyyour object.And these are going to be especially useful if you are, for example, allocating memory in your constructors.Letâ€™s look at a simple example Here we have a class called Dog.It has two sections the public section and the private section.In the public section we have two constructors, a default constructor that doesnâ€™t take any parameterand a constructor that takes two parameters and the parameters are going to be used to initialize ourmember variables and they are passed by value here for simplicity.And they are going to be used to initialize these member variables dog name, dog breed and dog age.The special thing about this class is that it has a destructor and you declare the destructor usingthis syntax here.It puts a tilde character in front.You say the name of the class and then you put an empty parameter list.It is also possible to declare a destructor and put in its entire body in the header.And this is the syntax to do this inside the body, youâ€™re going to do whatever it is you need to destroyyour object.For example, if the class here is allocating some memory in the constructor, the destructor is thebest place to release that.And this is an example of how you can do that.Here is a more direct example of how we allocate for dynamic memory in the constructor and release thatmemory in the destructor.We have our three variables, but we have chosen to allocate our dog age variable on the heap usingdynamic memory allocation.And after we dynamically allocate a piece of memory to store our age variable, weâ€™re going to set thatto zero because we are in a constructor.If we are using the three parameter constructor here, we might use the past parameter to initializeour age variable.But the important thing here is that it is being dynamically allocated memory on the heap here.And when our object dies, we need to remember to release that memory and the destructor is the bestplace to release that memory.As you see here, we say delete dog age when our object dies and the compiler is going to call thisfunction when itâ€™s about to kill the object.So you might ask, when are Destructors really called?We are going to start by looking at obvious cases here.For example, when a local stack object goes out of scope, the destructor is going to be called becausethat object is going to be wiped out from memory.So this is an obvious case in which the compiler will need to call a destructor.Also, when a heap object is released from memory using delete, the destructor is also going to becalled.But there are some indirect ways in which the structures are also called.For example, when an object is passed by value to a function, this is going to call the destructorto kill the object when the object goes out of scope in the function.Because when an object is passed by value, weâ€™re going to have a copy in the local scope of the function.And when the function exits, that local copy is going to be killed.And weâ€™re going to see an example of that.Another case where you might have the structure called is when a local object is returned from a function,another copy is going to be created to be used outside the function and the copy inside the functionis going to be killed.But this is not guaranteed as some compiler may optimize your return value and use some kind of referenceso youâ€™re not guaranteed to see this behavior, but it is possible to see it now that you have an ideaabout Destructors, itâ€™s time we headed over to Visual Studio Code and play with us a little more.Okay, here we are in our working folder.The current project is Destructors.Weâ€™re going to grab our template files pretty quick and weâ€™re going to put them in place.And after that weâ€™re going to open our folder in Visual Studio code.By dragging and dropping here, this is going to open our folder and we will see our main CPP file here.We can open it and a clean up and remove what we donâ€™t need.We have an unneeded breakpoint here.We can remove that and weâ€™re going to clean up the main function.The first thing we want to do is to put in our dog class.I am going to just put this in here because I donâ€™t want you to watch me type all this.Thatâ€™s just going to waste your time.We have two sections in the dog class.We have a public section which is going to now contain our constructors and we have a private sectionwhich is going to contain three member variables.We have two strings, one for.The name and the other for the breed of dog.And we have another one which is an int pointer, which is going to store the age of the dog and yousee that this is initialized to null pointer.One thing you should notice is that for our parameter taking constructor, we are passing the stringinformation here using string views to avoid copies with the STD string view type.You already know this because we learnt about this, but for this to work we will need to include thestring view.So letâ€™s do that.And now we have our class and we can use it however we want.So but before we do, we need to put in the implementations for this functions.One way we can do that is do that directly in the function here, but I want you to see that you canalso do that directly outside the class here.I donâ€™t think I have shown you this, but it is possible to do that.So weâ€™re going to grab the prototype for our constructor and say the scope resolution operator and weâ€™regoing to just paste in what we have copied, which is the prototype here, and weâ€™re going to go inside,put in our body and in the body weâ€™re going to initialize these three guys.So the name is going to be initialized to name Param and the breed is going to be initialized to breedparam.We can do that and the age is going to be dynamically allocated from the heap.You see that it is a pointer.So weâ€™re going to say p equals new and because weâ€™re going to allocate dynamic space to store an INTand weâ€™re going to put data in using our good old dereference operator, weâ€™re going to say P equalswhatever page parameter that you passed.And I think we should say age here because itâ€™s not a pointer.So weâ€™re going to say age.I think this is going to do better.H Param This is probably going to be better and weâ€™re going to say age param.Okay, so now we have our constructor and, and itâ€™s going to allocate memory from the heap and weâ€™regoing to put data in that new memory location that has just been allocated to our class here.So this is our class and we can go in the main function and really use it however we want.For example, we can set up a dog object, so weâ€™re going to say my dog and weâ€™re going to give it aname.The name is going to be fluffy and weâ€™re going to put the breed in and itâ€™s going to just be a shepherdand weâ€™re going to put in the age, which is going to be, for example, a two letâ€™s say our dog istwo years old.This is a valid C plus plus code.Itâ€™s going to be setting up an object of our class here and we can build to see that this program isgoing to build without a problem.So both is good.But if we run the program, weâ€™re not going to see anything.But we donâ€™t really need to see our constructor here called because we already know about constructors.What we want to learn about are Destructors, and these are special methods that are called by the compiler.When your object dies.Letâ€™s set up a destructor and see it called When Our Dog Objects Die.The syntax to do that is to use the tilde character here.Youâ€™re going to say the name of the class.Youâ€™re going to put an empty parameter list.And if you want, you can put a body and do whatever you want to do in the body of your destructor here.But again, weâ€™re going to move the entire definition of the destructor to the outside.So letâ€™s go down and save that.Weâ€™re going to say the scope resolution operator.Weâ€™re going to say dog and weâ€™re going to put in our body.And the first thing we want to do in our destructor is to release this memory that was dynamically allocatedfor us.If we donâ€™t release it when this dog object dies, weâ€™re going to leak memory.And thatâ€™s really bad.So letâ€™s do that directly in the destructor.We can say delete and say page.This is going to release the memory that was allocated in the constructor here.And we have access to this page variable because of the destructor is part of our class.Any member function of your class is going to have access to any member variable, even if it happensto be private.Okay, so we forgot our tilde character.Letâ€™s put that in here and this is going to be valid C plus plus code.But to really see things happening here, letâ€™s put in an Stdcout statement.Weâ€™re going to say dog destructor called for and weâ€™re going to say the name of the dog, letâ€™s sayname, and weâ€™re going to say the same thing in the constructor.Weâ€™re going to say Stdcout and say dog constructor called for and weâ€™re going to say the dog name goingto use our member variable.And now we have our thing in place.We have the destructor declared in the class definition, and this is the syntax again, this is whatwe really want to learn about in this lecture.We have the tilde character, we have the class name and we put an empty parameter list.Let me tell you that it is not possible to pass parameters to your destructor.If you do that, youâ€™re going to get a compiler error.Destructors were always have no parameters in C plus plus.Here we have the definition of our destructor and it is going to release whatever memory we have dynamicallyallocated from the constructor here.If we run this program, weâ€™re going to see our constructor called as a result of this line here, becausewe are constructing a dog object and weâ€™re going to see the destructor called when the main functionis about to end.Letâ€™s put an stdcout statement to the main function here and say done.Just to prove that we have hit the end of our main function here.I think this is useful and weâ€™re going to build.So letâ€™s do that.Weâ€™re going to build with GCC.Youâ€™re going to see that the build is good so we can clear and run our program.Letâ€™s hit enter here and clear and run, Rooster.Youâ€™re going to see that the constructor was called.We are going to say done when the main function is about to end.But before the main function ends, weâ€™re going to destroy any stack data that we have in the main functionand our dog object is on the stack.So itâ€™s going to be destroyed as part of that process.And the destructor for dog is going to be called and weâ€™re going to release our memory and weâ€™re goingto say that dog destructor was called for whatever name we have assigned to our dog here.So this is how Destructors are called when your objects are killed.And we didnâ€™t put in the correct name, we said Fluffly, letâ€™s say Fluffy, because thatâ€™s what I wanted.And now you see that our destructor is really being called and releasing memory however we want.But we can also go a little further and show you another example of a case where Destructors are calledand weâ€™re going to look at a function that sets up a local object of a dog.Weâ€™re going to see the dog constructor and weâ€™re going to see it destroyed when the function is aboutto end.Letâ€™s do that.Weâ€™re going to say void Somefunc and itâ€™s going to be just some function to play with us.Weâ€™re going to move our dog declaration and some func here and this is really it.Weâ€™re going to call this function and when we call it, weâ€™re going to construct the object here.When the function is about to end, the compiler is going to call the destructor because itâ€™s goingto destroy this object here.And weâ€™re going to see the destructor called.By that point, the somefunc function is going to be popped off the top of the stack.Weâ€™re going to hit the main function here and weâ€™re going to say done.And the program is going to end.Letâ€™s call some function main here.So weâ€™re going to say some func and weâ€™re going to world to really see this happening.So we have built successfully, we can clear, clear properly and run Rooster weâ€™re going to see constructorcalled for Fluffy destructor called for fluffy and you see done.We have hit the main function and we finished executing our program here.We can even see this through the debugger.Weâ€™re going to set up three break points.One in the main function here before we call the Somefunc function, weâ€™re going to set up another onein our destructor before we print the message here.And weâ€™re going to put another one in the constructor when we are about to print this message here online 20.After we set up these break points, we can kill the terminal here and minimize a little bit.Letâ€™s kill these things here so that we have a clean we have a lot of windows here.Okay.We have our editor here.And now if we go to the tab here that says start or run, weâ€™re going to be able to click the greenbutton here to start our debugging session.We are going to have our terminal here.So letâ€™s bring that to the side so that we can see things printed out nicely.Letâ€™s do like this.And now we have hit the breakpoint.In the main function we can step into the somefunc function and weâ€™re going to do that using the stampingtwo button here.Letâ€™s click that.Weâ€™re going to jump into some func.Now we have the option to step into, but this is going to jump us into the logic of transforming thestring literal here into a string view.Because if you see the constructor is going to take string view parameters, we can actually see this.Letâ€™s try and hit the step into button.You see that we are in the string view class and we donâ€™t really want this.So letâ€™s step out and weâ€™re going to step over this so that we can hit the next breakpoint.And you see, the next breakpoint is in our constructor.And this proves that the compiler is going to call our constructor here to build our object.If we step over this, weâ€™re going to print the message from the constructor.And if we.We keep going, weâ€™re going to get out of our constructor and you see where this is going to go.This is going to go in the destructor because before we leave the Somefunc function, our data objectis going to be destroyed.So weâ€™re going to release our memory and weâ€™re going to print the message from our constructor.And if we hit next and step out of this, I think we can do that because this is logic we donâ€™t want.Weâ€™re going to try and step over this.And now if we hit next, weâ€™re going to come back in some func and some func is already going to befinished.And if we hit next, weâ€™re going to come back in main and weâ€™re going to print done and the programis basically going to be done.Hopefully you can see that the compiler is going to call our destructor after it leaves some func herebecause itâ€™s going to be destroying the local object that we have inside some func here.So this is one case where the destructor is going to be called by the compiler and it is if you havea local object that needs to be destroyed when function scope finishes.Another case where the destructor may be called is if you pass a class object parameter by value.So letâ€™s change some func here and make it take something by value.So weâ€™re going to pass a dog inside and weâ€™re going to say dog param, this is going to do okay.Now that we have changed some func here, we can really do all kinds of crazy things with it.For example, we can set up our dog object inside our main function here.So letâ€™s do that.We can say dog and dog.The variable name is going to be dog.We can give it a name which is going to be fluffy, itâ€™s going to have a breed of shepherd and we cangive it the age of two like we have been doing all along.We can call our function with the dog object here, but be careful about what is going to happen herewhen we do something like this, weâ€™re going to be passing by value and the compiler is going to seethat it needs to copy a dog object.Now, we havenâ€™t really told our class here how to copy dog objects, and we do that through constructorswe call copy constructors we havenâ€™t really learnt about yet.But what the compiler is going to do by default is copy these things, member by member.So itâ€™s going to set up a dog copy object which is going to be initialized with empty strings and anull pointer here.And then itâ€™s going to copy from our dog object that we have here.Itâ€™s going to take the name and copy that in the name member variable of our dog copy.Itâ€™s going to take the breed and copy that in in the second member variable here.And itâ€™s going to take the age from our dog and copy that in.The problem is going to come to this pointer here.Itâ€™s going to copy the address and itâ€™s not going to copy what is pointed to.And this is going to be a recipe for disaster.I donâ€™t really want to go through this right now, but if we try to run this program, itâ€™s not goingto work like we expect.For example, if we pass Fluffy here, weâ€™re going to see things that we donâ€™t expect.So letâ€™s try to build.Weâ€™re going to build with GCC and the build is good.So what we expect is to have the constructor of Fluffy here called and weâ€™re going to copy the dog objectfor use in Somefunc here.And to set up this copy, itâ€™s not this constructor here that is going to be called, so itâ€™s not ourconstructor here, which is going to be called.So weâ€™re not going to see this called for the copy that we set up inside Somefunc.Another thing is because now these two dog objects are pointing to the same thing because what we justcopied is the address as we see in our member variable here, the two dog objects are going to be pointingto the same thing in memory.And when we hit the destructor, weâ€™re going to call delete twice.And this is going to be a recipe for disaster.Our application could really crash.You already know that deleting a pointer twice is really bad.We shouldnâ€™t do this and we are doing this here because we are copying.I realize this is a slightly confusing example, but what I want you to know is that if you pass a classobject by value like this, the copy you have inside is going to code for the destructor to be calledwhen the function exits because the copy is going to be scoped inside the function here.So letâ€™s take out this example because it really is confusing, but I hope you note that and I am goingto show you that in other case, where you might see the destructor called is when you call the destructorexplicitly using the delete operator on your object so we can set up some func again, letâ€™s do thatsome func and weâ€™re going to repurpose it.And this side weâ€™re going to set up a dog object.So letâ€™s grab this and.And we use that in our function here and weâ€™re going to say dog pointer.So letâ€™s say dog pointer, weâ€™re going to say P dog P underscore dog.Itâ€™s going to be equals to new dog and weâ€™re going to pass in what we need to initialize our dog objectwith.This is going to create a dog object on the heap and it is going to be pointed to by p dog here.Now, I want you to see that if we donâ€™t explicitly release the memory that we allocate through thenew operator, weâ€™re going to leak memory.So we created an object on the heap here, but weâ€™re not deleting that in some func.When some func exits, weâ€™re going to lose this pointer, this variable because it is on the stack itselfand we wonâ€™t have any way to release this memory.Letâ€™s call some func here and really show you this.So weâ€™re going to call some func and weâ€™re going to build.Letâ€™s use GCC for that.The build is good.We can bring this up a little bit and clear and run Rooster.Weâ€™re going to see that the constructor for Fluffy was called because of this new operator, but wedidnâ€™t see the destructor called and this is really bad.So for the destructor to be called, we need to explicitly release the memory in this function here.And we do that by using the delete keyword and saying the pointer that is pointing to the memory thatwe want to release.If we do this, this is going to cause for the destructor of dog to be called.And if we run, weâ€™re going to see our destructor called.Letâ€™s do that.Weâ€™re going to use GCC.The build is good.We can clear and run Rooster.Now you see that the constructor is called Full of Fluffy and we have the destructor called.This is really all I wanted to share with you in this lecture.I apologize if you found it confusing, but if you have any problem, I am always available.Please do ask and I will do the best I can to help you out.So the destructor is a special method which is going to be called when your object Dies.It is going to be called when an object is passed by value to a function.We have seen an example of that.Itâ€™s going to be called when a local object is returned from a function by value.But this is going to be compiler dependent because some compilers are going to optimize this out andmake it look like we returned by reference.So I donâ€™t want to go into this because this is subject to compiler optimization, but other cases whereyouâ€™re going to have your destructor called is when a local stack object goes out of scope and whena heap object is deleted through the delete keyword.This is really all I had to share in this lecture.I hope you found it interesting.We are going to stop here in this one and the next one weâ€™re going to see the order in which constructorsand destructors are called and you really need to be aware of this.Go ahead and finish up here and meet me there.</p>
<hr>
<h2 id="ğŸ¤–-Assistant"><a href="#ğŸ¤–-Assistant" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>å¥½çš„ï¼ŒåŒå­¦ä½ å¥½ï¼éå¸¸å¼€å¿ƒèƒ½ä½œä¸ºä½ çš„C++å‘å¯¼ã€‚ä»Šå¤©æˆ‘ä»¬è¦å­¦ä¹ C++ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µâ€”â€”ææ„å‡½æ•°ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šä¸€æ­¥ä¸€æ­¥å¸¦ä½ äº†è§£å®ƒã€‚</p>
<h1 id="C-ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«"><a href="#C-ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«" class="headerlink" title="C++ ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«"></a>C++ ææ„å‡½æ•°ï¼šå¯¹è±¡çš„ä¼˜é›…å‘Šåˆ«</h1><p><strong>ç®€è¦æ€»ç»“ï¼š</strong><br>ææ„å‡½æ•° (Destructor) æ˜¯ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šæˆå‘˜å‡½æ•°ã€‚å®ƒçš„ä¸»è¦ä»»åŠ¡æ˜¯åœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚é‡Šæ”¾å¯¹è±¡åœ¨æ„é€ æ—¶åŠ¨æ€åˆ†é…çš„å†…å­˜ (dynamic memory allocation)ã€‚ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ã€‚</p>
<hr>
<p><strong>è¯¦ç»†è§£é‡Šï¼š</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å¼€äº†ä¸€å®¶ç©å…·åº—ã€‚</p>
<ul>
<li><strong>æ„é€ å‡½æ•° (Constructor)</strong>ï¼šå°±åƒä½ è¿›è´§å¹¶æŠŠç©å…·æ‘†ä¸Šè´§æ¶çš„è¿‡ç¨‹ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°è´Ÿè´£åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚ç»™å®ƒçš„æˆå‘˜å˜é‡èµ‹å€¼ï¼Œæˆ–è€…ä¸ºå®ƒç”³è¯·ä¸€äº›èµ„æºï¼ˆæ¯”å¦‚å†…å­˜ï¼‰ã€‚</li>
<li><strong>ææ„å‡½æ•° (Destructor)</strong>ï¼šå°±åƒä½ å…³åº—å‰ï¼Œéœ€è¦æŠŠæ²¡å–æ‰çš„ã€ç§Ÿæ¥çš„å±•ç¤ºæ¶è¿˜å›å»ï¼Œæ‰“æ‰«å«ç”Ÿç­‰ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼ˆæ¯”å¦‚å®ƒç¦»å¼€äº†è‡ªå·±çš„ä½œç”¨åŸŸ (scope)ï¼Œæˆ–è€…è¢«æ˜¾å¼åˆ é™¤ï¼‰ï¼Œææ„å‡½æ•°å°±ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œæ¥æ‰§è¡Œä¸€äº›â€œå–„åâ€å·¥ä½œã€‚</li>
</ul>
<p><strong>1. ä¸ºä»€ä¹ˆéœ€è¦ææ„å‡½æ•°ï¼Ÿ</strong></p>
<p>æœ€å¸¸è§çš„åœºæ™¯æ˜¯ç®¡ç†åŠ¨æ€åˆ†é…çš„èµ„æºã€‚å¦‚æœåœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨äº† <code>new</code>å…³é”®å­—åœ¨å † (heap) ä¸Šä¸ºå¯¹è±¡åˆ†é…äº†å†…å­˜ï¼Œé‚£ä¹ˆåœ¨å¯¹è±¡é”€æ¯æ—¶ï¼Œä½ å°±éœ€è¦åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨ <code>delete</code> å…³é”®å­—æ¥é‡Šæ”¾è¿™å—å†…å­˜ã€‚å¦‚æœä¸è¿™ä¹ˆåšï¼Œè¿™å—å†…å­˜å°±ä¼šä¸€ç›´è¢«å ç”¨ï¼Œæ— æ³•è¢«å…¶ä»–ç¨‹åºä½¿ç”¨ï¼Œé€ æˆ<strong>å†…å­˜æ³„æ¼ (memory leak)</strong>â€”â€”è¿™å°±åƒä½ å€Ÿäº†ä¹¦ä¸è¿˜ï¼Œå›¾ä¹¦é¦†çš„ä¹¦è¶Šæ¥è¶Šå°‘ä¸€æ ·ï¼Œæœ€ç»ˆä¼šå¯¼è‡´ç¨‹åºå› å†…å­˜è€—å°½è€Œå´©æºƒã€‚</p>
<p><strong>2. ææ„å‡½æ•°çš„è¯­æ³•</strong></p>
<p>ææ„å‡½æ•°çš„å£°æ˜éå¸¸ç‰¹æ®Šï¼š</p>
<ul>
<li>å®ƒæ²¡æœ‰è¿”å›ç±»å‹ï¼ˆè¿ <code>void</code> éƒ½ä¸å†™ï¼‰ã€‚</li>
<li>å®ƒçš„åå­—å¿…é¡»æ˜¯ç±»åçš„å‰é¢åŠ ä¸Šä¸€ä¸ªæ³¢æµªå· <code>~</code>ã€‚</li>
<li>å®ƒä¸èƒ½æœ‰ä»»ä½•å‚æ•°ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ç±»åæ˜¯ <code>Dog</code>ï¼Œé‚£ä¹ˆææ„å‡½æ•°å°±æ˜¯ <code>~Dog()</code>ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Dog() &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    Dog(<span class="built_in">std</span>::<span class="built_in">string</span> name, <span class="keyword">int</span> age) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°å£°æ˜</span></span><br><span class="line">    ~Dog(); <span class="comment">// è¿™å°±æ˜¯ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> dogName;</span><br><span class="line">    <span class="keyword">int</span>* dogAge; <span class="comment">// å‡è®¾å¹´é¾„ç”¨æŒ‡é’ˆåŠ¨æ€åˆ†é…</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®šä¹‰ï¼ˆå¯ä»¥åœ¨ç±»å¤–ï¼‰</span></span><br><span class="line">Dog::~Dog() &#123;</span><br><span class="line">    <span class="comment">// æ¸…ç†å·¥ä½œçš„ä»£ç ï¼Œæ¯”å¦‚é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Dog "</span> &lt;&lt; dogName &lt;&lt; <span class="string">" is being destroyed."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span> dogAge; <span class="comment">// é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">    dogAge = <span class="literal">nullptr</span>; <span class="comment">// å¥½ä¹ æƒ¯ï¼šæŒ‡é’ˆç½®ç©ºï¼Œé˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>3. ææ„å‡½æ•°ä½•æ—¶è¢«è°ƒç”¨ï¼Ÿ</strong></p>
<p>ç¼–è¯‘å™¨ä¼šåœ¨ä»¥ä¸‹å‡ ç§ä¸»è¦æƒ…å†µä¸‹è‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼š</p>
<ul>
<li><p><strong>æ ˆ (Stack) å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»“æŸ</strong>ï¼šå½“ä¸€ä¸ªåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å¯¹è±¡ï¼ˆæ ˆå¯¹è±¡ï¼‰ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ï¼ˆä¾‹å¦‚ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œå®ƒçš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Dog <span class="title">myDog</span><span class="params">(<span class="string">"Buddy"</span>, <span class="number">3</span>)</span></span>; <span class="comment">// myDog æ˜¯ä¸€ä¸ªæ ˆå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// ... myDog åœ¨è¿™é‡Œè¢«ä½¿ç”¨ ...</span></span><br><span class="line">&#125; <span class="comment">// å½“myFunctionç»“æŸæ—¶ï¼ŒmyDogçš„ææ„å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p><strong>å † (Heap) å¯¹è±¡è¢« <code>delete</code> æ“ä½œç¬¦ (delete operator) åˆ é™¤æ—¶</strong>ï¼šå½“ä½ ä½¿ç”¨ <code>new</code> åˆ›å»ºä¸€ä¸ªå †å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ <code>delete</code> åˆ é™¤å®ƒæ—¶ï¼Œè¯¥å¯¹è±¡çš„ææ„å‡½æ•°ä¼šåœ¨å†…å­˜è¢«é‡Šæ”¾å‰è°ƒç”¨ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dog* pDog = <span class="keyword">new</span> Dog(<span class="string">"Charlie"</span>, <span class="number">5</span>); <span class="comment">// pDog æŒ‡å‘ä¸€ä¸ªå †å¯¹è±¡</span></span><br><span class="line">    <span class="comment">// ... pDog åœ¨è¿™é‡Œè¢«ä½¿ç”¨ ...</span></span><br><span class="line">    <span class="keyword">delete</span> pDog; <span class="comment">// é¦–å…ˆè°ƒç”¨pDogæŒ‡å‘å¯¹è±¡çš„ææ„å‡½æ•°ï¼Œç„¶åé‡Šæ”¾å†…å­˜</span></span><br><span class="line">    pDog = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>é‡è¦</strong>ï¼šå¦‚æœä½  <code>new</code> äº†ä¸€ä¸ªå¯¹è±¡ä½†å¿˜è®° <code>delete</code>ï¼Œææ„å‡½æ•°å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œèµ„æºï¼ˆå¦‚å†…å­˜ï¼‰ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ï¼Œä»è€Œå¯¼è‡´èµ„æºæ³„æ¼ã€‚</p>
</li>
<li><p><strong>å¯¹è±¡æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°æ—¶ï¼ˆå‰¯æœ¬çš„é”€æ¯ï¼‰</strong>ï¼š<br>å½“ä¸€ä¸ªå¯¹è±¡æŒ‰å€¼ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºè¯¥å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚å½“å‡½æ•°ç»“æŸæ—¶ï¼Œè¿™ä¸ªå‰¯æœ¬çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå°±ç»“æŸäº†ï¼Œå®ƒçš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processDog</span><span class="params">(Dog d)</span> </span>&#123; <span class="comment">// d æ˜¯ aDog çš„ä¸€ä¸ªå‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Processing dog in function..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125; <span class="comment">// å½“ processDog ç»“æŸæ—¶ï¼Œå‰¯æœ¬ d çš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Dog <span class="title">aDog</span><span class="params">(<span class="string">"Rex"</span>, <span class="number">2</span>)</span></span>;</span><br><span class="line">    processDog(aDog); <span class="comment">// aDog è¢«æŒ‰å€¼ä¼ é€’ï¼Œåˆ›å»ºå‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Back in main."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// aDog çš„ææ„å‡½æ•°åœ¨è¿™é‡Œè¢«è°ƒç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><em>æ³¨æ„</em>ï¼šæŒ‰å€¼ä¼ é€’å¯¹è±¡ï¼Œå°¤å…¶æ˜¯åŒ…å«åŠ¨æ€åˆ†é…å†…å­˜ä¸”æ²¡æœ‰æ­£ç¡®å®šä¹‰æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦çš„ç±»å¯¹è±¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼ˆæ¯”å¦‚æµ…æ‹·è´ (shallow copy) å¯¼è‡´çš„åŒé‡é‡Šæ”¾ (double free)ï¼‰ï¼Œæˆ‘ä»¬ä¹‹åä¼šå­¦åˆ°å¦‚ä½•æ­£ç¡®å¤„ç†è¿™ç§æƒ…å†µï¼ˆé€šå¸¸æ¶‰åŠâ€œä¸‰/äº”æ³•åˆ™â€ï¼‰ã€‚</p>
</li>
<li><p><strong>ä»å‡½æ•°æŒ‰å€¼è¿”å›å±€éƒ¨å¯¹è±¡æ—¶ï¼ˆä¸´æ—¶å‰¯æœ¬çš„é”€æ¯ï¼Œå¯èƒ½è¢«ä¼˜åŒ–ï¼‰</strong>ï¼š<br>å½“å‡½æ•°è¿”å›ä¸€ä¸ªå±€éƒ¨å¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å¯¹è±¡ç”¨äºè¿”å›å€¼ã€‚è¿™ä¸ªä¸´æ—¶å¯¹è±¡çš„ææ„å‡½æ•°åœ¨å…¶ä¸å†éœ€è¦æ—¶ä¼šè¢«è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œç°ä»£ç¼–è¯‘å™¨é€šå¸¸ä¼šè¿›è¡Œè¿”å›å€¼ä¼˜åŒ– (Return Value Optimization, RVO) æˆ–å‘½åè¿”å›å€¼ä¼˜åŒ– (Named Return Value Optimization, NRVO)ï¼Œè¿™å¯èƒ½ä¼šæ¶ˆé™¤ä¸´æ—¶å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¸ä¼šæ€»æ˜¯è§‚å¯Ÿåˆ°è¿™ç§è¡Œä¸ºã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Dog <span class="title">createDog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Dog <span class="title">tempDog</span><span class="params">(<span class="string">"Lucy"</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> tempDog; <span class="comment">// è¿”å›ä¸€ä¸ªå±€éƒ¨å¯¹è±¡</span></span><br><span class="line">&#125; <span class="comment">// tempDog çš„ææ„å‡½æ•°é€šå¸¸åœ¨è¿™é‡Œè¢«è°ƒç”¨ï¼Œä½†RVOå¯èƒ½æ”¹å˜è¡Œä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Dog mainDog = createDog();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</li>
</ul>
<p><strong>4. ææ„å‡½æ•°çš„å®ç°ç»†èŠ‚</strong></p>
<ul>
<li><strong>å®šä¹‰ä½ç½®</strong>ï¼šææ„å‡½æ•°å¯ä»¥åœ¨ç±»å®šä¹‰å†…éƒ¨ç›´æ¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨ç±»å¤–å®šä¹‰ï¼ˆåƒä¸Šé¢çš„ <code>Dog::~Dog()</code> ä¾‹å­ï¼‰ã€‚</li>
<li><strong>æ— å‚æ•°</strong>ï¼šææ„å‡½æ•°ç»å¯¹ä¸èƒ½æœ‰å‚æ•°ã€‚å¦‚æœä½ å°è¯•ç»™å®ƒå‚æ•°ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</li>
<li><strong>éšå¼ææ„å‡½æ•°</strong>ï¼šå¦‚æœä½ æ²¡æœ‰ä¸ºç±»æ˜¾å¼å®šä¹‰ææ„å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„ææ„å‡½æ•°ã€‚è¿™ä¸ªé»˜è®¤ææ„å‡½æ•°é€šå¸¸ä»€ä¹ˆä¹Ÿä¸åšï¼Œé™¤éç±»æˆå‘˜æœ¬èº«æ˜¯å…¶ä»–ç±»çš„å¯¹è±¡ä¸”é‚£äº›ç±»æœ‰è‡ªå·±çš„ææ„å‡½æ•°ï¼ˆè¿™ç§æƒ…å†µä¸‹ï¼Œé»˜è®¤ææ„å‡½æ•°ä¼šè°ƒç”¨æˆå‘˜å¯¹è±¡çš„ææ„å‡½æ•°ï¼‰ã€‚å¯¹äºåŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œé»˜è®¤ææ„å‡½æ•°ä¸ä¼šåšä»»ä½•é‡Šæ”¾æ“ä½œã€‚</li>
</ul>
<hr>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œæ¼”ç¤ºæ„é€ å‡½æ•°å’Œææ„å‡½æ•°å¦‚ä½•é…åˆå·¥ä½œæ¥ç®¡ç†åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¯¾ç¨‹ä¸­æåˆ°çš„ <code>Dog</code> ç±»ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string_view&gt; // ä¸ºäº†é«˜æ•ˆä¼ é€’å­—ç¬¦ä¸²å‚æ•°</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Dog ç±»å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> dog_name_;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> dog_breed_;</span><br><span class="line">    <span class="keyword">int</span>* p_dog_age_; <span class="comment">// æŒ‡é’ˆ (pointer)ï¼Œç”¨äºåŠ¨æ€åˆ†é…å¹´é¾„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•° (constructor) 1: é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    Dog() : dog_name_(<span class="string">"Nameless"</span>), dog_breed_(<span class="string">"Unknown"</span>) &#123;</span><br><span class="line">        p_dog_age_ = <span class="keyword">new</span> <span class="keyword">int</span>; <span class="comment">// åœ¨å †ä¸Šåˆ†é…ä¸€ä¸ªintå¤§å°çš„å†…å­˜</span></span><br><span class="line">        *p_dog_age_ = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"é»˜è®¤æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œä¸ºå°ç‹— "</span> &lt;&lt; dog_name_ &lt;&lt; <span class="string">" åˆ†é…äº†å¹´é¾„å†…å­˜ã€‚"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•° (constructor) 2: å¸¦å‚æ•°</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::string_view é¿å…ä¸å¿…è¦çš„ std::string æ‹·è´</span></span><br><span class="line">    Dog(<span class="built_in">std</span>::string_view name_param, <span class="built_in">std</span>::string_view breed_param, <span class="keyword">int</span> age_param)</span><br><span class="line">        : dog_name_(name_param), dog_breed_(breed_param) &#123;</span><br><span class="line">        p_dog_age_ = <span class="keyword">new</span> <span class="keyword">int</span>;       <span class="comment">// åœ¨å † (heap) ä¸Šä¸ºå¹´é¾„åŠ¨æ€åˆ†é…å†…å­˜</span></span><br><span class="line">        *p_dog_age_ = age_param;    <span class="comment">// å°†ä¼ å…¥çš„å¹´é¾„å€¼å­˜å…¥æ–°åˆ†é…çš„å†…å­˜ä¸­</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"å‚æ•°åŒ–æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œä¸ºå°ç‹— "</span> &lt;&lt; dog_name_ &lt;&lt; <span class="string">" (å¹´é¾„: "</span> &lt;&lt; *p_dog_age_ &lt;&lt; <span class="string">") åˆ†é…äº†å¹´é¾„å†…å­˜ã€‚"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•° (destructor)</span></span><br><span class="line">    ~Dog() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ææ„å‡½æ•°è¢«è°ƒç”¨ï¼Œå‡†å¤‡ä¸ºå°ç‹— "</span> &lt;&lt; dog_name_ &lt;&lt; <span class="string">" é‡Šæ”¾å¹´é¾„å†…å­˜ã€‚"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">delete</span> p_dog_age_;      <span class="comment">// é‡Šæ”¾æ„é€ å‡½æ•°ä¸­åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">        p_dog_age_ = <span class="literal">nullptr</span>;   <span class="comment">// è‰¯å¥½ä¹ æƒ¯ï¼šå°†æŒ‡é’ˆç½®ä¸ºç©ºï¼Œé˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ (dangling pointer)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"å°ç‹— "</span> &lt;&lt; dog_name_ &lt;&lt; <span class="string">" çš„å¹´é¾„å†…å­˜å·²é‡Šæ”¾ã€‚"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_dog_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"å°ç‹—ä¿¡æ¯ - åå­—: "</span> &lt;&lt; dog_name_ &lt;&lt; <span class="string">", å“ç§: "</span> &lt;&lt; dog_breed_ &lt;&lt; <span class="string">", å¹´é¾„: "</span> &lt;&lt; (p_dog_age_ ? *p_dog_age_ : <span class="number">-1</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€ä¸ªæ¼”ç¤ºææ„å‡½æ•°è°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">some_function_stack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- è¿›å…¥ some_function_stack ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Dog <span class="title">local_dog</span><span class="params">(<span class="string">"æ—ºè´¢"</span>, <span class="string">"ä¸­åç”°å›­çŠ¬"</span>, <span class="number">3</span>)</span></span>; <span class="comment">// æ ˆå¯¹è±¡</span></span><br><span class="line">    local_dog.print_dog_info();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- ç¦»å¼€ some_function_stack ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// å½“å‡½æ•°ç»“æŸæ—¶ï¼Œlocal_dogä¼šç¦»å¼€ä½œç”¨åŸŸï¼Œå…¶ææ„å‡½æ•°è¢«è°ƒç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">some_function_heap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- è¿›å…¥ some_function_heap ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Dog* heap_dog = <span class="keyword">new</span> Dog(<span class="string">"å•¸å¤©"</span>, <span class="string">"ç»†çŠ¬"</span>, <span class="number">5</span>); <span class="comment">// å †å¯¹è±¡</span></span><br><span class="line">    heap_dog-&gt;print_dog_info();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"æ˜¾å¼åˆ é™¤å †å¯¹è±¡ heap_dog..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span> heap_dog; <span class="comment">// æ˜¾å¼è°ƒç”¨deleteï¼Œä¼šè§¦å‘ææ„å‡½æ•°</span></span><br><span class="line">    heap_dog = <span class="literal">nullptr</span>; <span class="comment">// å¥½ä¹ æƒ¯</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœä¸deleteï¼Œå½“some_function_heapç»“æŸæ—¶ï¼Œheap_dogæŒ‡é’ˆæœ¬èº«ä¼šæ¶ˆå¤±ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä½†å®ƒæŒ‡å‘çš„å†…å­˜ä¸ä¼šè¢«é‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„æ¼ï¼Œææ„å‡½æ•°ä¹Ÿä¸ä¼šè¢«è°ƒç”¨ã€‚</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- ç¦»å¼€ some_function_heap ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- ç¨‹åºå¼€å§‹ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    some_function_stack();</span><br><span class="line"></span><br><span class="line">    some_function_heap();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- åˆ›å»ºä¸»å‡½æ•°ä¸­çš„æ ˆå¯¹è±¡ dog_main ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">Dog <span class="title">dog_main</span><span class="params">(<span class="string">"å°ç™½"</span>, <span class="string">"è¨æ‘©è€¶"</span>, <span class="number">2</span>)</span></span>;</span><br><span class="line">    dog_main.print_dog_info();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- ä¸»å‡½æ•°å³å°†ç»“æŸ ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// å½“mainå‡½æ•°ç»“æŸæ—¶ï¼Œdog_mainä¼šç¦»å¼€ä½œç”¨åŸŸï¼Œå…¶ææ„å‡½æ•°è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>é¢„æœŸè¾“å‡ºåˆ†æï¼š</strong><br>ä½ ä¼šçœ‹åˆ°æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„ <code>std::cout</code> è¯­å¥äº¤æ›¿å‡ºç°ã€‚ç‰¹åˆ«æ³¨æ„ <code>some_function_stack</code> å’Œ <code>some_function_heap</code> ä¸­å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯é¡ºåºï¼Œä»¥åŠ <code>main</code> å‡½æ•°ä¸­å¯¹è±¡çš„é”€æ¯æ—¶æœºã€‚</p>
<hr>
<p><strong>QAé—ªå¡ (QA Flash Cards):</strong></p>
<ol>
<li><p><strong>é—®ï¼š</strong>ä»€ä¹ˆæ˜¯ææ„å‡½æ•° (Destructor)ï¼Ÿ<br><strong>ç­”ï¼š</strong> ç±»ä¸­çš„ä¸€ä¸ªç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œåœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºæ‰§è¡Œæ¸…ç†å·¥ä½œï¼Œå¦‚é‡Šæ”¾åŠ¨æ€åˆ†é…çš„èµ„æºã€‚</p>
</li>
<li><p><strong>é—®ï¼š</strong>å¦‚ä½•å£°æ˜ä¸€ä¸ªææ„å‡½æ•°ï¼Ÿ<br><strong>ç­”ï¼š</strong> ä½¿ç”¨æ³¢æµªå· <code>~</code> åŠ ä¸Šç±»åï¼Œä¾‹å¦‚ <code>~MyClass()</code>ã€‚å®ƒæ²¡æœ‰è¿”å›ç±»å‹ï¼Œä¹Ÿæ²¡æœ‰å‚æ•°ã€‚</p>
</li>
<li><p><strong>é—®ï¼š</strong>ææ„å‡½æ•°æœ€å¸¸è§çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ<br><strong>ç­”ï¼š</strong> é‡Šæ”¾åœ¨æ„é€ å‡½æ•°ä¸­æˆ–å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå†…åŠ¨æ€åˆ†é…çš„å†…å­˜ (dynamic memory allocation) æˆ–å…¶ä»–èµ„æºï¼ˆå¦‚æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ï¼‰ã€‚</p>
</li>
<li><p><strong>é—®ï¼š</strong>ä»€ä¹ˆæ—¶å€™ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Ÿï¼ˆè‡³å°‘åˆ—ä¸¾ä¸¤ç§æƒ…å†µï¼‰<br><strong>ç­”ï¼š</strong></p>
<ul>
<li>å½“æ ˆ (stack) ä¸Šçš„å±€éƒ¨å¯¹è±¡ç¦»å¼€å…¶ä½œç”¨åŸŸ (scope) æ—¶ã€‚</li>
<li>å½“å † (heap) ä¸Šçš„å¯¹è±¡è¢« <code>delete</code> æ“ä½œç¬¦ (delete operator) åˆ é™¤æ—¶ã€‚</li>
<li>ï¼ˆå¯é€‰ï¼‰å½“æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°çš„å¯¹è±¡å‰¯æœ¬åœ¨å‡½æ•°ç»“æŸæ—¶ã€‚</li>
</ul>
</li>
<li><p><strong>é—®ï¼š</strong>å¦‚æœæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ <code>MyClass* obj = new MyClass();</code> ä½†å¿˜è®° <code>delete obj;</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<br><strong>ç­”ï¼š</strong> è¯¥å¯¹è±¡çš„ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œå®ƒå ç”¨çš„å †å†…å­˜ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ (memory leak)ã€‚</p>
</li>
</ol>
<hr>
<p><strong>å¸¸è§è¯¯è§£æˆ–æ–°æ‰‹æ˜“çŠ¯é”™è¯¯ï¼š</strong></p>
<ol>
<li><strong>å¿˜è®°é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</strong>ï¼šè¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯ã€‚å¦‚æœåœ¨æ„é€ å‡½æ•°ä¸­ç”¨äº† <code>new</code>ï¼Œå°±å¿…é¡»åœ¨ææ„å‡½æ•°ä¸­ç”¨ <code>delete</code>ï¼ˆå¦‚æœæ˜¯æ•°ç»„ç”¨ <code>new[]</code>ï¼Œåˆ™ç”¨ <code>delete[]</code>ï¼‰ã€‚å¦åˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚<ul>
<li>é”™è¯¯ç¤ºä¾‹ï¼šææ„å‡½æ•°ä¸ºç©ºï¼Œä½†æ„é€ å‡½æ•°ä¸­ <code>p_dog_age_ = new int;</code></li>
</ul>
</li>
<li><strong>å¯¹éåŠ¨æ€åˆ†é…çš„å†…å­˜ä½¿ç”¨ <code>delete</code></strong>ï¼š<code>delete</code> åªèƒ½ç”¨äºé€šè¿‡ <code>new</code> åˆ†é…çš„æŒ‡é’ˆã€‚å¯¹æ ˆä¸Šå¯¹è±¡çš„åœ°å€æˆ–å·²é‡Šæ”¾çš„æŒ‡é’ˆä½¿ç”¨ <code>delete</code> ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆé€šå¸¸æ˜¯ç¨‹åºå´©æºƒï¼‰ã€‚<ul>
<li>é”™è¯¯ç¤ºä¾‹ï¼š<code>int x; delete &amp;x;</code> (xæ˜¯æ ˆå˜é‡)</li>
</ul>
</li>
<li><strong>é‡å¤é‡Šæ”¾å†…å­˜ (Double Free)</strong>ï¼šåŒä¸€ä¸ªæŒ‡é’ˆè¢« <code>delete</code> ä¸¤æ¬¡ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨å¤šä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€å—åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå¹¶ä¸”éƒ½å°è¯•é‡Šæ”¾å®ƒæ—¶ï¼Œæˆ–è€…ä¸å°å¿ƒæ‹·è´äº†åŸå§‹æŒ‡é’ˆå¹¶åˆ†åˆ«åˆ é™¤ã€‚è¿™ä¹Ÿä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚<ul>
<li>è¿™ä¸è¯¾ç¨‹ä¸­æåˆ°çš„â€œæŒ‰å€¼ä¼ é€’ç±»å¯¹è±¡â€æ—¶çš„æ½œåœ¨é—®é¢˜æœ‰å…³ã€‚å¦‚æœç±»æœ‰ä¸€ä¸ªåŸå§‹æŒ‡é’ˆæˆå‘˜ï¼Œå¹¶ä¸”ä½ æ²¡æœ‰å®šä¹‰è‡ªå·±çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆæŒ‰å€¼ä¼ é€’æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªâ€œæµ…æ‹·è´â€ï¼Œä½¿å¾—å‰¯æœ¬å’ŒåŸå§‹å¯¹è±¡çš„æŒ‡é’ˆæˆå‘˜æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚å½“å‰¯æœ¬é”€æ¯æ—¶ï¼Œå®ƒä¼š <code>delete</code> è¿™å—å†…å­˜ï¼›å½“åŸå§‹å¯¹è±¡é”€æ¯æ—¶ï¼Œå®ƒä¼šå†æ¬¡ <code>delete</code> å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜ï¼ŒBoomï¼</li>
</ul>
</li>
<li><strong>è®¤ä¸ºæŒ‡é’ˆå˜é‡ç¦»å¼€ä½œç”¨åŸŸå°±ä¼šè‡ªåŠ¨é‡Šæ”¾å…¶æŒ‡å‘çš„å †å†…å­˜</strong>ï¼š<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">leaky_func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>* num_ptr = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">10</span>);</span><br><span class="line">&#125; <span class="comment">// num_ptr (æ ˆä¸Šçš„æŒ‡é’ˆå˜é‡) æ¶ˆå¤±äº†ï¼Œä½†å®ƒæŒ‡å‘çš„å †å†…å­˜ (å­˜å‚¨10çš„é‚£å—) è¿˜åœ¨ï¼Œå¹¶ä¸”æ— æ³•è®¿é—®äº† -&gt; å†…å­˜æ³„æ¼</span></span><br></pre></td></tr></table></figure></div>
å¿…é¡»æ˜¾å¼è°ƒç”¨ <code>delete num_ptr;</code> æ‰èƒ½é‡Šæ”¾å †å†…å­˜å¹¶è°ƒç”¨ææ„å‡½æ•°ï¼ˆå¦‚æœ <code>num_ptr</code> æŒ‡å‘çš„æ˜¯ç±»å¯¹è±¡ï¼‰ã€‚</li>
<li><strong>ç»™ææ„å‡½æ•°æ·»åŠ å‚æ•°æˆ–è¿”å›ç±»å‹</strong>ï¼šææ„å‡½æ•°æœ‰ä¸¥æ ¼çš„è¯­æ³•è§„å®šï¼šæ— å‚æ•°ï¼Œæ— è¿”å›ç±»å‹ã€‚</li>
</ol>
<hr>
<p><strong>ç¼–ç ç»ƒä¹ ï¼š</strong></p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª <code>ResourceHolder</code> ç±»ï¼Œå®ƒåœ¨æ„é€ æ—¶è·å–ä¸€äº›â€œèµ„æºâ€ï¼ˆè¿™é‡Œç”¨åŠ¨æ€åˆ†é…çš„ <code>int</code> æ¨¡æ‹Ÿï¼‰ã€‚è¯·ä½ ä¸ºå®ƒè¡¥å…¨ææ„å‡½æ•°ï¼Œç¡®ä¿èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResourceHolder</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* m_resource; <span class="comment">// æŒ‡å‘æˆ‘ä»¬â€œè·å–â€çš„èµ„æº</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œè·å–èµ„æº</span></span><br><span class="line">    ResourceHolder(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name, <span class="keyword">int</span> value) : m_name(name) &#123;</span><br><span class="line">        m_resource = <span class="keyword">new</span> <span class="keyword">int</span>(value); <span class="comment">// åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' created, resource value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®ç°ææ„å‡½æ•°</span></span><br><span class="line">    <span class="comment">// ä½ éœ€è¦åœ¨è¿™é‡Œæ·»åŠ ä»£ç æ¥é‡Šæ”¾ m_resource æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">    <span class="comment">// å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨æ˜èµ„æºå·²è¢«é‡Šæ”¾</span></span><br><span class="line">    <span class="comment">// ~ResourceHolder() &#123;</span></span><br><span class="line">    <span class="comment">//     // åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ä»£ç </span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m_resource) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has resource with value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has no resource."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Program Start ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå—</span></span><br><span class="line">        <span class="function">ResourceHolder <span class="title">rh1</span><span class="params">(<span class="string">"DataBlock1"</span>, <span class="number">100</span>)</span></span>;</span><br><span class="line">        rh1.print_info();</span><br><span class="line"></span><br><span class="line">        ResourceHolder* rh2 = <span class="keyword">new</span> ResourceHolder(<span class="string">"DataBlock2_Heap"</span>, <span class="number">200</span>);</span><br><span class="line">        rh2-&gt;print_info();</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> åœ¨è¿™é‡Œæ·»åŠ ä»£ç ï¼Œæ˜¾å¼åˆ é™¤ rh2 æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// (æ€è€ƒï¼šå¦‚æœè¿™é‡Œä¸deleteï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿrh2çš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨å—ï¼Ÿ)</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="comment">// rh1 ä¼šåœ¨è¿™é‡Œç¦»å¼€ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Program End ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¯·ä½ æ€è€ƒä¸€ä¸‹ï¼Œ<code>// TODO:</code> éƒ¨åˆ†åº”è¯¥å¡«å…¥ä»€ä¹ˆä»£ç ï¼Œç„¶åæŠŠä½ çš„å®ç°æ–¹æ¡ˆå‘Šè¯‰æˆ‘ã€‚æˆ‘ä¼šæ ¹æ®ä½ çš„ç­”æ¡ˆç»™å‡ºåé¦ˆã€‚åŠ æ²¹ï¼</p>
<hr>
<h2 id="ğŸ§‘â€ğŸ’»-User-1"><a href="#ğŸ§‘â€ğŸ’»-User-1" class="headerlink" title="ğŸ§‘â€ğŸ’» User"></a>ğŸ§‘â€ğŸ’» User</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResourceHolder</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* m_resource; <span class="comment">// æŒ‡å‘æˆ‘ä»¬â€œè·å–â€çš„èµ„æº</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œè·å–èµ„æº</span></span><br><span class="line">    ResourceHolder(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name, <span class="keyword">int</span> value) : m_name(name) &#123;</span><br><span class="line">        m_resource = <span class="keyword">new</span> <span class="keyword">int</span>(value); <span class="comment">// åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' created, resource value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®ç°ææ„å‡½æ•°</span></span><br><span class="line">    <span class="comment">// ä½ éœ€è¦åœ¨è¿™é‡Œæ·»åŠ ä»£ç æ¥é‡Šæ”¾ m_resource æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">    <span class="comment">// å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨æ˜èµ„æºå·²è¢«é‡Šæ”¾</span></span><br><span class="line">     ~ResourceHolder() &#123;</span><br><span class="line">        <span class="comment">// åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ä»£ç </span></span><br><span class="line">        <span class="keyword">delete</span> m_resource;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder memory has been released"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m_resource) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has resource with value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has no resource."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Program Start ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå—</span></span><br><span class="line">        <span class="function">ResourceHolder <span class="title">rh1</span><span class="params">(<span class="string">"DataBlock1"</span>, <span class="number">100</span>)</span></span>;</span><br><span class="line">        rh1.print_info();</span><br><span class="line"></span><br><span class="line">        ResourceHolder* rh2 = <span class="keyword">new</span> ResourceHolder(<span class="string">"DataBlock2_Heap"</span>, <span class="number">200</span>);</span><br><span class="line">        rh2-&gt;print_info();</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> åœ¨è¿™é‡Œæ·»åŠ ä»£ç ï¼Œæ˜¾å¼åˆ é™¤ rh2 æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// (æ€è€ƒï¼šå¦‚æœè¿™é‡Œä¸deleteï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿrh2çš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨å—ï¼Ÿ)</span></span><br><span class="line">        <span class="keyword">delete</span> rh2;</span><br><span class="line">        <span class="comment">// ä¸deleteä¼šå†…å­˜æ³„æ¼ï¼Œ å¹¶ä¸”ä¸ä¼šè°ƒç”¨ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="comment">// rh1 ä¼šåœ¨è¿™é‡Œç¦»å¼€ä½œç”¨åŸŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Program End ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<hr>
<h2 id="ğŸ¤–-Assistant-1"><a href="#ğŸ¤–-Assistant-1" class="headerlink" title="ğŸ¤– Assistant"></a>ğŸ¤– Assistant</h2><p>éå¸¸å¥½ï¼ä½ å·²ç»æˆåŠŸåœ°ä¸º <code>ResourceHolder</code> ç±»å®ç°äº†ææ„å‡½æ•°ï¼Œå¹¶ä¸”æ­£ç¡®åœ°åœ¨ <code>main</code> å‡½æ•°ä¸­å¤„ç†äº†å †å¯¹è±¡çš„åˆ é™¤ã€‚åšå¾—ä¸é”™ï¼</p>
<hr>
<p><strong>7. ç”¨æˆ·è§£ç­”è¯„ä¼°ã€æ­£ç¡®ç­”æ¡ˆåŠè§£é‡Š</strong></p>
<p><strong>ç”¨æˆ·è§£ç­”è¯„ä¼°ï¼š</strong></p>
<ul>
<li><p><strong>ææ„å‡½æ•°å®ç°ï¼š</strong></p>
<ul>
<li><code>delete m_resource;</code>: <strong>æ­£ç¡®</strong>ã€‚ä½ æ­£ç¡®åœ°ä½¿ç”¨äº† <code>delete</code> æ¥é‡Šæ”¾ <code>m_resource</code> æŒ‡å‘çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</li>
<li><code>std::cout &lt;&lt; &quot;ResourceHolder memory has been released&quot; &lt;&lt; std::endl;</code>: <strong>åŸºæœ¬æ­£ç¡®</strong>ã€‚æ‰“å°äº†é‡Šæ”¾æ¶ˆæ¯ã€‚ä¸ºäº†æ›´æ¸…æ™°ï¼Œæœ€å¥½èƒ½æŒ‡æ˜æ˜¯å“ªä¸ªå¯¹è±¡çš„èµ„æºè¢«é‡Šæ”¾äº†ï¼Œæ¯”å¦‚åŒ…å« <code>m_name</code>ã€‚</li>
<li><strong>å°å»ºè®®</strong>ï¼šåœ¨ <code>delete m_resource;</code> ä¹‹åï¼Œé€šå¸¸çš„å¥½ä¹ æƒ¯æ˜¯åŠ ä¸Š <code>m_resource = nullptr;</code>ã€‚è™½ç„¶åœ¨è¿™ä¸ªç‰¹å®šçš„ææ„å‡½æ•°åœºæ™¯ä¸‹ï¼Œå¯¹è±¡å³å°†è¢«é”€æ¯ï¼Œ<code>m_resource</code> è¿™ä¸ªæˆå‘˜å˜é‡æœ¬èº«ä¹Ÿå°†ä¸å¤å­˜åœ¨ï¼Œæ‰€ä»¥æ‚¬æŒ‚æŒ‡é’ˆçš„é£é™©ç›¸å¯¹è¾ƒå°ã€‚ä½†åœ¨å…¶ä»–å¯èƒ½å¤šæ¬¡æ“ä½œæŒ‡é’ˆçš„åœºæ™¯ä¸‹ï¼ˆæ¯”å¦‚ä¸€ä¸ª <code>release()</code> æ–¹æ³•ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ (dangling pointer) çš„æªæ–½ã€‚</li>
</ul>
</li>
<li><p><strong><code>main</code> å‡½æ•°ä¸­çš„ <code>TODO</code>ï¼š</strong></p>
<ul>
<li><code>delete rh2;</code>: <strong>æ­£ç¡®</strong>ã€‚ä½ æ­£ç¡®åœ°åˆ é™¤äº†åœ¨å †ä¸Šåˆ›å»ºçš„ <code>rh2</code> å¯¹è±¡ã€‚</li>
<li>æ³¨é‡Š <code>// ä¸deleteä¼šå†…å­˜æ³„æ¼ï¼Œ å¹¶ä¸”ä¸ä¼šè°ƒç”¨ææ„å‡½æ•°</code>: <strong>ç†è§£å®Œå…¨æ­£ç¡®ï¼</strong> å¦‚æœå¿˜è®° <code>delete rh2;</code>ï¼Œ<code>rh2</code> æŒ‡å‘çš„ <code>ResourceHolder</code> å¯¹è±¡çš„ææ„å‡½æ•°å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œå…¶å†…éƒ¨é€šè¿‡ <code>new int()</code> åˆ†é…çš„å†…å­˜ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç»¼åˆè¯„ä»·ï¼šä¼˜ç§€ï¼æ ¸å¿ƒåŠŸèƒ½éƒ½å·²æ­£ç¡®å®ç°ã€‚</strong></p>
<p><strong>æ­£ç¡®ç­”æ¡ˆä¸è§£é‡Šï¼š</strong></p>
<p>è¿™æ˜¯ä¿®æ”¹åæ›´å®Œå–„çš„ç‰ˆæœ¬ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // ç¡®ä¿åŒ…å«äº†&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResourceHolder</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* m_resource; <span class="comment">// æŒ‡å‘æˆ‘ä»¬â€œè·å–â€çš„èµ„æº</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œè·å–èµ„æº</span></span><br><span class="line">    ResourceHolder(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name, <span class="keyword">int</span> value) : m_name(name) &#123;</span><br><span class="line">        m_resource = <span class="keyword">new</span> <span class="keyword">int</span>(value); <span class="comment">// åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' created, resource value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~ResourceHolder() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' is being destroyed. Releasing resource..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">delete</span> m_resource;      <span class="comment">// 1. é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">        m_resource = <span class="literal">nullptr</span>;   <span class="comment">// 2. å°†æŒ‡é’ˆè®¾ç½®ä¸ºç©ºï¼Œé˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ (å¥½ä¹ æƒ¯)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' resource released."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥ m_resource æ˜¯å¦ä¸ºç©ºæŒ‡é’ˆæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå°¤å…¶æ˜¯åœ¨å®ƒå¯èƒ½è¢«ç½®ä¸º nullptr å</span></span><br><span class="line">        <span class="keyword">if</span> (m_resource) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Info: ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has resource with value: "</span> &lt;&lt; *m_resource &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Info: ResourceHolder '"</span> &lt;&lt; m_name &lt;&lt; <span class="string">"' has no (or released) resource."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"--- Program Start ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå—</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\nCreating rh1 (stack object)..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="function">ResourceHolder <span class="title">rh1</span><span class="params">(<span class="string">"DataBlock1_Stack"</span>, <span class="number">100</span>)</span></span>;</span><br><span class="line">        rh1.print_info();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\nCreating rh2 (heap object)..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        ResourceHolder* rh2 = <span class="keyword">new</span> ResourceHolder(<span class="string">"DataBlock2_Heap"</span>, <span class="number">200</span>);</span><br><span class="line">        rh2-&gt;print_info();</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\nExplicitly deleting rh2 (heap object)..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">delete</span> rh2; <span class="comment">// æ˜¾å¼åˆ é™¤ rh2 æŒ‡å‘çš„å¯¹è±¡ï¼Œä¼šè°ƒç”¨å…¶ææ„å‡½æ•°</span></span><br><span class="line">        rh2 = <span class="literal">nullptr</span>; <span class="comment">// ä¹Ÿæ˜¯å¥½ä¹ æƒ¯ï¼Œé˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆ rh2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨å·²ç»è¢« delete çš„ rh2 (ä¸”æ²¡æœ‰ç½®ç©º)</span></span><br><span class="line">        <span class="comment">// if (rh2) &#123; // å¦‚æœ rh2 æ²¡æœ‰ç½®ç©ºï¼Œè¿™é‡Œå¯èƒ½è¿˜ä¼šåˆ¤æ–­ä¸ºçœŸ</span></span><br><span class="line">        <span class="comment">//    rh2-&gt;print_info(); // è¿™å°†æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œå¾ˆå¯èƒ½å´©æºƒï¼</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="comment">// rh1 ä¼šåœ¨è¿™é‡Œç¦»å¼€ä½œç”¨åŸŸï¼Œå…¶ææ„å‡½æ•°è‡ªåŠ¨è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n--- Program End ---"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>è§£é‡Šå…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li><p><strong>ææ„å‡½æ•° <code>~ResourceHolder()</code></strong>:</p>
<ul>
<li><code>delete m_resource;</code>: è¿™æ˜¯æ ¸å¿ƒã€‚å®ƒå‘Šè¯‰C++è¿è¡Œæ—¶ç³»ç»Ÿï¼Œ<code>m_resource</code> æŒ‡é’ˆæ‰€æŒ‡å‘çš„é‚£å—åœ¨å †ä¸Šåˆ†é…çš„å†…å­˜ç°åœ¨å¯ä»¥è¢«å›æ”¶äº†ã€‚</li>
<li><code>m_resource = nullptr;</code>: å°† <code>m_resource</code> è®¾ç½®ä¸º <code>nullptr</code> æ˜¯ä¸€ä¸ªé˜²å¾¡æ€§ç¼–ç¨‹æªæ–½ã€‚å¦‚æœåœ¨ææ„å‡½æ•°è¢«è°ƒç”¨åï¼ˆå°½ç®¡ä¸å¤ªå¯èƒ½å¯¹å·²é”€æ¯å¯¹è±¡åšæ“ä½œï¼‰æˆ–è€…åœ¨ç±»çš„å…¶ä»–æ–¹æ³•ä¸­æœ‰å¯èƒ½åœ¨èµ„æºé‡Šæ”¾åæ„å¤–è®¿é—® <code>m_resource</code>ï¼Œå°†å…¶è®¾ä¸º <code>nullptr</code> å¯ä»¥é˜²æ­¢ä½¿ç”¨ä¸€ä¸ªæ— æ•ˆçš„ï¼ˆæ‚¬æŒ‚çš„ï¼‰æŒ‡é’ˆã€‚å¯¹ç©ºæŒ‡é’ˆè¿›è¡Œ <code>delete</code> æ˜¯å®‰å…¨çš„ï¼ˆä»€ä¹ˆä¹Ÿä¸åšï¼‰ï¼Œä½†å¯¹æ‚¬æŒ‚æŒ‡é’ˆè¿›è¡Œæ“ä½œæ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</li>
<li>æ›´è¯¦ç»†çš„ææ„ä¿¡æ¯ï¼š<code>std::cout &lt;&lt; &quot;ResourceHolder &#39;&quot; &lt;&lt; m_name &lt;&lt; &quot;&#39; is being destroyed...&quot; &lt;&lt; std::endl;</code> èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ¸…æ™°åœ°è¿½è¸ªæ˜¯å“ªä¸ªå¯¹è±¡çš„ææ„å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</li>
</ul>
</li>
<li><p><strong><code>main</code> å‡½æ•°ä¸­çš„ <code>delete rh2;</code></strong>:</p>
<ul>
<li><code>rh2</code> æ˜¯ä¸€ä¸ªæŒ‡å‘åœ¨å †ä¸Šåˆ›å»ºçš„ <code>ResourceHolder</code> å¯¹è±¡çš„æŒ‡é’ˆã€‚</li>
<li><code>delete rh2;</code> åšäº†ä¸¤ä»¶äº‹ï¼š<ol>
<li>è°ƒç”¨ <code>rh2</code>æ‰€æŒ‡å‘çš„ <code>ResourceHolder</code> å¯¹è±¡çš„ææ„å‡½æ•° (<code>~ResourceHolder()</code>)ã€‚</li>
<li>é‡Šæ”¾è¯¥å¯¹è±¡æœ¬èº«å ç”¨çš„å †å†…å­˜ã€‚</li>
</ol>
</li>
<li><code>rh2 = nullptr;</code>: åœ¨ <code>delete rh2;</code> ä¹‹åï¼Œ<code>rh2</code> æœ¬èº«ä»ç„¶å­˜å‚¨ç€ä¹‹å‰é‚£ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€ï¼ˆç°åœ¨é‚£ä¸ªåœ°å€ä¸Šçš„å†…å®¹æ˜¯æ— æ•ˆçš„äº†ï¼‰ã€‚å°† <code>rh2</code> è®¾ç½®ä¸º <code>nullptr</code> å¯ä»¥é˜²æ­¢åç»­ä»£ç ä¸å°å¿ƒé€šè¿‡ <code>rh2</code> è®¿é—®å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜ã€‚</li>
</ul>
</li>
</ol>
<hr>
<p><strong>8. å»ºè®®ä¸æ‰©å±•é—®é¢˜</strong></p>
<p><strong>è¿›ä¸€æ­¥çš„å»ºè®®ï¼š</strong></p>
<ol>
<li><strong>RAII (Resource Acquisition Is Initialization)</strong>ï¼šä½ åˆšæ‰å†™çš„å…¶å®å°±æ˜¯ RAII æ€æƒ³çš„ä¸€ä¸ªç®€å•ä½“ç°ï¼RAII æ˜¯ä¸€ç§å¼ºå¤§çš„C++ç¼–ç¨‹èŒƒå¼ï¼Œå³åœ¨å¯¹è±¡çš„æ„é€ å‡½æ•°ä¸­è·å–èµ„æºï¼Œåœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾èµ„æºã€‚è¿™æ ·å¯ä»¥ç¡®ä¿èµ„æºåœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå†…è¢«å¦¥å–„ç®¡ç†ï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸ä¹Ÿèƒ½æ­£ç¡®é‡Šæ”¾ã€‚</li>
<li><strong>æ™ºèƒ½æŒ‡é’ˆ (Smart Pointers)</strong>ï¼šå¯¹äºåŠ¨æ€å†…å­˜ç®¡ç†ï¼ŒC++æ ‡å‡†åº“æä¾›äº†æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ <code>std::unique_ptr</code> å’Œ <code>std::shared_ptr</code>ï¼‰ï¼Œå®ƒä»¬å¯ä»¥è‡ªåŠ¨ç®¡ç†æ‰€æŒ‡å‘å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¤§å¤§å‡å°‘å¿˜è®° <code>delete</code> å¯¼è‡´çš„å†…å­˜æ³„æ¼ã€‚<ul>
<li>å¯ä»¥å°è¯•å°† <code>int* m_resource;</code> ä¿®æ”¹ä¸º <code>std::unique_ptr&lt;int&gt; m_resource;</code>ï¼Œè¿™æ ·ææ„å‡½æ•°ç”šè‡³ä¸éœ€è¦æ˜¾å¼ <code>delete</code> äº†ï¼</li>
</ul>
</li>
</ol>
<p><strong>æ‰©å±•é—®é¢˜ä¾›ä½ æ€è€ƒï¼š</strong></p>
<ol>
<li><strong>å¥å£®æ€§è€ƒè™‘</strong>ï¼šå¦‚æœåœ¨ <code>ResourceHolder</code> çš„æ„é€ å‡½æ•°ä¸­ <code>m_resource = new int(value);</code> å¤±è´¥å¹¶æŠ›å‡ºå¼‚å¸¸ï¼ˆä¾‹å¦‚ï¼Œå†…å­˜ä¸è¶³æ—¶ <code>new</code> ä¼šæŠ›å‡º <code>std::bad_alloc</code>ï¼‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿææ„å‡½æ•°ä¼šè¢«è°ƒç”¨å—ï¼Ÿï¼ˆæç¤ºï¼šå¦‚æœæ„é€ å‡½æ•°ä¸­é€”å¤±è´¥ï¼Œå¯¹è±¡æœªå®Œå…¨æ„é€ ï¼Œææ„å‡½æ•°é€šå¸¸ä¸ä¼šè¢«è°ƒç”¨ã€‚ï¼‰</li>
<li><strong>æ‹·è´é—®é¢˜</strong>ï¼šå¦‚æœæˆ‘ä»¬å…è®¸ <code>ResourceHolder</code> å¯¹è±¡è¢«æ‹·è´ï¼Œä¾‹å¦‚ï¼š<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ResourceHolder <span class="title">rh_original</span><span class="params">(<span class="string">"Original"</span>, <span class="number">50</span>)</span></span>;</span><br><span class="line">ResourceHolder rh_copy = rh_original; <span class="comment">// æ‹·è´æ„é€ </span></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="comment">// ResourceHolder rh_another("Another", 60);</span></span><br><span class="line"><span class="comment">// rh_copy = rh_another; // æ‹·è´èµ‹å€¼</span></span><br></pre></td></tr></table></figure></div>
é»˜è®¤çš„æ‹·è´è¡Œä¸ºï¼ˆæµ…æ‹·è´ (shallow copy)ï¼‰ä¼šå¯¼è‡´ <code>rh_original.m_resource</code> å’Œ <code>rh_copy.m_resource</code> æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚å½“å…¶ä¸­ä¸€ä¸ªå¯¹è±¡ææ„å¹¶é‡Šæ”¾å†…å­˜åï¼Œå¦ä¸€ä¸ªå¯¹è±¡çš„ <code>m_resource</code> å°±æˆäº†æ‚¬æŒ‚æŒ‡é’ˆï¼Œå†æ¬¡ææ„æ—¶ä¼šå¯¼è‡´åŒé‡é‡Šæ”¾ (double free) é”™è¯¯ã€‚å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿï¼ˆæç¤ºï¼š<strong>æ·±æ‹·è´ (deep copy)</strong>ï¼Œæˆ–è€…ç¦ç”¨æ‹·è´ï¼Œæˆ–è€…ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¤„ç†æ‰€æœ‰æƒã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°â€œRule of Three/Five/Zeroâ€ï¼Œå³å¦‚æœä½ è‡ªå®šä¹‰äº†ææ„å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°æˆ–æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„ä¸€ä¸ªï¼Œä½ å¯èƒ½éœ€è¦è‡ªå®šä¹‰å…¶ä»–çš„ã€‚ï¼‰</li>
<li><strong>ç§»åŠ¨è¯­ä¹‰ (Move Semantics)</strong>ï¼šé™¤äº†æ‹·è´ï¼ŒC++11å¼•å…¥äº†ç§»åŠ¨è¯­ä¹‰ã€‚å¦‚æœä¸€ä¸ª <code>ResourceHolder</code> å¯¹è±¡çš„èµ„æºå¯ä»¥è¢«â€œè½¬ç§»â€ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æ‹·è´ï¼Œè¿™ä¼šæ›´é«˜æ•ˆã€‚è¿™æ¶‰åŠåˆ°ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚</li>
<li><strong>æ•°ç»„èµ„æº</strong>ï¼šå¦‚æœ <code>m_resource</code> æŒ‡å‘çš„ä¸æ˜¯å•ä¸ª <code>int</code>ï¼Œè€Œæ˜¯ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„ <code>int</code> æ•°ç»„ï¼ˆä¾‹å¦‚ <code>m_resource = new int[10];</code>ï¼‰ï¼Œé‚£ä¹ˆåœ¨ææ„å‡½æ•°ä¸­åº”è¯¥å¦‚ä½•é‡Šæ”¾å®ƒï¼Ÿï¼ˆæç¤ºï¼šä½¿ç”¨ <code>delete[] m_resource;</code>ï¼‰</li>
</ol>
<p>è¿™äº›é—®é¢˜ä¼šå¼•å¯¼ä½ å­¦ä¹ æ›´å¤šå…³äºC++èµ„æºç®¡ç†å’Œå¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„é‡è¦æ¦‚å¿µã€‚ç»§ç»­æ¢ç´¢ï¼Œä½ ä¼šè¶Šæ¥è¶Šç†Ÿç»ƒï¼å¦‚æœä½ å¯¹è¿™äº›æ‰©å±•é—®é¢˜æœ‰ä»»ä½•æƒ³æ³•æˆ–ç–‘é—®ï¼Œéšæ—¶å¯ä»¥æå‡ºï¼</p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Cpp/">Cpp    </a><a class="post-meta__tags" href="/tags/Coding/">Coding    </a><a class="post-meta__tags" href="/tags/Tutorial/">Tutorial    </a><a class="post-meta__tags" href="/tags/Development/">Development    </a><a class="post-meta__tags" href="/tags/Memory/">Memory    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2025/06/08/10-projects/cplusplus/lectures/282%20-%20cpp%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%8E%E7%B1%BB%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E7%94%A8%E6%B3%95/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info"><span>282 - cppç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«å’Œç”¨æ³•</span></div></a></div><div class="next-post pull_right"><a href="/2025/06/08/10-projects/cplusplus/lectures/278%20-%20cpp%20%E6%8C%87%E9%92%88%E7%AE%A1%E7%90%86%E7%B1%BB%E5%AF%B9%E8%B1%A1%E7%A4%BA%E4%BE%8B/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info"><span>278 - cpp æŒ‡é’ˆç®¡ç†ç±»å¯¹è±¡ç¤ºä¾‹</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/256 - cpp decltype(auto)/" title="256 - cpp decltype(auto)"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">256 - cpp decltype(auto)</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/257 - cpp Default template arguments/" title="257 - cpp Default template arguments"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">257 - cpp Default template arguments</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/262 - constexpr if/" title="262 - constexpr if"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">262 - constexpr if</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/282 - cppç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«å’Œç”¨æ³•/" title="282 - cppç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«å’Œç”¨æ³•"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">282 - cppç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«å’Œç”¨æ³•</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/313 - friend of class/" title="313 - friend of class"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">313 - friend of class</div></div></a></div><div class="relatedPosts_item"><a href="/2025/06/08/10-projects/cplusplus/lectures/318 - inline static variable/" title="318 - inline static variable"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2025-06-08</div><div class="relatedPosts_title">318 - inline static variable</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> è¯„è®º</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xvMxbws16Erd8WUfqxkvHmb5-gzGzoHsz',
  appKey:'4U0Vo7NQIUL0eJzHdkPzdCDr',
  placeholder:'ä¸è¯´è¯çš„äººä¼šç–¯æ‰å—?',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202103940.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By supersheepbear</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="external nofollow noopener noreferrer"><span>Butterfly</span></a></div><div class="footer_custom_text">å¤–å‘å­¤ç‹¬è€…æ‚£è€…</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script id="canvas_nest" color="255,240,245" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« "></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>